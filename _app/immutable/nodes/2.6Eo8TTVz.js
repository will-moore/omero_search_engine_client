var Rr=Object.defineProperty;var Ft=r=>{throw TypeError(r)};var Lr=(r,e,t)=>e in r?Rr(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Ut=(r,e,t)=>Lr(r,typeof e!="symbol"?e+"":e,t),pt=(r,e,t)=>e.has(r)||Ft("Cannot "+t);var Le=(r,e,t)=>(pt(r,e,"read from private field"),t?t.call(r):e.get(r)),$e=(r,e,t)=>e.has(r)?Ft("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),ht=(r,e,t,s)=>(pt(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t),jt=(r,e,t)=>(pt(r,e,"access private method"),t);import{c as Ne,a as D,n as ct,t as Y,d as sr}from"../chunks/disclose-version.BBU7oq9N.js";import{v as Ee,N as St,m as ir,s as zr,a7 as nr,o as Et,w as Ze,a3 as kr,U as Nr,ar,M as gt,C as Tr,S as or,a8 as Dr,a9 as Pt,L as mt,as as it,a6 as lr,y as cr,F as nt,at as It,au as Vt,av as Ct,aw as Fr,V as Ur,a0 as Jt,ax as jr,R as Pr,ay as Vr,q as Jr,H as Gr,O as Zr,D as ur,az as Br,J as Qr,aA as Yr,a5 as Gt,aB as Hr,E as Wr,aC as $r,aD as qr,aa as ut,b as dr,aE as Kr,n as qe,aF as Xr,z as Zt,A as Bt,x as es,a2 as ts,p as Ae,aG as Te,aH as dt,h as fe,j as M,k as S,t as ie,l as P,g as i,W as V,i as xe,aI as ee,e as ye,aJ as at,f as fr,aK as rs,al as Ie,aL as ss,ao as Se,aM as vr,aq as Qt}from"../chunks/runtime.C1_B45BB.js";import{d as is,a as le,e as Qe,f as He}from"../chunks/store.B1gyNW-u.js";import{c as ns,p as B,i as ce,b as Ot,o as We,d as as,e as os,a as rt}from"../chunks/index-client.DXncgjFY.js";import{i as Oe}from"../chunks/lifecycle.D3C2k4G7.js";import{w as Ye,g as ke}from"../chunks/index.DjD2UYa4.js";function pr(r,e,t){Ee&&St();var s=r,a=kr,o;ir(()=>{zr(a,a=e())&&(o&&nr(o),o=Et(()=>t(s)))}),Ee&&(s=Ze)}let yt=null;function De(r,e){return e}function ls(r,e,t,s){for(var a=[],o=e.length,f=0;f<o;f++)jr(e[f].e,a,!0);var h=o>0&&a.length===0&&t!==null;if(h){var c=t.parentNode;Pr(c),c.append(t),s.clear(),Fe(r,e[0].prev,e[o-1].next)}Vr(a,()=>{for(var p=0;p<o;p++){var _=e[p];h||(s.delete(_.k),Fe(r,_.prev,_.next)),Jr(_.e,!h)}})}function Ce(r,e,t,s,a,o=null){var f=r,h={flags:e,items:new Map,first:null},c=(e&ar)!==0;if(c){var p=r;f=Ee?gt(Gr(p)):p.appendChild(Nr())}Ee&&St();var _=null,v=!1;ir(()=>{var d=t(),b=Tr(d)?d:d==null?[]:or(d),g=b.length;if(v&&g===0)return;v=g===0;let E=!1;if(Ee){var C=f.data===Dr;C!==(g===0)&&(f=Pt(),gt(f),mt(!1),E=!0)}if(Ee){for(var R=null,T,z=0;z<g;z++){if(Ze.nodeType===8&&Ze.data===Zr){f=Ze,E=!0,mt(!1);break}var A=b[z],O=s(A,z);T=hr(Ze,h,R,null,A,O,z,a,e),h.items.set(O,T),R=T}g>0&&gt(Pt())}if(!Ee){var U=ur;cs(b,h,f,a,e,(U.f&it)!==0,s)}o!==null&&(g===0?_?lr(_):_=Et(()=>o(f)):_!==null&&nr(_,()=>{_=null})),E&&mt(!0),t()}),Ee&&(f=Ze)}function cs(r,e,t,s,a,o,f){var H,Q,ne,_e;var h=(a&Br)!==0,c=(a&(It|Ct))!==0,p=r.length,_=e.items,v=e.first,d=v,b,g=null,E,C=[],R=[],T,z,A,O;if(h)for(O=0;O<p;O+=1)T=r[O],z=f(T,O),A=_.get(z),A!==void 0&&((H=A.a)==null||H.measure(),(E??(E=new Set)).add(A));for(O=0;O<p;O+=1){if(T=r[O],z=f(T,O),A=_.get(z),A===void 0){var U=d?d.e.nodes_start:t;g=hr(U,e,g,g===null?e.first:g.next,T,z,O,s,a),_.set(z,g),C=[],R=[],d=g.next;continue}if(c&&us(A,T,O,a),A.e.f&it&&(lr(A.e),h&&((Q=A.a)==null||Q.unfix(),(E??(E=new Set)).delete(A))),A!==d){if(b!==void 0&&b.has(A)){if(C.length<R.length){var I=R[0],y;g=I.prev;var w=C[0],J=C[C.length-1];for(y=0;y<C.length;y+=1)Yt(C[y],I,t);for(y=0;y<R.length;y+=1)b.delete(R[y]);Fe(e,w.prev,J.next),Fe(e,g,w),Fe(e,J,I),d=I,g=J,O-=1,C=[],R=[]}else b.delete(A),Yt(A,d,t),Fe(e,A.prev,A.next),Fe(e,A,g===null?e.first:g.next),Fe(e,g,A),g=A;continue}for(C=[],R=[];d!==null&&d.k!==z;)(o||!(d.e.f&it))&&(b??(b=new Set)).add(d),R.push(d),d=d.next;if(d===null)continue;A=d}C.push(A),g=A,d=A.next}if(d!==null||b!==void 0){for(var Z=b===void 0?[]:or(b);d!==null;)(o||!(d.e.f&it))&&Z.push(d),d=d.next;var k=Z.length;if(k>0){var j=a&ar&&p===0?t:null;if(h){for(O=0;O<k;O+=1)(ne=Z[O].a)==null||ne.measure();for(O=0;O<k;O+=1)(_e=Z[O].a)==null||_e.fix()}ls(e,Z,j,_)}}h&&cr(()=>{var ae;if(E!==void 0)for(A of E)(ae=A.a)==null||ae.apply()}),nt.first=e.first&&e.first.e,nt.last=g&&g.e}function us(r,e,t,s){s&It&&Vt(r.v,e),s&Ct?Vt(r.i,t):r.i=t}function hr(r,e,t,s,a,o,f,h,c){var p=yt;try{var _=(c&It)!==0,v=(c&Fr)===0,d=_?v?Ur(a):Jt(a):a,b=c&Ct?Jt(f):f,g={i:b,v:d,k:o,a:null,e:null,prev:t,next:s};return yt=g,g.e=Et(()=>h(r,d,b),Ee),g.e.prev=t&&t.e,g.e.next=s&&s.e,t===null?e.first=g:(t.next=g,t.e.next=g.e),s!==null&&(s.prev=g,s.e.prev=g.e),g}finally{yt=p}}function Yt(r,e,t){for(var s=r.next?r.next.e.nodes_start:t,a=e?e.e.nodes_start:t,o=r.e.nodes_start;o!==s;){var f=Qr(o);a.before(o),o=f}}function Fe(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function _t(r,e,t,s,a){var h;Ee&&St();var o=(h=e.$$slots)==null?void 0:h[t],f=!1;o===!0&&(o=e[t==="default"?"children":t],f=!0),o===void 0||o(r,f?()=>s:s)}let Ht=!1;function ds(){Ht||(Ht=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var e;if(!r.defaultPrevented)for(const t of r.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function X(r,e,t,s){var a=r.__attributes??(r.__attributes={});Ee&&(a[e]=r.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&r.nodeName==="LINK")||a[e]!==(a[e]=t)&&(e==="style"&&"__styles"in r&&(r.__styles={}),e==="loading"&&(r[Yr]=t),t==null?r.removeAttribute(e):typeof t!="string"&&fs(r).includes(e)?r[e]=t:r.setAttribute(e,t))}var Wt=new Map;function fs(r){var e=Wt.get(r.nodeName);if(e)return e;Wt.set(r.nodeName,e=[]);for(var t,s=Gt(r),a=Element.prototype;a!==s;){t=Hr(s);for(var o in t)t[o].set&&e.push(o);s=Gt(s)}return e}function vs(r,e){var t=r.__className,s=ps(e);Ee&&r.getAttribute("class")===s?r.__className=s:(t!==s||Ee&&r.getAttribute("class")!==s)&&(s===""?r.removeAttribute("class"):r.setAttribute("class",s),r.__className=s)}function ps(r){return r??""}function be(r,e,t){if(t){if(r.classList.contains(e))return;r.classList.add(e)}else{if(!r.classList.contains(e))return;r.classList.remove(e)}}const hs=()=>performance.now(),Pe={tick:r=>requestAnimationFrame(r),now:()=>hs(),tasks:new Set};function gr(r){Pe.tasks.forEach(e=>{e.c(r)||(Pe.tasks.delete(e),e.f())}),Pe.tasks.size!==0&&Pe.tick(gr)}function gs(r){let e;return Pe.tasks.size===0&&Pe.tick(gr),{promise:new Promise(t=>{Pe.tasks.add(e={c:r,f:t})}),abort(){Pe.tasks.delete(e)}}}function $t(r,e){r.dispatchEvent(new CustomEvent(e))}function ms(r){if(r==="float")return"cssFloat";if(r==="offset")return"cssOffset";if(r.startsWith("--"))return r;const e=r.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function qt(r){const e={},t=r.split(";");for(const s of t){const[a,o]=s.split(":");if(!a||o===void 0)break;const f=ms(a.trim());e[f]=o.trim()}return e}const ys=r=>r;function mr(r,e,t,s){var a=(r&Xr)!==0,o="in",f,h=e.inert,c,p;function _(){var E=ur,C=nt;Zt(null),Bt(null);try{return f??(f=t()(e,(s==null?void 0:s())??{},{direction:o}))}finally{Zt(E),Bt(C)}}var v={is_global:a,in(){e.inert=h,c==null||c.abort(),$t(e,"introstart"),c=yr(e,_(),p,1,()=>{$t(e,"introend"),c==null||c.abort(),c=f=void 0})},out(E){{E==null||E(),f=void 0;return}},stop:()=>{c==null||c.abort()}},d=nt;if((d.transitions??(d.transitions=[])).push(v),is){var b=a;if(!b){for(var g=d.parent;g&&g.f&Wr;)for(;(g=g.parent)&&!(g.f&$r););b=!g||(g.f&qr)!==0}b&&ut(()=>{dr(()=>v.in())})}}function yr(r,e,t,s,a){if(Kr(e)){var o,f=!1;return cr(()=>{if(!f){var E=e({direction:"in"});o=yr(r,E,t,s,a)}}),{abort:()=>{f=!0,o==null||o.abort()},deactivate:()=>o.deactivate(),reset:()=>o.reset(),t:()=>o.t()}}if(!(e!=null&&e.duration))return a(),{abort:qe,deactivate:qe,reset:qe,t:()=>s};const{delay:h=0,css:c,tick:p,easing:_=ys}=e;var v=[];if(p&&p(0,1),c){var d=qt(c(0,1));v.push(d,d)}var b=()=>1-s,g=r.animate(v,{duration:h});return g.onfinish=()=>{var E=1-s,C=s-E,R=e.duration*Math.abs(C),T=[];if(R>0){if(c)for(var z=Math.ceil(R/16.666666666666668),A=0;A<=z;A+=1){var O=E+C*_(A/z),U=c(O,1-O);T.push(qt(U))}b=()=>{var I=g.currentTime;return E+C*_(I/R)},p&&gs(()=>{if(g.playState!=="running")return!1;var I=b();return p(I,1-I),!0})}g=r.animate(T,{duration:R,fill:"forwards"}),g.onfinish=()=>{b=()=>s,p==null||p(s,1-s),a()}},{abort:()=>{g&&(g.cancel(),g.effect=null,g.onfinish=qe)},deactivate:()=>{a=qe},reset:()=>{},t:()=>b()}}function _s(r,e,t,s=t){r.addEventListener(e,t);const a=r.__on_r;a?r.__on_r=()=>{a(),s()}:r.__on_r=s,ds()}function bs(r,e,t){var s=ts(r,e);s&&s.set&&(r[e]=t,es(()=>{r[e]=null}))}function _r(r,e,t){if(r.multiple)return As(r,e);for(var s of r.options){var a=Xe(s);if(ns(a,e)){s.selected=!0;return}}(!t||e!==void 0)&&(r.selectedIndex=-1)}function ws(r,e){ut(()=>{var t=new MutationObserver(()=>{var s=r.__value;_r(r,s)});return t.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function Mt(r,e,t=e){var s=!0;_s(r,"change",()=>{var a;if(r.multiple)a=[].map.call(r.querySelectorAll(":checked"),Xe);else{var o=r.querySelector(":checked");a=o&&Xe(o)}t(a)}),ut(()=>{var a=e();if(_r(r,a,s),s&&a===void 0){var o=r.querySelector(":checked");o!==null&&(a=Xe(o),t(a))}r.__value=a,s=!1}),ws(r)}function As(r,e){for(var t of r.options)t.selected=~e.indexOf(Xe(t))}function Xe(r){return"__value"in r?r.__value:r.value}var je,Be,tt,ot,br;const lt=class lt{constructor(e){$e(this,ot);$e(this,je,new WeakMap);$e(this,Be);$e(this,tt);ht(this,tt,e)}observe(e,t){var s=Le(this,je).get(e)||new Set;return s.add(t),Le(this,je).set(e,s),jt(this,ot,br).call(this).observe(e,Le(this,tt)),()=>{var a=Le(this,je).get(e);a.delete(t),a.size===0&&(Le(this,je).delete(e),Le(this,Be).unobserve(e))}}};je=new WeakMap,Be=new WeakMap,tt=new WeakMap,ot=new WeakSet,br=function(){return Le(this,Be)??ht(this,Be,new ResizeObserver(e=>{for(var t of e){lt.entries.set(t.target,t);for(var s of Le(this,je).get(t.target)||[])s(t)}}))},Ut(lt,"entries",new WeakMap);let wt=lt;var xs=new wt({box:"border-box"});function At(r,e,t){var s=xs.observe(r,()=>t(r[e]));ut(()=>(dr(()=>t(r[e])),s))}function wr(r){return function(...e){var t=e[0];return t.preventDefault(),r==null?void 0:r.apply(this,e)}}function Kt(r,e){e&&e!=="lg"&&e!=="sm"&&e!=="xs"?r.style.fontSize=e.replace("x","em"):r.style.fontSize=""}function Ss(r,e,t,s,a,o=1,f="",h=""){let c=1,p=1;a&&(a=="horizontal"?c=-1:a=="vertical"?p=-1:c=p=-1),typeof r=="string"&&(r=parseFloat(r)),typeof e=="string"&&(e=parseFloat(e)),typeof t=="string"&&(t=parseFloat(t));const _=`${e*o}${f}`,v=`${t*o}${f}`;let d=`translate(${_},${v}) scale(${c*r},${p*r})`;return s&&(d+=` rotate(${s}${h})`),d}var Es=ct('<title class="svelte-bvo74f"> </title>'),Is=ct('<path class="svelte-bvo74f"></path>'),Cs=ct('<path class="svelte-bvo74f"></path><path class="svelte-bvo74f"></path>',1),Os=ct('<svg aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg"><!><g class="svelte-bvo74f"><g class="svelte-bvo74f"><!></g></g></svg>');function Ge(r,e){Ae(e,!1);const t=ee(),s=ee();let a=B(e,"class",24,()=>{}),o=B(e,"id",24,()=>{}),f=B(e,"style",24,()=>{}),h=B(e,"icon",8),c=B(e,"title",24,()=>{}),p=B(e,"size",24,()=>{}),_=B(e,"color",24,()=>{}),v=B(e,"fw",8,!1),d=B(e,"pull",24,()=>{}),b=B(e,"scale",8,1),g=B(e,"translateX",8,0),E=B(e,"translateY",8,0),C=B(e,"rotate",24,()=>{}),R=B(e,"flip",24,()=>{}),T=B(e,"spin",8,!1),z=B(e,"pulse",8,!1),A=B(e,"primaryColor",8,""),O=B(e,"secondaryColor",8,""),U=B(e,"primaryOpacity",8,1),I=B(e,"secondaryOpacity",8,.4),y=B(e,"swapOpacity",8,!1),w=ee();Te(()=>(i(w),ye(p()),Kt),()=>{i(w)&&p()&&Kt(i(w),p())}),Te(()=>ye(h()),()=>{V(t,h()&&h().icon||[0,0,"",[],""])}),Te(()=>(ye(b()),ye(g()),ye(E()),ye(C()),ye(R())),()=>{V(s,Ss(b(),g(),E(),C(),R(),512))}),dt(),Oe();var J=Ne(),Z=fe(J);ce(Z,()=>i(t)[4],k=>{var j=Os(),H=M(j);ce(H,c,ae=>{var G=Es(),oe=M(G,!0);S(G),ie(()=>le(oe,c())),D(ae,G)});var Q=P(H),ne=M(Q),_e=M(ne);ce(_e,()=>typeof i(t)[4]=="string",ae=>{var G=Is();ie(()=>{X(G,"d",i(t)[4]),X(G,"fill",_()||A()||"currentColor"),X(G,"transform",`translate(${i(t)[0]/-2} ${i(t)[1]/-2})`)}),D(ae,G)},ae=>{var G=Cs(),oe=fe(G),me=P(oe);ie(()=>{X(oe,"d",i(t)[4][0]),X(oe,"fill",O()||_()||"currentColor"),X(oe,"fill-opacity",y()!=!1?U():I()),X(oe,"transform",`translate(${i(t)[0]/-2} ${i(t)[1]/-2})`),X(me,"d",i(t)[4][1]),X(me,"fill",A()||_()||"currentColor"),X(me,"fill-opacity",y()!=!1?I():U()),X(me,"transform",`translate(${i(t)[0]/-2} ${i(t)[1]/-2})`)}),D(ae,G)}),S(ne),S(Q),S(j),Ot(j,ae=>V(w,ae),()=>i(w)),ie(()=>{X(j,"id",o()),vs(j,`svelte-fa svelte-fa-base ${a()??""} svelte-bvo74f`),X(j,"style",f()),X(j,"viewBox",`0 0 ${i(t)[0]??""} ${i(t)[1]??""}`),be(j,"pulse",z()),be(j,"svelte-fa-size-lg",p()==="lg"),be(j,"svelte-fa-size-sm",p()==="sm"),be(j,"svelte-fa-size-xs",p()==="xs"),be(j,"svelte-fa-fw",v()),be(j,"svelte-fa-pull-left",d()==="left"),be(j,"svelte-fa-pull-right",d()==="right"),be(j,"spin",T()),X(Q,"transform",`translate(${i(t)[0]/2} ${i(t)[1]/2})`),X(Q,"transform-origin",`${i(t)[0]/4} 0`),X(ne,"transform",i(s))}),D(k,j)}),D(r,J),xe()}const Ms={prefix:"fas",iconName:"caret-right",icon:[256,512,[],"f0da","M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"]},Ar={prefix:"fas",iconName:"ban",icon:[512,512,[128683,"cancel"],"f05e","M367.2 412.5L99.5 144.8C77.1 176.1 64 214.5 64 256c0 106 86 192 192 192c41.5 0 79.9-13.1 111.2-35.5zm45.3-45.3C434.9 335.9 448 297.5 448 256c0-106-86-192-192-192c-41.5 0-79.9 13.1-111.2 35.5L412.5 367.2zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256z"]},Rs={prefix:"fas",iconName:"pen",icon:[512,512,[128394],"f304","M362.7 19.3L314.3 67.7 444.3 197.7l48.4-48.4c25-25 25-65.5 0-90.5L453.3 19.3c-25-25-65.5-25-90.5 0zm-71 71L58.6 323.5c-10.4 10.4-18 23.3-22.2 37.4L1 481.2C-1.5 489.7 .8 498.8 7 505s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L421.7 220.3 291.7 90.3z"]},Rt={prefix:"fas",iconName:"trash",icon:[448,512,[],"f1f8","M135.2 17.7L128 32 32 32C14.3 32 0 46.3 0 64S14.3 96 32 96l384 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-96 0-7.2-14.3C307.4 6.8 296.3 0 284.2 0L163.8 0c-12.1 0-23.2 6.8-28.6 17.7zM416 128L32 128 53.2 467c1.6 25.3 22.6 45 47.9 45l245.8 0c25.3 0 46.3-19.7 47.9-45L416 128z"]};var Ls=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zs(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var xr={exports:{}};/*!
 * jsonurl.js v1.1.8
 * (c) 2024 David MacCormack
 * Released under the MIT License.
 */(function(r,e){(function(t,s){r.exports=s()})(Ls,function(){const t="JSON->URL: expected literal value",s="JSON->URL: unexpected character",a="JSON->URL: unexpected end of text inside composite",o="JSON->URL: unexpected text after composite",f="JSON->URL: can not represent null with implied strings",h="JSON->URL: the empty string is not allowed",c="JSON->URL: invalid escape sequence",p="JSON->URL: invalid percent-encoded sequence",_="JSON->URL: expected object value";function v(m,n){return n===void 0?m:m+" at position "+n}const d=16,b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,6,6,48,10,20,20,6,6,20,6,6,6,6,6,6,6,6,6,6,6,6,6,20,6,0,48,0,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,0,0,0,0,6,0,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,0,0,0,6,0];function g(m){return m>127?0:b[m]}class E{constructor(n){this.setOrDefault(n,"allowEmptyUnquotedValues"),this.setOrDefault(n,"allowEmptyUnquotedKeys"),this.setOrDefault(n,"AQF"),this.setOrDefault(n,"coerceNullToEmptyString"),this.setOrDefault(n,"ignoreNullArrayMembers"),this.setOrDefault(n,"ignoreNullObjectMembers"),this.setOrDefault(n,"impliedArray"),this.setOrDefault(n,"impliedObject"),this.setOrDefault(n,"impliedStringLiterals"),this.setOrDefault(n,"noEmptyComposite"),this.setOrDefault(n,"wwwFormUrlEncoded")}setOrDefault(n,u,l){n!==void 0&&u in n?u in this||(this[u]=n[u]):l===void 0||u in this||(this[u]=l)}setOverride(n,u){n!==void 0&&u in n&&(this[u]=n[u])}setOrDefaultInt(n,u,l){this.setOrDefault(n,u,l===void 0?l:parseInt(l))}isPresentAndTrue(n){return n in this&&this[n]}}class C extends E{constructor(n,u){super(n),this.setOrDefault(n,"emptyValue"),this.setOrDefault(u,"emptyValue",{}),this.setOverride(n,"getMissingValue"),this.setOrDefaultInt(n,"maxParseChars"),this.setOrDefaultInt(u,"maxParseChars",32768),this.setOrDefaultInt(n,"maxParseDepth"),this.setOrDefaultInt(u,"maxParseDepth",32),this.setOrDefaultInt(n,"maxParseValues"),this.setOrDefaultInt(u,"maxParseValues",4096),this.setOrDefault(n,"nullValue"),this.setOrDefault(u,"nullValue",null)}getMissingValue(n,u){throw new SyntaxError(v(_,u))}}class R extends E{constructor(n){super(n);const u=!(n===void 0||!("impliedStringLiterals"in n)||!n.impliedStringLiterals)||void 0;this.setOrDefault(n,"allowEmptyUnquotedValues",u),this.setOrDefault(n,"allowEmptyUnquotedKeys",u),this.setOrDefault(n,"callFunctions"),this.setOrDefault(n,"isImplied"),this.setOrDefault(n,"ignoreNullArrayMembers",u),this.setOrDefault(n,"ignoreNullObjectMembers",u),this.setOrDefault(n,"ignoreUndefinedArrayMembers",u),this.setOrDefault(n,"ignoreUndefinedObjectMembers",u),this.isImplied=this.isImplied||this.impliedArray||this.impliedObject}}const T=/\+/g,z=/ /g,A=/(![\s\S]?)/g,O=/^[-A-Za-z0-9._~!$*;@?/ ][-A-Za-z0-9._~!$*;@?/' ]*$/,U=/^[-A-Za-z0-9._~!$*,;@?/(): ]+$/,I=/^-?\d+(?:\.\d+)?(?:[eE][-]?\d+)?$/,y=/^-?\d+(?:\.\d+)?[eE]\+\d+$/,w=/^-?\d+(?:\.\d+)?[eE] \d+$/,J=/[(),:]|%2[04]|%3B/gi,Z={"%20":"+","%24":"$","(":"%28",")":"%29",",":"%2C",":":"%3A","%3B":";"},k=/[!(),:]|%2[01489BC]|%3[AB]/gi,j={"%20":"+","%21":"!!","!":"!!","%24":"$","%28":"!(","(":"!(","%29":"!)",")":"!)","+":"!+","%2B":"!+","%2C":"!,",",":"!,","%3A":"!:",":":"!:","%3B":";"},H=40,Q=41,ne=44,_e=58,ae=38,G=48,oe=65,me=97,te=new Array(111);te[33]="!",te[40]="(",te[41]=")",te[43]="+",te[44]=",",te[45]=",",te[G]="0",te[G+1]="1",te[G+2]="2",te[G+3]="3",te[G+4]="4",te[G+5]="5",te[G+6]="6",te[G+7]="7",te[G+8]="8",te[G+9]="9",te[58]=":",te[116]="t",te[102]="f",te[110]="n";const ve="",L="!e",re=" ";function ue(m,n){const u=n?k:J,l=n?j:Z;return encodeURIComponent(m).replace(u,function(x){const $=l[x];return $===void 0?x:$})}function de(m,n){switch(n){case G:return 0;case G+1:return 1;case G+2:return 2;case G+3:return 3;case G+4:return 4;case G+5:return 5;case G+6:return 6;case G+7:return 7;case G+8:return 8;case G+9:return 9;case oe:case me:return 10;case oe+1:case me+1:return 11;case oe+2:case me+2:return 12;case oe+3:case me+3:return 13;case oe+4:case me+4:return 14;case oe+5:case me+5:return 15;default:throw new SyntaxError(v(p,m))}}function he(m){if(m.coerceNullToEmptyString)return Ve(m,!1);if(m.impliedStringLiterals)throw new SyntaxError(f);return"null"}function Ve(m,n){if(n?m.allowEmptyUnquotedKeys:m.allowEmptyUnquotedValues)return ve;if(m.AQF)return L;if(m.impliedStringLiterals)throw new SyntaxError(h);return"''"}(function(m){let{toJsonURLText_Array:n,toJsonURLText_Boolean:u,toJsonURLText_Number:l,toJsonURLText_Object:x,toJsonURLText_String:$}=m;Object.defineProperty(Array.prototype,"toJsonURLText",{value:n}),Object.defineProperty(Boolean.prototype,"toJsonURLText",{value:u}),Object.defineProperty(Number.prototype,"toJsonURLText",{value:l}),Object.defineProperty(Object.prototype,"toJsonURLText",{value:x}),Object.defineProperty(String.prototype,"toJsonURLText",{value:$})})({toJsonURLText_Array:function(){let m,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return this.forEach(function(l){if(typeof l=="function"){if(!n.callFunctions)return;for(;typeof l=="function";)l=l()}if(l===void 0){if(n.ignoreUndefinedArrayMembers)return;l=he(n)}else if(l===null){if(n.ignoreNullArrayMembers)return;l=he(n)}else l=l.toJsonURLText(n,u+1);m===void 0?m=l:!n.wwwFormUrlEncoded||u>0?m+=","+l:m+="&"+l}),!n.isImplied||u>0?m===void 0?"()":"("+m+")":m===void 0?ve:m},toJsonURLText_Boolean:function(){return this===!0?"true":"false"},toJsonURLText_Number:function(m){const n=String(this);return m.impliedStringLiterals&&n.indexOf("+")!==-1?ue(n,m):n},toJsonURLText_Object:function(){let m,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const l=Object.keys(this),x=this;return l.forEach(function($){if($==null)return;let W=x[$];if(typeof W=="function"){if(!n.callFunctions)return;for(;typeof W=="function";)W=W()}if(W===void 0){if(n.ignoreUndefinedObjectMembers)return;W=he(n)}else if(W===null){if(n.ignoreNullObjectMembers)return;W=he(n)}else W=W.toJsonURLText(n,u+1);const K=$.toJsonURLText(n,u,!0);m===void 0?m=!n.wwwFormUrlEncoded||u>0?K+":"+W:K+"="+W:!n.wwwFormUrlEncoded||u>0?m+=","+K+":"+W:m+="&"+K+"="+W}),!n.isImplied||u>0?(n.noEmptyComposite&&m===void 0&&(m=":"),m===void 0?"()":"("+m+")"):m===void 0?ve:m},toJsonURLText_String:function(m,n,u){if(this.length===0)return Ve(m,u);if(m.impliedStringLiterals)return ue(this,m.AQF);if((l=this)==="true"||l==="false"||l==="null"||I.test(l))return u===!0?this:m.AQF?"!"+this:"'"+this+"'";var l;if(y.test(this))return m.AQF?this.replace("+","!+"):this.replace("+","%2B");if(w.test(this))return m.AQF?"!"+this.replace(re,"+"):"'"+this.replace(re,"+")+"'";if(m.AQF)return ue(this,!0);if(O.test(this))return this.indexOf(re)==-1?this:this.replace(z,"+");if(U.test(this))return this.indexOf(re)==-1?"'"+this+"'":"'"+this.replace(z,"+")+"'";let x=ue(this);return x.charCodeAt(0)==39?"%27"+x.substring(1):x}});class pe{constructor(n,u,l,x){this.text=n,this.pos=this.markPos=u,this.end=l,this.options=x}skipAmps(){let n=arguments.length>0&&arguments[0]!==void 0&&arguments[0];const u=this.text,l=this.end;let x=this.pos;if(n)for(;x<l&&u.charCodeAt(x)===ae;)x++;else if(x<l&&u.charCodeAt(x)===ae){for(x++;x<l&&u.charCodeAt(x)===ae;x++);x!==l&&x--}this.pos=x}structChar(){let n=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.options.wwwFormUrlEncoded){const x=this.text.charCodeAt(this.pos);switch(x){case ae:case 61:return n?void 0:(this.pos++,x)}}const u=this.pos,l=this.ordinal();switch(l){case ne:case _e:if(n)return void(this.pos=u);case H:case Q:return l;default:return void(this.pos=u)}}ordinal(n){return n!==void 0?this.text.charCodeAt(n):this.text.charCodeAt(this.pos++)}accept(n){const u=this.pos;return this.ordinal()===n||(this.pos=u,!1)}acceptPlus(){return this.text.charCodeAt(this.pos)==43&&(this.pos++,!0)}done(){return this.end<=this.pos}validateLiteral(n,u){const l=this.text,x=this.end;for(;n<x;n++)switch(g(l.charCodeAt(n))&u){case 0:throw new SyntaxError(v(s,n));case d:return n;case 8:return n+1;default:continue}}findLiteralEnd(){const n=this.text,u=this.end;let l=this.pos;const x=n.charCodeAt(l)===39;x&&l++;const $=x?28:18;if(l=this.validateLiteral(l,$),l!==void 0)return l;if(x)throw new SyntaxError(v("JSON->URL: quoted string still open",l));return u}isEmptyObject(){if(this.options.noEmptyComposite){const n=this.pos;if(!this.accept(_e))return!1;const u=this.pos,l=this.accept(Q);return this.pos=l?u:n,l}return!1}parseLiteral(n){const u=this.pos,l=this.options,x=this.findLiteralEnd();if(n===void 0&&(n=this.ordinal(x)==_e),x<=u)return function(K,F){if(F)return ve;throw new SyntaxError(v(h,K))}(u,n?this.options.allowEmptyUnquotedKeys:this.options.allowEmptyUnquotedValues);if(l.impliedStringLiterals===!0)return this.parseStringLiteral(x,!0);const $=this.parseTrueFalseNull(x,n);if($!==void 0)return $;const W=this.parseNumberLiteral(x,n);return W!==void 0?W:this.parseStringLiteral(x,!1)}parseDigits(n){let u,l=!1;for(;this.pos<n;)switch(this.ordinal()){case G:case G+1:case G+2:case G+3:case G+4:case G+5:case G+6:case G+7:case G+8:case G+9:u=this.pos,l=!0;continue;default:return this.pos=u,l}return this.pos=u,l}parseExponentValue(n){return!(n<=this.pos)&&(this.acceptPlus()||this.accept(45),this.parseDigits(n))}parseExponent(n){const u=this.pos;switch(this.ordinal()){case 69:case 101:if(this.parseExponentValue(n))return!0}return this.pos=u,!1}parseFraction(n){const u=this.pos;return!(n<=u)&&(!(!this.accept(46)||!this.parseDigits(n))||(this.pos=u,!1))}parseInteger(n){return!(n<=this.pos)&&(!!this.accept(G)||this.parseDigits(n))}parseNumberLiteral(n,u){const l=this.text,x=this.pos;if(this.accept(45),this.parseInteger(n)&&(this.parseFraction(n),this.parseExponent(n),this.pos===n)){const $=decodeURIComponent(l.substring(x,n));return u?$:Number($)}this.pos=x}parseStringLiteral(n,u){const l=this.text,x=this.pos;let $=u||l.charCodeAt(x)!==39?l.substring(x,n):l.substring(x+1,n-1);return $=decodeURIComponent($.replace(T,re)),this.pos=n,$}parseTrueFalseNull(n,u){const l=this.text,x=this.pos;let $,W,K,F,q;switch(n-x){case 4:if($=l.charCodeAt(x),W=l.charCodeAt(x+1),K=l.charCodeAt(x+2),F=l.charCodeAt(x+3),$===116&&W===114&&K===117&&F===101)return this.pos=n,!u||"true";if($===110&&W===117&&K===108&&F===108)return this.pos=n,u?"null":this.newNullValue();break;case 5:if($=l.charCodeAt(x),W=l.charCodeAt(x+1),K=l.charCodeAt(x+2),F=l.charCodeAt(x+3),q=l.charCodeAt(x+4),$===102&&W===me&&K===108&&F===115&&q===101)return this.pos=n,!!u&&"false"}}newEmptyValue(){const n=this.options;if(n.noEmptyComposite)return[];const u=n.emptyValue;return typeof u=="function"?u():u}newNullValue(){const n=this.options;let u=n.nullValue;return typeof u=="function"&&(u=u()),u==null&&n.coerceNullToEmptyString&&(u=ve),u}}class Me extends pe{constructor(n,u,l,x){super(n,u,l,x)}ordinal(n){const u=n||this.pos,l=this.text.charCodeAt(u);let x,$;return l===37?(x=function(W,K,F){if(F<=K+1)throw new SyntaxError(v(p,K));return de(K,W.charCodeAt(K))<<4|de(K,W.charCodeAt(K+1))}(this.text,u+1,this.end),$=3):(x=l,$=1),n===void 0&&(this.pos+=$),x}findLiteralEnd(){const n=this.end,u=this.pos,l=this.text;let x=u;for(;;){if(n<=this.pos)return this.pos=u,n;switch(50&g(l.charCodeAt(this.pos))){case 48:if(this.options.wwwFormUrlEncoded)return x=this.pos,this.pos=u,x;case 0:throw new SyntaxError(v(s,x))}switch(this.ordinal()){case H:case Q:case _e:case ne:return this.pos=u,x;case 33:if(this.pos===n)throw new SyntaxError(v(c,x));this.ordinal(),x=this.pos;break;default:x=this.pos}}}parseStringLiteral(n){const u=this.text,l=this.pos,x=decodeURIComponent(u.substring(l,n).replace(T,function($,W){return W!==0&&function(K,F){return K.charCodeAt(F-1)===33||F>2&&K.charCodeAt(F-3)===37&&K.charCodeAt(F-2)===G+2&&K.charCodeAt(F-1)===G+1}(u,l+W)?"+":re}));return this.pos=n,x==="!e"?ve:x.replace(A,function($,W,K){if($.length===2){const F=$.charCodeAt(1),q=te[F];if(q!==void 0)return q}throw new SyntaxError(v(c,l+K))})}}class ft extends Array{constructor(n){super(),this.limits=n,this.parseDepth=0}replaceAndPush(n,u,l){if(this[this.parseDepth]=u,++this.parseDepth>=this.limits.maxParseDepth)throw new Error(v("JSON->URL: MaxParseDepth exceeded",n));this.push(l)}replace(n){this[this.parseDepth]=n}depth(){return arguments.length>0&&arguments[0]!==void 0&&arguments[0]&&(this.parseDepth--,this.pop()),this.parseDepth}}class Mr extends Array{constructor(n){super(),this.limits=n,this.numValues=0}popObjectValue(n){let u=this.pop(),l=this.pop(),x=this[this.length-1];return u===null&&n.isPresentAndTrue("ignoreNullObjectMembers")||(x[l]=u),x}popArrayValue(n){let u=this.pop(),l=this[this.length-1];return u===null&&n.isPresentAndTrue("ignoreNullArrayMembers")||l.push(u),l}checkValueLimit(n){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;if(this.numValues+=u,this.numValues>this.limits.maxParseValues+1)throw new Error(v("JSON->URL: MaxParseValues exceeded",n))}appendArrayValue(n,u){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;this.checkValueLimit(n,l),this.push(u)}}function zt(m){for(;typeof m=="function";)m=m();return m}function kt(m,n,u,l){return typeof m=="number"?typeof n!="number"&&(u=n):u=m,(u=zt(u))instanceof C||(u=new C(u,l)),u}function Nt(m,n,u,l){return l.AQF?new Me(m,n,u,l):new pe(m,n,u,l)}function Tt(m,n){return typeof m=="number"?m:n}function Dt(m,n,u,l,x){if(m===void 0)return;l=kt(n,u,l,x),m=String(m);const $=Tt(n,0),W=Tt(u,m.length);if(W<=$){if(l.impliedArray!==void 0)return l.impliedArray;if(l.impliedObject!==void 0)return l.impliedObject;throw new SyntaxError(v("JSON->URL: expected value",0))}if(W>l.maxParseChars)throw new Error("JSON->URL: MaxParseChars exceeded");const K=l.wwwFormUrlEncoded&&(l.impliedObject||l.impliedArray),F=new Mr(l),q=new ft(l),N=Nt(m,$,W,l);if(l.impliedObject!==void 0)F.push(l.impliedObject),q.push(6);else if(l.impliedArray!==void 0)F.push(l.impliedArray),q.push(2);else{if(N.structChar(!0)!==H){const ge=N.parseLiteral(!1);if(N.done())return ge;throw new SyntaxError(v(t,0))}q.push(1)}for(K&&N.skipAmps(!0);;){if(N.done())throw new SyntaxError(v(a,N.pos));let ge,vt,Re;switch(q[q.depth()]){case 1:switch(N.structChar(!0)){case H:F.appendArrayValue(N.pos,[]),q.replaceAndPush(N.pos,3,1);continue;case Q:if(q.depth(!0)===-1){if(N.done())return N.newEmptyValue();throw new SyntaxError(v(o,N.pos))}if(F.appendArrayValue(N.pos,N.newEmptyValue()),q.depth()===0&&(K&&N.skipAmps(),N.done())){if(l.impliedArray)return F.popArrayValue(l);if(l.impliedObject)return F.popObjectValue(l);throw new SyntaxError(v(a,N.pos))}continue}switch(F.checkValueLimit(N.pos),vt=N.isEmptyObject(),ge=vt?{}:N.parseLiteral(),Re=N.pos,N.structChar()){case ae:if(!l.wwwFormUrlEncoded||q.depth()>0)throw new SyntaxError(v(s,Re));case ne:q.replace(2),F.appendArrayValue(Re,[]),F.push(ge),F.popArrayValue(l);continue;case Q:switch(vt?F.push({}):F.appendArrayValue(Re,[ge]),q.depth(!0)){case-1:if(N.pos===W)return F[0];throw new SyntaxError(v(o,Re));case 0:if(K&&N.skipAmps(),N.done()){if(l.impliedArray)return F.popArrayValue(l);if(l.impliedObject)return F.popObjectValue(l);throw new SyntaxError(v(a,Re))}}continue;case 61:if(!l.wwwFormUrlEncoded||q.depth()>0)throw new SyntaxError(v(s,Re));case _e:q.replace(4),F.push({},ge);continue;default:throw new SyntaxError(v(t,Re))}case 2:if(N.accept(H)){q.replaceAndPush(N.pos,3,1);continue}if(F.checkValueLimit(N.pos),ge=N.parseLiteral(!1),K&&N.skipAmps(),N.done()){if(q.depth()===0&&l.impliedArray)return F.push(ge),F.popArrayValue(l);throw new SyntaxError(v(a,W))}q.replace(3),F.push(ge);continue;case 3:switch(F.popArrayValue(l),N.structChar()){case ae:if(!l.wwwFormUrlEncoded||q.depth()>0)throw new SyntaxError(v(s,N.pos));case ne:q.replace(2);continue;case Q:switch(q.depth(!0)){case-1:if(N.done()&&!l.impliedArray)return F[0];throw new SyntaxError(v(o,N.pos));case 0:if(K&&N.skipAmps(),N.done()){if(l.impliedArray)return F.popArrayValue(l);if(l.impliedObject)return F.popObjectValue(l);throw new SyntaxError(v(a,N.pos))}}continue}throw new SyntaxError(v("JSON->URL: expected comma or close paren",N.pos));case 4:if(N.accept(H)){q.replaceAndPush(N.pos,5,1);continue}if(F.checkValueLimit(N.pos),ge=N.parseLiteral(!1),K&&N.skipAmps(),N.done()){if(q.depth()===0&&l.impliedObject)return F.push(ge),F.popObjectValue(l);throw new SyntaxError(v(a,W))}q.replace(5),F.push(ge);continue;case 5:switch(F.popObjectValue(l),Re=N.pos,N.structChar()){case ae:if(!l.wwwFormUrlEncoded||q.depth()>0)throw new SyntaxError(v(s,Re));case ne:q.replace(6);continue;case Q:switch(q.depth(!0)){case-1:if(N.done()&&!l.impliedObject)return F[0];throw new SyntaxError(v(o,N.pos));case 0:if(K&&N.skipAmps(),N.done()){if(l.impliedArray)return F.popArrayValue(l);if(l.impliedObject)return F.popObjectValue(l);throw new SyntaxError(v(o,N.pos))}}continue}throw new SyntaxError(v("JSON->URL: expected comma, open paren, or close paren",N.pos));case 6:if(ge=N.parseLiteral(!0),K&&N.skipAmps(),N.done()){if(l.impliedObject&&q.depth()==0)return F.push(ge,l.getMissingValue(ge)),F.popObjectValue(l);throw new SyntaxError(v(a,W))}switch(N.structChar()){case 61:if(!l.wwwFormUrlEncoded||q.depth()>0)throw new SyntaxError(v(s,N.pos));case _e:break;case ae:if(!l.wwwFormUrlEncoded||q.depth()>0)throw new SyntaxError(v(s,N.pos));case ne:if(l.impliedObject&&q.depth()==0){F.push(ge,l.getMissingValue(ge)),F.popObjectValue(l);continue}default:throw new SyntaxError(v(_,N.pos))}q.replace(4),F.push(ge);continue;default:throw new SyntaxError(v("JSON->URL: internal error",N.pos))}}}return class{constructor(m){for(;typeof m=="function";)m=m();m===void 0&&(m={}),this.maxParseDepth=typeof m.maxParseDepth=="number"?parseInt(m.maxParseDepth):32,this.maxParseValues=typeof m.maxParseValues=="number"?parseInt(m.maxParseValues):4096,this.maxParseChars=typeof m.maxParseChars=="number"?parseInt(m.maxParseChars):32768,this.emptyValue=m.emptyValue===void 0?{}:m.emptyValue,this.nullValue=m.nullValue===void 0?null:m.nullValue}parseLiteral(m){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,l=arguments.length>3&&arguments[3]!==void 0&&arguments[3],x=arguments.length>4?arguments[4]:void 0;return m!==void 0&&(m=String(m)),u===void 0&&(u=m.length),Nt(m,n,u,kt(x)).parseLiteral(l)}static parse(m,n,u,l){return Dt(m,n,u,l,void 0)}parse(m,n,u,l){return Dt(m,n,u,l,this)}static stringify(m,n){if(m!==void 0)return n=new R(zt(n)),m===null?he(n):m.toJsonURLText(n,0)}}})})(xr);var ks=xr.exports;const Xt=zs(ks),Lt="https://idr-testing.openmicroscopy.org/",et=`${Lt}searchengine2/api/v1/`,er="https://idr-testing.openmicroscopy.org/",bt="container",Ns={image:"image",project:"experiment",screen:"screen",container:"experiments/screen"};async function Ts(){let r=`${et}resources/all/keys/?mode=searchterms`;return await Er(r)}function Ds(r,e,t=[]){return e=e.toLowerCase(),(s,a)=>{let o=e==s.Value.toLowerCase(),f=e==a.Value.toLowerCase();if(o!=f)return o?-1:1;let h=r==s.Key,c=r==a.Key;if(h!=c)return h?-1:1;let p=t.includes(s.Key),_=t.includes(a.Key);return p!=_?p?-1:1:s.count>a.count?-1:s.count<a.count?1:0}}async function Fs(r,e,t,s,a){let o={value:e},f=new URLSearchParams(o).toString(),c=[`${et}resources/all/searchvalues/?`+f];if(r=="Any"){let y=`${et}resources/all/names/?value=${e}`;c.push(y)}const p=c.map(y=>fetch(y,{signal:a.signal}).then(w=>w.json())),_=await Promise.all(p),v=_[0];let d,b=v.screen.data.map(y=>({...y,type:"screen",count:y["Number of screens"]})),g=v.project.data.map(y=>({...y,type:"project",count:y["Number of projects"]})),E={};g.concat(b).forEach(y=>{let w=y.Key+"="+y.Value;E[w]?(console.log("Combining",y,E[w]),E[w].count=E[w].count+y.count,E[w].type=bt):E[w]=y}),console.log("projectScreenHits",E);let C=v.image.data.map(y=>({...y,type:"image",count:y["Number of images"]})),R=[].concat(Object.values(E),C);R.sort(Ds(r,e,t)),d=R.map(y=>{let w=y.type,J=y.count;return{key:y.Key,value:`${y.Value}`,dtype:w,data_source:y.data_source,count:J}});let T=_[1],z=[];if(z=z.concat(T.project),z=z.concat(T.screen),console.log("nameHits",z),z.length>0){let y=z.reduce((k,j)=>k.add(j.data_source),new Set);console.log("data_sources",y);let w="name",J=bt;const Z={key:w,value:e,count:z.length,dtype:J,data_source:[...y].join(", "),operator:"contains"};console.log("nameOption",Z),d.unshift(Z)}d=d.filter(y=>!y.value.includes("annotation.csv"));let A={};d.forEach(y=>{let w=y.key;A[w]||(A[w]={key:w,count:0,type:y.dtype,matches:[]}),(y.dtype=="project"||y.dtype=="screen")&&(A[w].type.includes(y.dtype)||(A[w].type=bt)),A[w].count+=y.count,A[w].matches.push(y)});let O=Object.values(A);O.sort((y,w)=>y.count<w.count?1:y.count>w.count?-1:y.key>w.key?1:-1),console.log("keyCountsList",O);let U=d.length;const I=100;if(U>I?(d=d.slice(0,I),d.push({key:-1,label:`...and ${U-I} more matches not shown`,value:-1})):U==0&&(d=[{label:"No results found.",value:-1}]),r!="Any"&&A[r]){let y=A[r].count,w=A[r].type;const J={key:r,label:`<span style="color:#bbb">${r} contains</span>
          <b>${e}</b> <span style="color:#bbb">(${y}
            ${Ns[w]}${y!=1?"s":""})</span>`,value:e,dtype:w,operator:"contains"};d.unshift(J)}return d}function Sr(r,e=!1,t={}){let s=`${et}resources/submitquery/`;e&&(s+="containers/");let a={method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"},...t};return fetch(s,a).then(o=>o.json())}function Us(r,e,t,s={}){console.log("getKeyValues() query, key, containerName, opts",r,e,t,s);let a=`${et}resources/image/container_filterkeyvalues/`;a+=`?container_name=${t}&key=${e}`;let o={method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"},...s};return fetch(a,o).then(f=>f.json())}function xt(r,e,t,s="image"){let a=JSON.parse(JSON.stringify(r));return a.query_details.and_filters.push({name:e,value:t,operator:"equals",resource:s}),a}async function Er(r,e={}){return await(await fetch(r,e)).json()}function js(r,e){let t;return function(){const s=this,a=arguments,o=function(){t=null,r.apply(s,a)};clearTimeout(t),t=setTimeout(o,e)}}async function Ps(r){let e=`${Lt}webclient/api/paths_to_object/?${r.type}=${r.id}`;return(await Er(e)).paths}var Vs=Y('<li class="svelte-57jlxm"><label class="svelte-57jlxm"><button class="svelte-57jlxm"> <strong> </strong> <span style="opacity: 0.3"> </span> </button></label></li>'),Js=Y('<ul class="items svelte-57jlxm"></ul>');function Gs(r,e){Ae(e,!1);let t=B(e,"items",8),s=B(e,"handleClick",8);Oe();var a=Js();Ce(a,5,t,o=>o,(o,f)=>{var h=Vs(),c=M(h),p=M(c),_=M(p),v=P(_),d=M(v);S(v);var b=P(v),g=P(b),E=M(g);S(g);var C=P(g);S(p),S(c),S(h),ie(()=>{le(_,`${(i(f).dtype=="container"?"Container":"")??""} `),le(d,`${i(f).key??""}:`),le(b,` ${i(f).value??""} `),le(E,`(${i(f).count??""})`),le(C,` (${i(f).data_source??""})`)}),Qe("click",p,()=>s()(i(f))),D(o,h)}),S(a),D(r,a),xe()}class Zs{constructor(){this.filters=Ye([]),this.filterBeingEdited=Ye(-1)}addFilter({key:e,value:t,dtype:s,operator:a="equals",resource:o="image"}){(s==="project"||s==="screen"||s==="container")&&(o="container");let f={name:e,value:t,operator:a,resource:o,active:!0},h=this.getFilterBeingEdited();if(console.log("STORE addFilter: editedFilter",h,f),h==-1){let c=[f];this.filters.update(p=>[...p,c]),h=ke(this.filters).length-1}else this.filters.update(c=>c.map((p,_)=>_==h?[...p,f]:p));return h}getFilters(){return ke(this.filters)}getQuery(e,t=!1){let s=c=>{let{name:p,value:_,operator:v,resource:d}=c;return{name:p,value:_,operator:v,resource:d}},a=c=>!(!c.active||t&&c.resource==="container"),o=ke(this.filters).map(c=>c.filter(a).map(s)).filter(c=>c.length>0),f=o.filter(c=>c.length>1),h=o.filter(c=>c.length===1).map(c=>c[0]);return e&&h.push({name:"name",value:e,operator:"equals",resource:"container"}),{resource:"image",query_details:{and_filters:h,or_filters:f,case_sensitive:!1},mode:"searchterms"}}toggleFilter(e){this.filters.update(t=>{let s=[...t],a=s[e].some(o=>o.active);return s[e]=s[e].map(o=>(o.active=!a,o)),s})}updateFilterOperator(e,t,s){this.filters.update(a=>{let o=[...a];return o[e][t].operator=s,o})}toggleOrFilter(e,t){this.filters.update(s=>{let a=[...s],o=a[e][t].active;return a[e][t].active=!o,a})}removeOrFilter(e,t){this.filters.update(s=>{let a=[...s];return a[e]=a[e].filter((o,f)=>f!==t),a})}removeFilter(e){this.filters.update(t=>t.filter((s,a)=>a!==e))}editFilter(e){this.filterBeingEdited.set(e)}getFilterBeingEdited(){return ke(this.filterBeingEdited)}subscribeFilters(e){return this.filters.subscribe(e)}subscribeFilterBeingEdited(e){return this.filterBeingEdited.subscribe(e)}setFilters(e){this.filters.set(e)}}const se=new Zs,Ue=Ye(null);var Bs=Y("<span>or</span>"),Qs=Y('<!> <div class="or_filter svelte-1dedc0o"><div class="keyvalue svelte-1dedc0o"> <select class="svelte-1dedc0o"><option>equals</option><option>contains</option></select> </div> <div class="filter_buttons svelte-1dedc0o"><button title="Disable filter" class="svelte-1dedc0o"><!></button> <button title="Remove Filter" class="svelte-1dedc0o"><!></button></div></div>',1),Ys=Y("<h2>Edit Filters</h2> <!>",1);function Hs(r,e){Ae(e,!1);let t=ee([]),s=ee(-1);se.subscribeFilters(h=>{V(t,h)}),se.subscribeFilterBeingEdited(h=>{V(s,h)});function a(h,c){console.log("Operator change",h,c.target.value),se.updateFilterOperator(i(s),h,c.target.value)}Oe();var o=Ne(),f=fe(o);ce(f,()=>i(t)[i(s)],h=>{var c=Ys(),p=P(fe(c),2);Ce(p,1,()=>i(t)[i(s)],De,(_,v,d)=>{var b=Qs(),g=fe(b);ce(g,()=>d>0,Z=>{var k=Bs();D(Z,k)});var E=P(g,2),C=M(E),R=M(C),T=P(R);ie(()=>{i(v).operator,at(()=>{})}),T.__change=Z=>a(d,Z);var z=M(T);z.value=(z.__value="equals")==null?"":"equals";var A=P(z);A.value=(A.__value="contains")==null?"":"contains",S(T);var O=P(T);S(C);var U=P(C,2),I=M(U);I.__click=()=>se.toggleOrFilter(i(s),d);var y=M(I);Ge(y,{icon:Ar,color:"#666"}),S(I);var w=P(I,2);w.__click=()=>se.removeOrFilter(i(s),d);var J=M(w);Ge(J,{icon:Rt,color:"#666"}),S(w),S(U),S(E),ie(()=>{be(C,"active",i(v).active),le(R,`${i(v).name??""} `),le(O,` ${i(v).value??""}${(i(v).operator=="contains"?"*":"")??""}`)}),Mt(T,()=>i(v).operator,Z=>(i(v).operator=Z,at(()=>i(t)[i(s)]))),D(_,b)}),D(h,c)}),D(r,o),xe()}He(["change","click"]);function Ws(r,e){i(e).hidePopover()}var $s=Y("<option> </option>"),qs=Y("<option> </option>"),Ks=Y("<p>Loading...</p>"),Xs=Y('<div id="add-filter-dialog" popover="" class="svelte-778ojm"><button class="close svelte-778ojm" title="Close">&times;</button> <div class="popover_content svelte-778ojm"><div class="left_panel svelte-778ojm"><h2>Filter by...</h2> <div class="kvp_row svelte-778ojm"><select class="svelte-778ojm"><option>Any Key</option><optgroup label="Study"></optgroup><optgroup label="Image"></optgroup></select> <input type="text" placeholder="type to find values..." class="svelte-778ojm"></div> <!> <div class="matches svelte-778ojm"><!></div></div> <div class="right_panel svelte-778ojm"><!></div></div></div>');function ei(r,e){Ae(e,!1);let t=B(e,"filterIndex",28,()=>-1),s=ee([]),a=ee(!1),o=ee({project:[],image:[]}),f=ee("Any"),h="equals",c=ee(),p=new AbortController;We(()=>{Ts().then(k=>{V(o,k),console.log("Known keys",i(o))}),i(c).addEventListener("toggle",k=>{console.log("Popover toggled",k),k.newState=="closed"&&(t(-1),se.editFilter(-1))}),se.subscribeFilterBeingEdited(k=>{console.log("FilterPopover Editing filter",k),t(k),t()!=-1&&i(c)&&i(c).showPopover()})});let _=k=>{p.abort(),p=new AbortController;const j=k.target.value;V(a,!0),console.log("Searching for",j);let H=i(o).project.concat(i(o).image);Fs(i(f),j,H,h,p).then(Q=>{V(a,!1),console.log("Results",Q),V(s,Q)})};function v(k){console.log("FilterPopover Adding filter",k),k.operator||(k.operator=h),t(se.addFilter(k)),se.editFilter(t())}Oe();var d=Xs(),b=M(d);b.__click=[Ws,c];var g=P(b,2),E=M(g),C=P(M(E),2),R=M(C);ie(()=>{i(f),at(()=>{i(o)})});var T=M(R);T.value=(T.__value="Any")==null?"":"Any";var z=P(T);Ce(z,5,()=>i(o).project,De,(k,j)=>{var H=$s(),Q={},ne=M(H,!0);S(H),ie(()=>{Q!==(Q=i(j))&&(H.value=(H.__value=i(j))==null?"":i(j)),le(ne,i(j))}),D(k,H)}),S(z);var A=P(z);Ce(A,5,()=>i(o).image,De,(k,j)=>{var H=qs(),Q={},ne=M(H,!0);S(H),ie(()=>{Q!==(Q=i(j))&&(H.value=(H.__value=i(j))==null?"":i(j)),le(ne,i(j))}),D(k,H)}),S(A),S(R);var O=P(R,2),U=fr(()=>js(_,500));O.__keyup=function(...k){var j;(j=i(U))==null||j.apply(this,k)},S(C);var I=P(C,2);ce(I,()=>i(a),k=>{var j=Ks();D(k,j)});var y=P(I,2),w=M(y);Gs(w,{handleClick:v,get items(){return i(s)}}),S(y),S(E);var J=P(E,2),Z=M(J);Hs(Z,{}),S(J),S(g),S(d),Ot(d,k=>V(c,k),()=>i(c)),Mt(R,()=>i(f),k=>V(f,k)),D(r,d),xe()}He(["click","keyup"]);const ti="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Generator:%20Adobe%20Illustrator%2019.2.1,%20SVG%20Export%20Plug-In%20.%20SVG%20Version:%206.00%20Build%200)%20--%3e%3csvg%20version='1.1'%20id='logo_-_color_1_'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20viewBox='0%200%205137.1%20896'%20style='enable-background:new%200%200%205137.1%20896;'%20xml:space='preserve'%3e%3cstyle%20type='text/css'%3e%20.st0{fill:%23DF283F;}%20.st1{fill:%231C4A87;}%20.st2{fill:%23128669;}%20.st3{fill:%231D8DCD;}%20%3c/style%3e%3cg%3e%3cg%3e%3cpath%20class='st0'%20d='M103.4,314c-4.7-4.8-10.4-7.2-15.8-7.2c-7,0-13.8,3.8-18.2,11.2l-31.7,52.8L5.9,423.7%20c-7.9,13.2-7.9,34.8,0,48l31.7,52.8l31.7,52.8c4.4,7.4,11.2,11.2,18.2,11.2c5.5,0,11.1-2.4,15.8-7.2c0,0,65.2-66.3,67.3-130.6%20c0-1,0.1-2.1,0.1-3.1c0-1,0-2.1-0.1-3.1C168.6,380.3,103.4,314,103.4,314z'/%3e%3cpath%20class='st1'%20d='M1052.3,423.7l-31.7-52.8l-31.7-52.8c-4.4-7.4-11.2-11.2-18.2-11.2c-5.5,0-11.1,2.4-15.8,7.2%20c0,0-65.2,66.3-67.3,130.6c0,1-0.1,2.1-0.1,3.1c0,1,0,2.1,0.1,3.1c2.1,64.3,67.3,130.6,67.3,130.6c4.7,4.8,10.4,7.2,15.8,7.2%20c7,0,13.7-3.8,18.2-11.2l31.7-52.8l31.7-52.8C1060.3,458.5,1060.3,436.9,1052.3,423.7z'/%3e%3cpath%20class='st1'%20d='M685.9,447.7c0-86.6-70.2-156.8-156.8-156.8s-156.8,70.2-156.8,156.8c0,86.6,70.2,156.8,156.8,156.8%20S685.9,534.3,685.9,447.7z'/%3e%3cpath%20class='st2'%20d='M797.9,179c1.3,0,2.5-0.1,3.8-0.1c32.3-1,62.7-14.3,62.7-14.3c14.1-6.2,19.2-22,11.3-35.2L844,76.6%20l-31.7-52.7C804.4,10.7,785.3,0,769.9,0H646.7c-15.4,0-22.9,11.4-16.6,25.4C630.2,25.4,699,179,797.9,179z'/%3e%3cpath%20class='st1'%20d='M193.8,164.6c0,0,30.4,13.2,62.7,14.2c1.3,0,2.5,0.1,3.8,0.1c99,0,167.8-153.6,167.8-153.6%20C434.4,11.4,426.9,0,411.5,0H288.3c-15.4,0-34.5,10.7-42.4,23.9l-31.7,52.8l-31.7,52.8C174.6,142.6,179.7,158.5,193.8,164.6z'/%3e%3cpath%20class='st3'%20d='M864.5,730.9c0,0-30.4-13.3-62.7-14.3c-1.3,0-2.5-0.1-3.8-0.1c-99,0-167.8,153.8-167.8,153.8%20c-6.3,14.1,1.2,25.7,16.6,25.7h123.2c15.4,0,34.5-10.9,42.4-24.1L844,819l31.7-52.9C883.7,752.9,878.6,737,864.5,730.9z'/%3e%3cpath%20class='st1'%20d='M260.3,716.6c-1.3,0-2.5,0-3.8,0c-32.3,1-62.7,14.2-62.7,14.2c-14.1,6.2-19.2,22-11.3,35.2l31.7,52.8l31.7,53%20c7.9,13.2,27,24.1,42.4,24.1h123.2c15.4,0,22.9-11.6,16.6-25.7C428.1,870.3,359.3,716.6,260.3,716.6z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st0'%20d='M1912.8,203.6c-67.1-65.5-150.1-98.3-248.9-98.3S1482.1,138,1415,203.6c-67.1,65.5-100.7,147.2-100.7,245.1%20c0,97.9,33.6,179.5,100.7,245.1c67.1,65.5,150.1,98.3,248.9,98.3s181.8-32.8,248.9-98.3c67.1-65.6,100.7-147.2,100.7-245.1%20C2013.5,350.8,1979.9,269.1,1912.8,203.6z%20M1898.6,448.7c0,66.8-22.7,123.7-67.9,170.5c-45.3,46.9-100.9,70.3-166.7,70.3%20c-65.9,0-121.5-23.4-166.7-70.3c-45.3-46.9-67.9-103.7-67.9-170.5c0-66.8,22.6-123.6,67.9-170.5c45.3-46.9,100.8-70.3,166.7-70.3%20c65.9,0,121.4,23.4,166.7,70.3C1875.9,325,1898.6,381.8,1898.6,448.7z'/%3e%3cpolygon%20class='st2'%20points='2739.3,128%202538.8,545.1%202338.4,128%202163,128%202163,792%202275,792%202275,273.4%202506.5,734%202569.2,734%202801,273.4%202801,792%202913,792%202913,128%20'/%3e%3cpolygon%20class='st3'%20points='3234,687%203234,509%203552,509%203552,409%203234,409%203234,233%203588,233%203588,128%203122,128%203122,792%203600,792%203600,687%20'/%3e%3cpath%20class='st1'%20d='M4157.6,550.7c95.6-28.5,143.4-97.5,143.4-207.1c0-75.4-21.9-130.2-65.5-164.4S4119.3,128,4018,128h-248v664%20h113V569h147.3L4189,792h142.5L4157.6,550.7z%20M3883,230h142.6c60.2,0,102,7.9,125.4,24.1c23.4,16.1,35.1,45.8,35.1,89.2%20c0,43.4-11.4,74.8-34.2,94.4c-22.8,19.6-65.9,29.3-129.2,29.3H3883V230z'/%3e%3cpath%20class='st1'%20d='M5036.4,203.6c-67.1-65.5-150.1-98.3-248.9-98.3c-98.8,0-181.8,32.8-248.9,98.3%20c-67.1,65.5-100.7,147.2-100.7,245.1c0,97.9,33.6,179.5,100.7,245.1c67.1,65.5,150.1,98.3,248.9,98.3%20c98.8,0,181.8-32.8,248.9-98.3c67.1-65.6,100.7-147.2,100.7-245.1C5137.1,350.8,5103.5,269.1,5036.4,203.6z%20M5022.1,448.7%20c0,66.8-22.7,123.7-67.9,170.5c-45.3,46.9-100.9,70.3-166.7,70.3c-65.9,0-121.5-23.4-166.7-70.3c-45.3-46.9-67.9-103.7-67.9-170.5%20c0-66.8,22.6-123.6,67.9-170.5c45.3-46.9,100.8-70.3,166.7-70.3c65.9,0,121.4,23.4,166.7,70.3%20C4999.5,325,5022.1,381.8,5022.1,448.7z'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",ri="data:image/svg+xml,%3csvg%20width='98'%20height='96'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M48.854%200C21.839%200%200%2022%200%2049.217c0%2021.756%2013.993%2040.172%2033.405%2046.69%202.427.49%203.316-1.059%203.316-2.362%200-1.141-.08-5.052-.08-9.127-13.59%202.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015%204.934.326%207.523%205.052%207.523%205.052%204.367%207.496%2011.404%205.378%2014.235%204.074.404-3.178%201.699-5.378%203.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283%200-5.378%201.94-9.778%205.014-13.2-.485-1.222-2.184-6.275.486-13.038%200%200%204.125-1.304%2013.426%205.052a46.97%2046.97%200%200%201%2012.214-1.63c4.125%200%208.33.571%2012.213%201.63%209.302-6.356%2013.427-5.052%2013.427-5.052%202.67%206.763.97%2011.816.485%2013.038%203.155%203.422%205.015%207.822%205.015%2013.2%200%2018.905-11.404%2023.06-22.324%2024.283%201.78%201.548%203.316%204.481%203.316%209.126%200%206.6-.08%2011.897-.08%2013.526%200%201.304.89%202.853%203.316%202.364%2019.412-6.52%2033.405-24.935%2033.405-46.691C97.707%2022%2075.788%200%2048.854%200z'%20fill='%23fff'/%3e%3c/svg%3e";var si=Y('<base> <nav class="svelte-oz19hz"><img alt="OMERO Logo" class="svelte-oz19hz"> <h2 class="svelte-oz19hz">search engine client</h2> <div style="flex: 1"></div> <a class="github svelte-oz19hz" title="Open in GitHub" target="_blank" href="https://github.com/ome/omero_search_engine_client/"><img alt="GitHub Logo" class="svelte-oz19hz"></a></nav>',1);function ii(r,e){Ae(e,!1);let t="./";console.log("Nav base",t),Oe();var s=si(),a=fe(s);X(a,"href",t);var o=P(a,2),f=M(o);X(f,"src",ti);var h=P(f,6),c=M(h);X(c,"src",ri),S(h),S(o),D(r,s),xe()}class ni{constructor(){this.containers=Ye([]),this.controller=new AbortController}async loadContainers(e){this.controller.abort(),this.controller=new AbortController;let s=await Sr(e,!0,{signal:this.controller.signal});console.log("containerStore Search result",s),s.results.results.sort((f,h)=>{var c;return((c=f.name)==null?void 0:c.localeCompare(h.name))||-1});let a=s.results.results;this.containers.set(a);let o=ke(we);if(o&&!o.name){let f=a.find(h=>h.id==o.id&&h.type==o.type);f&&we.set({...f,ignoreRightPanel:!0})}}subscribe(e){return this.containers.subscribe(e)}}const tr=new ni,we=Ye(null),ai="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAANCAYAAACgu+4kAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA5NpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpDNDk5ODU0N0U5MjA2ODExODhDNkJBNzRDM0U2QkE2NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNjZDNDcxNzc5NEUxMUUxOTY2OEJEQjhGOUExQ0Y3RCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNjZDNDcxNjc5NEUxMUUxOTY2OEJEQjhGOUExQ0Y3RCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2ICgxMy4wIDIwMTIwMzA1Lm0uNDE1IDIwMTIvMDMvMDU6MjE6MDA6MDApICAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkM1NzAxRDEzMjkyMTY4MTE4OEM2QkE3NEMzRTZCQTY3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkM0OTk4NTQ3RTkyMDY4MTE4OEM2QkE3NEMzRTZCQTY3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+vd9MhwAAALhJREFUeNpi/P//P0NEXsd/BhxgxaQKRgY8gAXGMNbVwpA8e/kaAyHAGJhWe5iNnctGVkoaQ/Lxs6cMv35+w6f/CMvfP39svDytscrqaijgtX3t5u02IAMYXrx5z0AOAOll+fPnF8Ov37/IMgCkl+XP799Af5JpAFAv0IBfDD9//STTAKALfgMJcl0A0gvxwi8KvPAXFIhkGvAXHIjAqPjx4zuZsQCMxn9//my9eOaEFQN54ChAgAEAzRBnWnEZWFQAAAAASUVORK5CYII=",oi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAANCAYAAABPeYUaAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA5NpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpDNDk5ODU0N0U5MjA2ODExODhDNkJBNzRDM0U2QkE2NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5NkU0QUUzNjc4NEExMUUxOTY2OEJEQjhGOUExQ0Y3RCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5NkU0QUUzNTc4NEExMUUxOTY2OEJEQjhGOUExQ0Y3RCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2ICgxMy4wIDIwMTIwMzA1Lm0uNDE1IDIwMTIvMDMvMDU6MjE6MDA6MDApICAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkM1NzAxRDEzMjkyMTY4MTE4OEM2QkE3NEMzRTZCQTY3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkM0OTk4NTQ3RTkyMDY4MTE4OEM2QkE3NEMzRTZCQTY3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+wkwZRwAAAQxJREFUeNpi/P//PwMjIyODqbHhfwYc4PTZ84y45ED6WZAFPFxdwQYig+27djEQAowgk6wtLcGu4GBnY0C38vvPX3gNOHr8OCPcJaHh4QwsLCwYiv78+YNV87+/fxnWrlkDZsN1PXr0iGHPnj1wRS4uLnj5jg4OcDYTjPH7928w3WxmhcJ3zmtC4Zc2mUH4SC6EG/LrF8TvtaeOofD3TqpD4XfXnULho3gHJOjt7Q2XePHiBV7+s6dPsRuydetWuISuri5evra2Nm7vVKUZoPDTratR+EZV1RjewTCkbdYFFP7Mo60o/HNtrSgBjeEdMzMzuMRToJ/x8Z88eYJpyKcPH8AYGRDiwwBAgAEAvXKdXsBF6t8AAAAASUVORK5CYII=";var li=Y('<div class="spinner svelte-z1yris"></div> <p>Loading containers...</p>',1),ci=(r,e,t)=>e(i(t)),ui=Y('<li class="svelte-z1yris"><div class="container_icon svelte-z1yris"><img alt="Container icon" class="svelte-z1yris"></div> <button class="container_text svelte-z1yris"> <span class="children_count svelte-z1yris"> </span></button></li>'),di=Y('<div class="scrollable svelte-z1yris"><!> <ul class="svelte-z1yris"></ul></div>');function fi(r,e){Ae(e,!1);let t=ee([]),s=ee(null);tr.subscribe(c=>{V(t,c)}),se.subscribeFilters(c=>{let p=se.getQuery();console.log("SEARCHING....",p),tr.loadContainers(p)}),we.subscribe(c=>{V(s,c)});function a(c){console.log("Clicked",c),we.set(c)}Oe();var o=di(),f=M(o);ce(f,()=>i(t).length==0,c=>{var p=li();rs(2),D(c,p)});var h=P(f,2);Ce(h,5,()=>i(t),De,(c,p)=>{var _=ui(),v=M(_),d=M(v);S(v);var b=P(v,2);b.__click=[ci,a,p];var g=M(b),E=P(g),C=M(E,!0);S(E),S(b),S(_),ie(()=>{var R,T;be(_,"selected",i(p).id==((R=i(s))==null?void 0:R.id)&&i(p).type==((T=i(s))==null?void 0:T.type)),X(d,"src",i(p).type=="screen"?oi:ai),le(g,`${i(p).name??""} `),le(C,i(p)["image count"])}),D(c,_)}),S(h),S(o),D(r,o),xe()}He(["click"]);var vi=Y('<a class="viewer_link svelte-nc2d5b" target="_blank">Full Viewer</a>'),pi=Y('<a class="kvp_link svelte-nc2d5b" title="Filter by this key-value pair"> </a>'),hi=Y('<tr class="tablerow svelte-nc2d5b"><td class="svelte-nc2d5b"> </td><td class="svelte-nc2d5b"><!></td></tr>'),gi=Y('<div class="scrollable svelte-nc2d5b"><div class="annotations svelte-nc2d5b"><div class="map_ann svelte-nc2d5b"><table class="svelte-nc2d5b"><tbody></tbody></table></div></div></div>'),mi=Y('<div class="details svelte-nc2d5b"><h3> </h3> <h4> <!></h4></div> <!>',1);function yi(r,e){Ae(e,!1);let t=ee(null);Ue.subscribe(f=>{let h={...f,type:"image"};V(t,h)}),we.subscribe(f=>{f!=null&&f.ignoreRightPanel||V(t,f)});function s(f){return f.slice(0,1).toUpperCase()+f.slice(1)}Oe();var a=Ne(),o=fe(a);ce(o,()=>i(t),f=>{var h=mi(),c=fe(h),p=M(c),_=M(p,!0);S(p);var v=P(p,2),d=M(v);ie(()=>le(d,`${s(i(t).type)??""} ID: ${i(t).id??""} `));var b=P(d);ce(b,()=>i(t).type=="image",E=>{var C=vi();ie(()=>X(C,"href",`${Lt}webclient/img_detail/${i(t).id??""}`)),D(E,C)}),S(v),S(c);var g=P(c,2);ce(g,()=>i(t).key_values,E=>{var C=gi(),R=M(C),T=M(R),z=M(T),A=M(z);Ce(A,5,()=>i(t).key_values,De,(O,U)=>{var I=hi();const y=Ie(()=>i(U).key||i(U).name),w=Ie(()=>i(U).value);var J=M(I),Z=M(J,!0);S(J);var k=P(J),j=M(k);ce(j,()=>i(t).type=="image",H=>{var Q=pi(),ne=M(Q,!0);S(Q),ie(()=>{X(Q,"href",`${window.location.origin+window.location.pathname}?key=${i(y)??""}&value=${i(w)??""}&operator=equals&show=image-${i(t).id??""}`),le(ne,i(w))}),Qe("click",Q,wr(()=>se.addFilter({key:i(y),value:i(w),dtype:"image",operator:"equals"}))),D(H,Q)},H=>{var Q=sr();ie(()=>le(Q,i(w))),D(H,Q)}),S(k),S(I),ie(()=>le(Z,i(y))),D(O,I)}),S(A),S(z),S(T),S(R),S(C),D(E,C)}),ie(()=>le(_,i(t).name)),D(f,h)}),D(r,a),xe()}class _i{constructor(){this.groups=Ye([])}addGroup(e){this.groups.update(t=>[...t,e])}removeGroup(e){this.groups.update(t=>(t.splice(e,1),t))}subscribeGroups(e){return this.groups.subscribe(e)}setGroups(e){this.groups.set(e)}}const Je=new _i,bi="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2016%2016'%3e%3cpath%20fill='none'%20stroke='white'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='2'%20d='m2%205%206%206%206-6'/%3e%3c/svg%3e";function wi(r,e){let t=r.target.value;Je.addGroup(t),V(e,"-")}var Ai=Y("<option> </option>"),xi=Y(`<!> <button title="Remove 'Group by'" class="svelte-14kigfq"> <span class="delete svelte-14kigfq"><!></span></button>`,1),Si=Y('<select class="svelte-14kigfq"><option>Group by...</option><!></select> <div class="groups_list svelte-14kigfq"></div>',1);function Ei(r,e){Ae(e,!1);let t=B(e,"keys",24,()=>[]),s=ee("-"),a=ee([]);Je.subscribeGroups(_=>{console.log("CentrePanelGroups.svelte -> groups",_),V(a,_)}),we.subscribe(_=>{Je.setGroups([])}),se.subscribeFilters(_=>{Je.setGroups([])}),Oe();var o=Si(),f=fe(o);ie(()=>{i(s),at(()=>{t(),i(a)})}),f.__change=[wi,s],X(f,"style",`--form-select-bg-img: url('${bi}')`);var h=M(f);h.value=(h.__value="-")==null?"":"-";var c=P(h);Ce(c,1,t,De,(_,v)=>{var d=Ai(),b={};ie(()=>d.disabled=i(a).includes(i(v)));var g=M(d,!0);S(d),ie(()=>{b!==(b=i(v))&&(d.value=(d.__value=i(v))==null?"":i(v)),le(g,i(v))}),D(_,d)}),S(f);var p=P(f,2);Ce(p,5,()=>i(a),De,(_,v,d)=>{var b=xi(),g=fe(b);ce(g,()=>d>0,z=>{var A=sr(">");D(z,A)});var E=P(g,2);E.__click=()=>Je.removeGroup(d);var C=M(E),R=P(C),T=M(R);Ge(T,{icon:Rt,color:"#666"}),S(R),S(E),ie(()=>le(C,`${i(v)??""} `)),D(_,b)}),S(p),Mt(f,()=>i(s),_=>V(s,_)),D(r,o),xe()}He(["change","click"]);const Ii=r=>r;function Ir(r,{delay:e=0,duration:t=400,easing:s=Ii}={}){const a=+getComputedStyle(r).opacity;return{delay:e,duration:t,easing:s,css:o=>`opacity: ${o*a}`}}const st={AUTO:"auto",START:"start",CENTER:"center",END:"end"},ze={HORIZONTAL:"horizontal",VERTICAL:"vertical"},Ke={OBSERVED:0,REQUESTED:1},Ci={[ze.VERTICAL]:"top",[ze.HORIZONTAL]:"left"},rr={[ze.VERTICAL]:"scrollTop",[ze.HORIZONTAL]:"scrollLeft"};class Oi{constructor({itemSize:e,itemCount:t,estimatedItemSize:s}){this.itemSize=e,this.itemCount=t,this.estimatedItemSize=s,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig({itemSize:e,itemCount:t,estimatedItemSize:s}){t!=null&&(this.itemCount=t),s!=null&&(this.estimatedItemSize=s),e!=null&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!=null?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.itemCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:t}=this;return typeof t=="function"?t(e):Array.isArray(t)?t[e]:t}computeTotalSizeAndPositionData(){let e=0;for(let t=0;t<this.itemCount;t++){const s=this.getSize(t),a=e;e+=s,this.itemSizeAndPositionData[t]={offset:a,size:s}}this.totalSize=e}getLastMeasuredIndex(){return this.lastMeasuredIndex}getSizeAndPositionForIndex(e){if(e<0||e>=this.itemCount)throw Error(`Requested index ${e} is outside of range 0..${this.itemCount}`);return this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const t=this.getSizeAndPositionOfLastMeasuredItem();let s=t.offset+t.size;for(let a=this.lastMeasuredIndex+1;a<=e;a++){const o=this.getSize(a);if(o==null||isNaN(o))throw Error(`Invalid size returned for index ${a} of value ${o}`);this.itemSizeAndPositionData[a]={offset:s,size:o},s+=o}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.itemCount-this.lastMeasuredIndex-1)*this.estimatedItemSize}getUpdatedOffsetForIndex({align:e=st.START,containerSize:t,currentOffset:s,targetIndex:a}){if(t<=0)return 0;const o=this.getSizeAndPositionForIndex(a),f=o.offset,h=f-t+o.size;let c;switch(e){case st.END:c=h;break;case st.CENTER:c=f-(t-o.size)/2;break;case st.START:c=f;break;default:c=Math.max(h,Math.min(f,s))}const p=this.getTotalSize();return Math.max(0,Math.min(p-t,c))}getVisibleRange({containerSize:e=0,offset:t,overscanCount:s}){if(this.getTotalSize()===0)return{};const o=t+e;let f=this.findNearestItem(t);if(f===void 0)throw Error(`Invalid offset ${t} specified`);const h=this.getSizeAndPositionForIndex(f);t=h.offset+h.size;let c=f;for(;t<o&&c<this.itemCount-1;)c++,t+=this.getSizeAndPositionForIndex(c).size;return s&&(f=Math.max(0,f-s),c=Math.min(c+s,this.itemCount-1)),{start:f,stop:c}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const t=this.getSizeAndPositionOfLastMeasuredItem(),s=Math.max(0,this.lastMeasuredIndex);return t.offset>=e?this.binarySearch({high:s,low:0,offset:e}):this.exponentialSearch({index:s,offset:e})}binarySearch({low:e,high:t,offset:s}){let a=0,o=0;for(;e<=t;){if(a=e+Math.floor((t-e)/2),o=this.getSizeAndPositionForIndex(a).offset,o===s)return a;o<s?e=a+1:o>s&&(t=a-1)}return e>0?e-1:0}exponentialSearch({index:e,offset:t}){let s=1;for(;e<this.itemCount&&this.getSizeAndPositionForIndex(e).offset<t;)e+=s,s*=2;return this.binarySearch({high:Math.min(e,this.itemCount-1),low:Math.floor(e/2),offset:t})}}const Mi=(()=>{let r=!1;try{const e=Object.defineProperty({},"passive",{get(){return r={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return r})();var Ri=Y('<div class="virtual-list-wrapper svelte-dwpad5"><!> <div class="virtual-list-inner svelte-dwpad5"></div> <!></div>');function Li(r,e){Ae(e,!1);let t=B(e,"height",12),s=B(e,"width",12,"100%"),a=B(e,"itemCount",12),o=B(e,"itemSize",12),f=B(e,"estimatedItemSize",12,null),h=B(e,"stickyIndices",12,null),c=B(e,"getKey",12,null),p=B(e,"scrollDirection",28,()=>ze.VERTICAL),_=B(e,"scrollOffset",12,null),v=B(e,"scrollToIndex",12,null),d=B(e,"scrollToAlignment",12,null),b=B(e,"scrollToBehaviour",12,"instant"),g=B(e,"overscanCount",12,3);const E=as(),C=new Oi({itemCount:a(),itemSize:o(),estimatedItemSize:ae()});let R=ee(!1),T=ee(),z=ee([]),A=ee({offset:_()||v()!=null&&i(z).length&&Q(v())||0,scrollChangeReason:Ke.REQUESTED}),O=i(A),U={scrollToIndex:v(),scrollToAlignment:d(),scrollOffset:_(),itemCount:a(),itemSize:o(),estimatedItemSize:f()},I={},y=ee(""),w=ee("");k(),We(()=>{V(R,!0),i(T).addEventListener("scroll",ne,Mi),_()!=null?j(_()):v()!=null&&j(Q(v()))}),os(()=>{i(R)&&i(T).removeEventListener("scroll",ne)});function J(){if(!i(R))return;const L=U.scrollToIndex!==v()||U.scrollToAlignment!==d(),re=U.itemCount!==a()||U.itemSize!==o()||U.estimatedItemSize!==f();re&&(C.updateConfig({itemSize:o(),itemCount:a(),estimatedItemSize:ae()}),H()),U.scrollOffset!==_()?V(A,{offset:_()||0,scrollChangeReason:Ke.REQUESTED}):typeof v()=="number"&&(L||re)&&V(A,{offset:Q(v(),d(),a()),scrollChangeReason:Ke.REQUESTED}),U={scrollToIndex:v(),scrollToAlignment:d(),scrollOffset:_(),itemCount:a(),itemSize:o(),estimatedItemSize:f()}}function Z(){if(!i(R))return;const{offset:L,scrollChangeReason:re}=i(A);(O.offset!==L||O.scrollChangeReason!==re)&&k(),O.offset!==L&&re===Ke.REQUESTED&&j(L),O=i(A)}function k(){const{offset:L}=i(A),{start:re,stop:ue}=C.getVisibleRange({containerSize:p()===ze.VERTICAL?t():s(),offset:L,overscanCount:g()});let de=[];const he=C.getTotalSize();if(p()===ze.VERTICAL){const pe=typeof t()=="number"?"px":"";V(y,`height:${t()}${pe};width:${s()};`),V(w,`flex-direction:column;height:${he}px;`)}else{const pe=typeof s()=="number"?"px":"";V(y,`height:${t()};width:${s()}${pe}`),V(w,`min-height:100%;width:${he}px;`)}const Ve=h()!=null&&h().length!==0;if(Ve)for(let pe=0;pe<h().length;(pe+=1)-1){const Me=h()[pe];de.push({index:Me,style:G(Me,!0)})}if(re!==void 0&&ue!==void 0){for(let pe=re;pe<=ue;(pe+=1)-1)Ve&&h().includes(pe)||de.push({index:pe,style:G(pe,!1)});E("itemsUpdated",{start:re,end:ue})}V(z,de)}function j(L){"scroll"in i(T)?i(T).scroll({[Ci[p()]]:L,behavior:b()}):ss(T,i(T)[rr[p()]]=L)}function H(L=0){I={},C.resetItem(L),k()}function Q(L,re=d(),ue=a()){return(L<0||L>=ue)&&(L=0),C.getUpdatedOffsetForIndex({align:re,containerSize:p()===ze.VERTICAL?t():s(),currentOffset:i(A).offset||0,targetIndex:L})}function ne(L){const re=_e();re<0||i(A).offset===re||L.target!==i(T)||(V(A,{offset:re,scrollChangeReason:Ke.OBSERVED}),E("afterScroll",{offset:re,event:L}))}function _e(){return i(T)[rr[p()]]}function ae(){return f()||typeof o()=="number"&&o()||50}function G(L,re){if(I[L])return I[L];const{size:ue,offset:de}=C.getSizeAndPositionForIndex(L);let he;return p()===ze.VERTICAL?(he=`left:0;width:100%;height:${ue}px;`,re?he+=`position:sticky;flex-grow:0;z-index:1;top:0;margin-top:${de}px;margin-bottom:${-(de+ue)}px;`:he+=`position:absolute;top:${de}px;`):(he=`top:0;width:${ue}px;`,re?he+=`position:sticky;z-index:1;left:0;margin-left:${de}px;margin-right:${-(de+ue)}px;`:he+=`position:absolute;height:100%;left:${de}px;`),I[L]=he}Te(()=>(ye(v()),ye(d()),ye(_()),ye(a()),ye(o()),ye(f())),()=>{v(),d(),_(),a(),o(),f(),J()}),Te(()=>i(A),()=>{i(A),Z()}),Te(()=>(ye(t()),ye(s()),ye(h()),i(R)),()=>{t(),s(),h(),i(R)&&H(0)}),dt(),Oe();var oe=Ri(),me=M(oe);_t(me,e,"header",{});var te=P(me,2);Ce(te,5,()=>i(z),L=>c()?c()(L.index):L.index,(L,re)=>{var ue=Ne(),de=fe(ue);_t(de,e,"item",{get style(){return i(re).style},get index(){return i(re).index}}),D(L,ue)}),S(te);var ve=P(te,2);return _t(ve,e,"footer",{}),S(oe),Ot(oe,L=>V(T,L),()=>i(T)),ie(()=>{X(oe,"style",i(y)),X(te,"style",i(w))}),D(r,oe),bs(e,"recomputeSizes",H),xe({recomputeSizes:H,get height(){return t()},set height(L){t(L),Se()},get width(){return s()},set width(L){s(L),Se()},get itemCount(){return a()},set itemCount(L){a(L),Se()},get itemSize(){return o()},set itemSize(L){o(L),Se()},get estimatedItemSize(){return f()},set estimatedItemSize(L){f(L),Se()},get stickyIndices(){return h()},set stickyIndices(L){h(L),Se()},get getKey(){return c()},set getKey(L){c(L),Se()},get scrollDirection(){return p()},set scrollDirection(L){p(L),Se()},get scrollOffset(){return _()},set scrollOffset(L){_(L),Se()},get scrollToIndex(){return v()},set scrollToIndex(L){v(L),Se()},get scrollToAlignment(){return d()},set scrollToAlignment(L){d(L),Se()},get scrollToBehaviour(){return b()},set scrollToBehaviour(L){b(L),Se()},get overscanCount(){return g()},set overscanCount(L){g(L),Se()}})}var zi=Y('<a target="_blank"><div class="studyThumb svelte-uad075"><img class="svelte-uad075"></div></a>'),ki=Y('<!> <span class="imgIndex svelte-uad075"> </span>',1);function Ni(r,e){Ae(e,!1);let t=B(e,"images",24,()=>[]),s=B(e,"index",8,0),a=B(e,"handleRendered",8),o=ee(null);We(()=>{a()(s())}),Ue.subscribe(d=>{V(o,d)});function f(d){Ue.set(d)}function h(d){window.open(d,"_blank").focus()}Oe();var c=ki(),p=fe(c);Ce(p,1,t,d=>d.id,(d,b)=>{var g=zi();const E=Ie(()=>{var z,A,O;return((O=(A=(z=i(b))==null?void 0:z.key_values)==null?void 0:A.find(U=>U.name=="thumb_url"))==null?void 0:O.value)||`${er}webclient/render_thumbnail/${i(b).id}/`}),C=Ie(()=>{var z,A,O;return((O=(A=(z=i(b))==null?void 0:z.key_values)==null?void 0:A.find(U=>U.name=="image_url"))==null?void 0:O.value)||`${er}webclient/img_detail/${i(b).id}/`});var R=M(g),T=M(R);S(R),S(g),ie(()=>{var z;X(g,"aria-label",`Image: ${i(b).name??""}`),X(g,"href",i(C)),be(R,"selected",((z=i(o))==null?void 0:z.id)==i(b).id),X(T,"src",i(E)),X(T,"alt",i(b).name)}),Qe("click",g,wr(()=>f(i(b)))),Qe("dblclick",g,()=>h(i(C))),D(d,g)});var _=P(p,2),v=M(_,!0);S(_),ie(()=>le(v,s())),D(r,c),xe()}var Ti=Y("<div>Loading images...</div>"),Di=Y("<div>No Images found</div>"),Fi=Y('<div class="row svelte-s0g6r0" slot="item"><!></div>'),Ui=Y('<!> <div class="wrapper svelte-s0g6r0"><!></div>',1);function Cr(r,e){Ae(e,!1);const t=ee();let s=B(e,"parentQuery",8,void 0),a=B(e,"setPrototypeImage",8,void 0);const o=64;let f=ee(0),h=ee(0),c=ee([]),p=null,_,v=ee(!1);se.subscribeFilters(O=>{console.log("Images.svelte::: queryStore newFilters - parentQuery:",s()),d()}),we.subscribe(O=>{console.log("Images.svelte::: selectedContainerStore newFilters - parentQuery:",s()),d()});async function d(O=!0){var Z;let U=ke(we);if(!(U!=null&&U.name)){V(c,[]),p=null;return}let I={};s()==null?(console.log("loadImages... parentQuery is undefined"),I=se.getQuery()):I=JSON.parse(JSON.stringify(s()));let y=xt(I,"name",U.name,"container");if(!O&&p){if(p.current_page>=p.total_pages)return;y.pagination=p}_&&_.abort(),console.log("loadImages... query",y,O),V(v,!0),_=new AbortController;let w=await Sr(y,!1,{signal:_.signal});p=w.results.pagination,V(v,!1);let J=((Z=w.results)==null?void 0:Z.results)||[];J.length==0&&console.log("NO IMAGES FOUND!",y),O?(V(c,J),a()&&a()(i(c)[0])):V(c,[...i(c),...J]),console.log("imagesJson",i(c))}function b(){V(t,Math.floor(i(h)/(o+15)))}We(()=>{b()});function g(O){O>=i(c).length&&(console.log("LOAD MORE IMAGES?",p.current_page,p.total_pages),p.current_page<p.total_pages&&(console.log("LOAD MORE IMAGES!"),d(!1)))}Te(()=>{},()=>{V(t,7)}),dt(),Oe();var E=Ui();Qe("resize",vr,b);var C=fe(E);ce(C,()=>i(v),O=>{var U=Ti();mr(1,U,()=>Ir,()=>({delay:1e3,duration:1e3})),D(O,U)},O=>{var U=Ne(),I=fe(U);ce(I,()=>i(c).length==0,y=>{var w=Di();D(y,w)},null,!0),D(O,U)});var R=P(C,2);X(R,"style",`--thumbSize: ${o}px`);var T=M(R),z=Ie(()=>i(f)-5),A=Ie(()=>Math.ceil(i(c).length/i(t)));Li(T,{width:"100%",get height(){return i(z)},get itemCount(){return i(A)},itemSize:o+10,$$slots:{item:(O,U)=>{var I=Fi();const y=Ie(()=>U.index),w=Ie(()=>U.style);var J=M(I),Z=Ie(()=>Math.min(i(c).length,(i(y)+1)*i(t))),k=Ie(()=>i(c).slice(i(y)*i(t),(i(y)+1)*i(t)));Ni(J,{handleRendered:g,get index(){return i(Z)},get images(){return i(k)}}),S(I),ie(()=>X(I,"style",i(w))),D(O,I)}}}),S(R),At(R,"clientHeight",O=>V(f,O)),At(R,"clientWidth",O=>V(h,O)),D(r,E),xe()}var ji=Y("<div>Loading values...</div>"),Pi=Y("<div>No values found for query</div>"),Vi=Y('<div class="child_groups svelte-fokmmd"><!></div>'),Ji=Y('<div style="height: 200px; display: flex; flex-direction: column"><!></div>'),Gi=Y('<div><button class="svelte-fokmmd"><div class="icon svelte-fokmmd"><!></div> </button> <!></div>'),Zi=Y('<div class="groups"><!> <!></div>');function Or(r,e){Ae(e,!1);let t=ee([]),s=B(e,"groupsIndex",8,0),a=B(e,"parentQuery",8),o=ee(!1),f=ee(20);Je.subscribeGroups(d=>{console.log("Groups.svelte -> groups",d),V(t,d)});let h=ee([]);We(()=>{V(o,!0);let d=i(t)[s()],b=ke(we).name;console.log("<Groups> onMount() parentQuery, key, containerName",a(),d,b),Us(a(),d,b).then(g=>{V(o,!1),console.log("getKeyValues()",g);let E=g[0].results;E.sort((C,R)=>C.value<R.value?-1:C.value>R.value?1:0),V(h,E)})});function c(d){V(h,i(h).map((b,g)=>(g==d&&(b.expanded=!b.expanded),b)))}Oe();var p=Zi(),_=M(p);ce(_,()=>i(o),d=>{var b=ji();mr(1,b,()=>Ir,()=>({delay:1e3,duration:1e3})),D(d,b)},d=>{var b=Ne(),g=fe(b);ce(g,()=>i(h).length==0,E=>{var C=Pi();D(E,C)},null,!0),D(d,b)});var v=P(_,2);Ce(v,3,()=>i(h),d=>d.value,(d,b,g)=>{var E=Gi(),C=M(E);C.__click=()=>c(i(g));var R=M(C),T=M(R);Ge(T,{icon:Ms,color:"#666"}),S(R);var z=P(R);S(C);var A=P(C,2);ce(A,()=>i(b).expanded,O=>{var U=Ne(),I=fe(U);ce(I,()=>s()<i(t).length-1,y=>{var w=Ne(),J=fe(w);pr(J,()=>i(t)[s()+1],Z=>{var k=Vi(),j=M(k),H=Ie(()=>s()+1),Q=Ie(()=>xt(a(),i(t)[s()],i(b).value));Or(j,{get groupsIndex(){return i(H)},get parentQuery(){return i(Q)}}),S(k),D(Z,k)}),D(y,w)},y=>{var w=Ji(),J=M(w),Z=Ie(()=>xt(a(),i(t)[s()],i(b).value));Cr(J,{get parentQuery(){return i(Z)}}),S(w),D(y,w)}),D(O,U)}),S(E),ie(()=>{X(C,"style",`--sticky-top: ${i(f)*s()}px; z-index: ${100-s()};`),be(C,"expanded",i(b).expanded),le(z,` ${i(b).value??""} (${i(b).no_image??""})`)}),At(C,"clientHeight",O=>V(f,O)),D(d,E)}),S(p),D(r,p),xe()}He(["click"]);var Bi=Y('<div class="wrapper svelte-1jyv88t"><!></div>'),Qi=Y('<div class="header svelte-1jyv88t"><!></div> <!>',1);function Yi(r,e){Ae(e,!1);const t=ee(),s=ee(),a=64;let o=ee([]);function f(v){v?V(s,v.key_values.map(d=>d.name)):V(s,[])}se.subscribeFilters(()=>{V(t,se.getQuery(null,!0))}),Je.subscribeGroups(v=>{V(o,v)}),Te(()=>se,()=>{V(t,se.getQuery())}),Te(()=>{},()=>{V(s,[])}),dt(),Oe();var h=Qi(),c=fe(h),p=M(c);Ei(p,{get keys(){return i(s)}}),S(c);var _=P(c,2);ce(_,()=>i(o).length>0,v=>{var d=Ne(),b=fe(d);pr(b,()=>i(o)[0],g=>{var E=Bi();X(E,"style",`--thumbSize: ${a}px`);var C=M(E);Or(C,{get parentQuery(){return i(t)},get key(){return i(o)[0]}}),S(E),D(g,E)}),D(v,d)},v=>{Cr(v,{setPrototypeImage:f})}),D(r,h),xe()}var Hi=Y('<strong class="svelte-rntvy5"> </strong>'),Wi=Y("<span>or</span>"),$i=Y('<strong class="svelte-rntvy5"> </strong>'),qi=Y('<!> <button class="or_filter svelte-rntvy5"><!> </button>',1),Ki=Y('<div class="and_filter svelte-rntvy5"><div class="filter_content svelte-rntvy5"><!> <!></div> <div class="filter_buttons svelte-rntvy5"><button title="Edit Filters" class="svelte-rntvy5"><!></button> <button title="Disable filter" class="svelte-rntvy5"><!></button> <button title="Remove Filter" class="svelte-rntvy5"><!></button></div></div>'),Xi=Y('<!> <!> <div class="main svelte-rntvy5"><div class="sidebar svelte-rntvy5"><div class="filter_panel"><h3 class="svelte-rntvy5">Studies <button class="addBtn svelte-rntvy5" popovertarget="add-filter-dialog">Filter by...</button></h3> <!></div> <div class="container_panel svelte-rntvy5"><!></div></div> <div class="content svelte-rntvy5"><!></div> <div class="sidebar svelte-rntvy5"><!></div></div>',1);function ln(r,e){Ae(e,!0);let t=Qt(rt([])),s=Qt(rt(se.getFilterBeingEdited())),a=!1;function o(){if(a)return;let I=se.getFilters(),y=window.location.pathname,w=[];if(I.length>0){let k=Xt.stringify(I,{AQF:!0});w.push(`query=${k}`)}let J=ke(we),Z=ke(Ue);Z&&w.push(`show=image-${Z.id}`),J&&w.push(`show=${J.type}-${J.id}`),w.length>0&&(y+="?"+w.join("&")),history.pushState({query:I,image:Z,container:J},"",y)}function f(I){console.log("popstate state",I.state),a=!0,se.setFilters(I.state.query),we.set(I.state.container),Ue.set(I.state.image),setTimeout(()=>{a=!1},100)}We(()=>{console.log("onMount ---->"),se.subscribeFilters(I=>{console.log("newFilters",I),V(t,rt(I)),o()}),se.subscribeFilterBeingEdited(I=>{V(s,rt(I))}),we.subscribe(I=>{console.log("Selected Container",I),o()}),Ue.subscribe(I=>{console.log("Selected Image",I),o()})});const h=window.location.search.slice(1),c=new URLSearchParams(h);let p=c.get("query");if(console.log("URLSearchParams query:",p),p){let I=Xt.parse(encodeURIComponent(p),{AQF:!0});console.log("URLSearchParams filterJson...",I),(I==null?void 0:I.length)>0&&se.setFilters(I)}else{let I=c.get("key"),y=c.get("value"),w=c.get("operator")||"equals";console.log("URLSearchParams key:",I,"value:",y,"operator:",w),I&&y&&se.addFilter({key:I,value:y,dtype:"image",operator:w})}if(c.has("show")){let I=c.getAll("show");console.log("URLSearchParams show...",I);let y,w;I.forEach(J=>{let[Z,k]=J.split("-");Z=="image"?y={type:Z,id:k}:w={type:Z,id:k}}),y&&!w?Ps(y).then(J=>{var k;console.log("Hierarchy paths",J);let Z=(k=J[0])==null?void 0:k.find(j=>j.type=="project"||j.type=="screen");Z&&(we.set(Z),Ue.set(y))}):w&&(console.log("Setting selectedContainer -->",w),we.set(w),y&&(console.log("Setting selectedImage -->",y),setTimeout(()=>Ue.set(y),100)))}var _=Xi();Qe("popstate",vr,f);var v=fe(_);ii(v,{});var d=P(v,2);ei(d,{});var b=P(d,2),g=M(b),E=M(g),C=P(M(E),2);Ce(C,17,()=>i(t),De,(I,y,w)=>{var J=Ki();const Z=fr(()=>Array.from(new Set(i(y).map(te=>te.name))));var k=M(J),j=M(k);ce(j,()=>i(Z).length==1,te=>{var ve=Hi(),L=M(ve);S(ve),ie(()=>le(L,`${i(Z)[0]??""}:`)),D(te,ve)});var H=P(j,2);Ce(H,17,()=>i(y),De,(te,ve,L)=>{var re=qi(),ue=fe(re);ce(ue,()=>L>0,pe=>{var Me=Wi();D(pe,Me)});var de=P(ue,2);de.__click=()=>se.toggleOrFilter(w,L);var he=M(de);ce(he,()=>i(Z).length>1,pe=>{var Me=$i(),ft=M(Me);S(Me),ie(()=>le(ft,`${i(ve).name??""}:`)),D(pe,Me)});var Ve=P(he);S(de),ie(()=>{X(de,"title",`${i(ve).name??""} ${i(ve).operator??""} ${i(ve).value??""}`),be(de,"active",i(ve).active),le(Ve,` ${i(ve).value??""}${(i(ve).operator=="contains"?"*":"")??""}`)}),D(te,re)}),S(k);var Q=P(k,2),ne=M(Q);ne.__click=()=>se.editFilter(w);var _e=M(ne);Ge(_e,{icon:Rs,color:"#666"}),S(ne);var ae=P(ne,2);ae.__click=()=>se.toggleFilter(w);var G=M(ae);Ge(G,{icon:Ar,color:"#666"}),S(ae);var oe=P(ae,2);oe.__click=()=>se.removeFilter(w);var me=M(oe);Ge(me,{icon:Rt,color:"#666"}),S(oe),S(Q),S(J),ie(()=>be(J,"edited",i(s)==w)),D(I,J)}),S(E);var R=P(E,2),T=M(R);fi(T,{}),S(R),S(g);var z=P(g,2),A=M(z);Yi(A,{}),S(z);var O=P(z,2),U=M(O);yi(U,{}),S(O),S(b),D(r,_),xe()}He(["click"]);export{ln as component};
