var zr=Object.defineProperty;var Ft=r=>{throw TypeError(r)};var Nr=(r,e,t)=>e in r?zr(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Ut=(r,e,t)=>Nr(r,typeof e!="symbol"?e+"":e,t),pt=(r,e,t)=>e.has(r)||Ft("Cannot "+t);var Re=(r,e,t)=>(pt(r,e,"read from private field"),t?t.call(r):e.get(r)),$e=(r,e,t)=>e.has(r)?Ft("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),ht=(r,e,t,s)=>(pt(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t),jt=(r,e,t)=>(pt(r,e,"access private method"),t);import{c as ke,a as T,n as ct,t as Q,d as nr}from"../chunks/disclose-version.BBU7oq9N.js";import{v as Ee,N as St,m as ar,s as kr,a7 as or,o as Et,w as Ze,a3 as Dr,U as Tr,ar as lr,M as gt,C as Fr,S as cr,a8 as Ur,a9 as Pt,L as mt,as as it,a6 as ur,y as dr,F as nt,at as Ct,au as Vt,av as It,aw as jr,V as Pr,a0 as Jt,ax as Vr,R as Jr,ay as Gr,q as Zr,H as Br,O as Yr,D as fr,az as Qr,J as Hr,aA as Wr,a5 as Gt,aB as $r,E as Kr,aC as qr,aD as Xr,aa as ut,b as vr,aE as es,n as Ke,aF as ts,z as Zt,A as Bt,x as rs,a2 as ss,p as Ae,aG as De,aH as dt,h as fe,j as M,k as S,t as ie,l as j,g as i,W as V,i as xe,aI as ee,e as ye,aJ as at,f as pr,aK as is,al as Ce,aL as ns,ao as Se,aM as hr,aq as Yt}from"../chunks/runtime.C1_B45BB.js";import{d as as,a as le,e as Ye,f as He}from"../chunks/store.B1gyNW-u.js";import{c as os,p as B,i as ce,b as Ot,o as We,d as ls,e as cs,a as rt}from"../chunks/index-client.DXncgjFY.js";import{i as Oe}from"../chunks/lifecycle.D3C2k4G7.js";import{w as Qe,g as Ne}from"../chunks/index.DjD2UYa4.js";function gr(r,e,t){Ee&&St();var s=r,a=Dr,o;ar(()=>{kr(a,a=e())&&(o&&or(o),o=Et(()=>t(s)))}),Ee&&(s=Ze)}let yt=null;function Te(r,e){return e}function us(r,e,t,s){for(var a=[],o=e.length,f=0;f<o;f++)Vr(e[f].e,a,!0);var p=o>0&&a.length===0&&t!==null;if(p){var c=t.parentNode;Jr(c),c.append(t),s.clear(),Fe(r,e[0].prev,e[o-1].next)}Gr(a,()=>{for(var h=0;h<o;h++){var y=e[h];p||(s.delete(y.k),Fe(r,y.prev,y.next)),Zr(y.e,!p)}})}function Ie(r,e,t,s,a,o=null){var f=r,p={flags:e,items:new Map,first:null},c=(e&lr)!==0;if(c){var h=r;f=Ee?gt(Br(h)):h.appendChild(Tr())}Ee&&St();var y=null,v=!1;ar(()=>{var u=t(),b=Fr(u)?u:u==null?[]:cr(u),m=b.length;if(v&&m===0)return;v=m===0;let E=!1;if(Ee){var I=f.data===Ur;I!==(m===0)&&(f=Pt(),gt(f),mt(!1),E=!0)}if(Ee){for(var L=null,D,N=0;N<m;N++){if(Ze.nodeType===8&&Ze.data===Yr){f=Ze,E=!0,mt(!1);break}var A=b[N],O=s(A,N);D=mr(Ze,p,L,null,A,O,N,a,e),p.items.set(O,D),L=D}m>0&&gt(Pt())}if(!Ee){var U=fr;ds(b,p,f,a,e,(U.f&it)!==0,s)}o!==null&&(m===0?y?ur(y):y=Et(()=>o(f)):y!==null&&or(y,()=>{y=null})),E&&mt(!0),t()}),Ee&&(f=Ze)}function ds(r,e,t,s,a,o,f){var H,Y,ne,_e;var p=(a&Qr)!==0,c=(a&(Ct|It))!==0,h=r.length,y=e.items,v=e.first,u=v,b,m=null,E,I=[],L=[],D,N,A,O;if(p)for(O=0;O<h;O+=1)D=r[O],N=f(D,O),A=y.get(N),A!==void 0&&((H=A.a)==null||H.measure(),(E??(E=new Set)).add(A));for(O=0;O<h;O+=1){if(D=r[O],N=f(D,O),A=y.get(N),A===void 0){var U=u?u.e.nodes_start:t;m=mr(U,e,m,m===null?e.first:m.next,D,N,O,s,a),y.set(N,m),I=[],L=[],u=m.next;continue}if(c&&fs(A,D,O,a),A.e.f&it&&(ur(A.e),p&&((Y=A.a)==null||Y.unfix(),(E??(E=new Set)).delete(A))),A!==u){if(b!==void 0&&b.has(A)){if(I.length<L.length){var C=L[0],_;m=C.prev;var w=I[0],J=I[I.length-1];for(_=0;_<I.length;_+=1)Qt(I[_],C,t);for(_=0;_<L.length;_+=1)b.delete(L[_]);Fe(e,w.prev,J.next),Fe(e,m,w),Fe(e,J,C),u=C,m=J,O-=1,I=[],L=[]}else b.delete(A),Qt(A,u,t),Fe(e,A.prev,A.next),Fe(e,A,m===null?e.first:m.next),Fe(e,m,A),m=A;continue}for(I=[],L=[];u!==null&&u.k!==N;)(o||!(u.e.f&it))&&(b??(b=new Set)).add(u),L.push(u),u=u.next;if(u===null)continue;A=u}I.push(A),m=A,u=A.next}if(u!==null||b!==void 0){for(var Z=b===void 0?[]:cr(b);u!==null;)(o||!(u.e.f&it))&&Z.push(u),u=u.next;var k=Z.length;if(k>0){var P=a&lr&&h===0?t:null;if(p){for(O=0;O<k;O+=1)(ne=Z[O].a)==null||ne.measure();for(O=0;O<k;O+=1)(_e=Z[O].a)==null||_e.fix()}us(e,Z,P,y)}}p&&dr(()=>{var ae;if(E!==void 0)for(A of E)(ae=A.a)==null||ae.apply()}),nt.first=e.first&&e.first.e,nt.last=m&&m.e}function fs(r,e,t,s){s&Ct&&Vt(r.v,e),s&It?Vt(r.i,t):r.i=t}function mr(r,e,t,s,a,o,f,p,c){var h=yt;try{var y=(c&Ct)!==0,v=(c&jr)===0,u=y?v?Pr(a):Jt(a):a,b=c&It?Jt(f):f,m={i:b,v:u,k:o,a:null,e:null,prev:t,next:s};return yt=m,m.e=Et(()=>p(r,u,b),Ee),m.e.prev=t&&t.e,m.e.next=s&&s.e,t===null?e.first=m:(t.next=m,t.e.next=m.e),s!==null&&(s.prev=m,s.e.prev=m.e),m}finally{yt=h}}function Qt(r,e,t){for(var s=r.next?r.next.e.nodes_start:t,a=e?e.e.nodes_start:t,o=r.e.nodes_start;o!==s;){var f=Hr(o);a.before(o),o=f}}function Fe(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function _t(r,e,t,s,a){var p;Ee&&St();var o=(p=e.$$slots)==null?void 0:p[t],f=!1;o===!0&&(o=e[t==="default"?"children":t],f=!0),o===void 0||o(r,f?()=>s:s)}let Ht=!1;function vs(){Ht||(Ht=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var e;if(!r.defaultPrevented)for(const t of r.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function X(r,e,t,s){var a=r.__attributes??(r.__attributes={});Ee&&(a[e]=r.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&r.nodeName==="LINK")||a[e]!==(a[e]=t)&&(e==="style"&&"__styles"in r&&(r.__styles={}),e==="loading"&&(r[Wr]=t),t==null?r.removeAttribute(e):typeof t!="string"&&ps(r).includes(e)?r[e]=t:r.setAttribute(e,t))}var Wt=new Map;function ps(r){var e=Wt.get(r.nodeName);if(e)return e;Wt.set(r.nodeName,e=[]);for(var t,s=Gt(r),a=Element.prototype;a!==s;){t=$r(s);for(var o in t)t[o].set&&e.push(o);s=Gt(s)}return e}function hs(r,e){var t=r.__className,s=gs(e);Ee&&r.getAttribute("class")===s?r.__className=s:(t!==s||Ee&&r.getAttribute("class")!==s)&&(s===""?r.removeAttribute("class"):r.setAttribute("class",s),r.__className=s)}function gs(r){return r??""}function be(r,e,t){if(t){if(r.classList.contains(e))return;r.classList.add(e)}else{if(!r.classList.contains(e))return;r.classList.remove(e)}}const ms=()=>performance.now(),Pe={tick:r=>requestAnimationFrame(r),now:()=>ms(),tasks:new Set};function yr(r){Pe.tasks.forEach(e=>{e.c(r)||(Pe.tasks.delete(e),e.f())}),Pe.tasks.size!==0&&Pe.tick(yr)}function ys(r){let e;return Pe.tasks.size===0&&Pe.tick(yr),{promise:new Promise(t=>{Pe.tasks.add(e={c:r,f:t})}),abort(){Pe.tasks.delete(e)}}}function $t(r,e){r.dispatchEvent(new CustomEvent(e))}function _s(r){if(r==="float")return"cssFloat";if(r==="offset")return"cssOffset";if(r.startsWith("--"))return r;const e=r.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function Kt(r){const e={},t=r.split(";");for(const s of t){const[a,o]=s.split(":");if(!a||o===void 0)break;const f=_s(a.trim());e[f]=o.trim()}return e}const bs=r=>r;function _r(r,e,t,s){var a=(r&ts)!==0,o="in",f,p=e.inert,c,h;function y(){var E=fr,I=nt;Zt(null),Bt(null);try{return f??(f=t()(e,(s==null?void 0:s())??{},{direction:o}))}finally{Zt(E),Bt(I)}}var v={is_global:a,in(){e.inert=p,c==null||c.abort(),$t(e,"introstart"),c=br(e,y(),h,1,()=>{$t(e,"introend"),c==null||c.abort(),c=f=void 0})},out(E){{E==null||E(),f=void 0;return}},stop:()=>{c==null||c.abort()}},u=nt;if((u.transitions??(u.transitions=[])).push(v),as){var b=a;if(!b){for(var m=u.parent;m&&m.f&Kr;)for(;(m=m.parent)&&!(m.f&qr););b=!m||(m.f&Xr)!==0}b&&ut(()=>{vr(()=>v.in())})}}function br(r,e,t,s,a){if(es(e)){var o,f=!1;return dr(()=>{if(!f){var E=e({direction:"in"});o=br(r,E,t,s,a)}}),{abort:()=>{f=!0,o==null||o.abort()},deactivate:()=>o.deactivate(),reset:()=>o.reset(),t:()=>o.t()}}if(!(e!=null&&e.duration))return a(),{abort:Ke,deactivate:Ke,reset:Ke,t:()=>s};const{delay:p=0,css:c,tick:h,easing:y=bs}=e;var v=[];if(h&&h(0,1),c){var u=Kt(c(0,1));v.push(u,u)}var b=()=>1-s,m=r.animate(v,{duration:p});return m.onfinish=()=>{var E=1-s,I=s-E,L=e.duration*Math.abs(I),D=[];if(L>0){if(c)for(var N=Math.ceil(L/16.666666666666668),A=0;A<=N;A+=1){var O=E+I*y(A/N),U=c(O,1-O);D.push(Kt(U))}b=()=>{var C=m.currentTime;return E+I*y(C/L)},h&&ys(()=>{if(m.playState!=="running")return!1;var C=b();return h(C,1-C),!0})}m=r.animate(D,{duration:L,fill:"forwards"}),m.onfinish=()=>{b=()=>s,h==null||h(s,1-s),a()}},{abort:()=>{m&&(m.cancel(),m.effect=null,m.onfinish=Ke)},deactivate:()=>{a=Ke},reset:()=>{},t:()=>b()}}function ws(r,e,t,s=t){r.addEventListener(e,t);const a=r.__on_r;a?r.__on_r=()=>{a(),s()}:r.__on_r=s,vs()}function As(r,e,t){var s=ss(r,e);s&&s.set&&(r[e]=t,rs(()=>{r[e]=null}))}function wr(r,e,t){if(r.multiple)return Ss(r,e);for(var s of r.options){var a=Xe(s);if(os(a,e)){s.selected=!0;return}}(!t||e!==void 0)&&(r.selectedIndex=-1)}function xs(r,e){ut(()=>{var t=new MutationObserver(()=>{var s=r.__value;wr(r,s)});return t.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function Mt(r,e,t=e){var s=!0;ws(r,"change",()=>{var a;if(r.multiple)a=[].map.call(r.querySelectorAll(":checked"),Xe);else{var o=r.querySelector(":checked");a=o&&Xe(o)}t(a)}),ut(()=>{var a=e();if(wr(r,a,s),s&&a===void 0){var o=r.querySelector(":checked");o!==null&&(a=Xe(o),t(a))}r.__value=a,s=!1}),xs(r)}function Ss(r,e){for(var t of r.options)t.selected=~e.indexOf(Xe(t))}function Xe(r){return"__value"in r?r.__value:r.value}var je,Be,tt,ot,Ar;const lt=class lt{constructor(e){$e(this,ot);$e(this,je,new WeakMap);$e(this,Be);$e(this,tt);ht(this,tt,e)}observe(e,t){var s=Re(this,je).get(e)||new Set;return s.add(t),Re(this,je).set(e,s),jt(this,ot,Ar).call(this).observe(e,Re(this,tt)),()=>{var a=Re(this,je).get(e);a.delete(t),a.size===0&&(Re(this,je).delete(e),Re(this,Be).unobserve(e))}}};je=new WeakMap,Be=new WeakMap,tt=new WeakMap,ot=new WeakSet,Ar=function(){return Re(this,Be)??ht(this,Be,new ResizeObserver(e=>{for(var t of e){lt.entries.set(t.target,t);for(var s of Re(this,je).get(t.target)||[])s(t)}}))},Ut(lt,"entries",new WeakMap);let bt=lt;var Es=new bt({box:"border-box"});function wt(r,e,t){var s=Es.observe(r,()=>t(r[e]));ut(()=>(vr(()=>t(r[e])),s))}function xr(r){return function(...e){var t=e[0];return t.preventDefault(),r==null?void 0:r.apply(this,e)}}function qt(r,e){e&&e!=="lg"&&e!=="sm"&&e!=="xs"?r.style.fontSize=e.replace("x","em"):r.style.fontSize=""}function Cs(r,e,t,s,a,o=1,f="",p=""){let c=1,h=1;a&&(a=="horizontal"?c=-1:a=="vertical"?h=-1:c=h=-1),typeof r=="string"&&(r=parseFloat(r)),typeof e=="string"&&(e=parseFloat(e)),typeof t=="string"&&(t=parseFloat(t));const y=`${e*o}${f}`,v=`${t*o}${f}`;let u=`translate(${y},${v}) scale(${c*r},${h*r})`;return s&&(u+=` rotate(${s}${p})`),u}var Is=ct('<title class="svelte-bvo74f"> </title>'),Os=ct('<path class="svelte-bvo74f"></path>'),Ms=ct('<path class="svelte-bvo74f"></path><path class="svelte-bvo74f"></path>',1),Ls=ct('<svg aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg"><!><g class="svelte-bvo74f"><g class="svelte-bvo74f"><!></g></g></svg>');function Ge(r,e){Ae(e,!1);const t=ee(),s=ee();let a=B(e,"class",24,()=>{}),o=B(e,"id",24,()=>{}),f=B(e,"style",24,()=>{}),p=B(e,"icon",8),c=B(e,"title",24,()=>{}),h=B(e,"size",24,()=>{}),y=B(e,"color",24,()=>{}),v=B(e,"fw",8,!1),u=B(e,"pull",24,()=>{}),b=B(e,"scale",8,1),m=B(e,"translateX",8,0),E=B(e,"translateY",8,0),I=B(e,"rotate",24,()=>{}),L=B(e,"flip",24,()=>{}),D=B(e,"spin",8,!1),N=B(e,"pulse",8,!1),A=B(e,"primaryColor",8,""),O=B(e,"secondaryColor",8,""),U=B(e,"primaryOpacity",8,1),C=B(e,"secondaryOpacity",8,.4),_=B(e,"swapOpacity",8,!1),w=ee();De(()=>(i(w),ye(h()),qt),()=>{i(w)&&h()&&qt(i(w),h())}),De(()=>ye(p()),()=>{V(t,p()&&p().icon||[0,0,"",[],""])}),De(()=>(ye(b()),ye(m()),ye(E()),ye(I()),ye(L())),()=>{V(s,Cs(b(),m(),E(),I(),L(),512))}),dt(),Oe();var J=ke(),Z=fe(J);ce(Z,()=>i(t)[4],k=>{var P=Ls(),H=M(P);ce(H,c,ae=>{var G=Is(),oe=M(G,!0);S(G),ie(()=>le(oe,c())),T(ae,G)});var Y=j(H),ne=M(Y),_e=M(ne);ce(_e,()=>typeof i(t)[4]=="string",ae=>{var G=Os();ie(()=>{X(G,"d",i(t)[4]),X(G,"fill",y()||A()||"currentColor"),X(G,"transform",`translate(${i(t)[0]/-2} ${i(t)[1]/-2})`)}),T(ae,G)},ae=>{var G=Ms(),oe=fe(G),me=j(oe);ie(()=>{X(oe,"d",i(t)[4][0]),X(oe,"fill",O()||y()||"currentColor"),X(oe,"fill-opacity",_()!=!1?U():C()),X(oe,"transform",`translate(${i(t)[0]/-2} ${i(t)[1]/-2})`),X(me,"d",i(t)[4][1]),X(me,"fill",A()||y()||"currentColor"),X(me,"fill-opacity",_()!=!1?C():U()),X(me,"transform",`translate(${i(t)[0]/-2} ${i(t)[1]/-2})`)}),T(ae,G)}),S(ne),S(Y),S(P),Ot(P,ae=>V(w,ae),()=>i(w)),ie(()=>{X(P,"id",o()),hs(P,`svelte-fa svelte-fa-base ${a()??""} svelte-bvo74f`),X(P,"style",f()),X(P,"viewBox",`0 0 ${i(t)[0]??""} ${i(t)[1]??""}`),be(P,"pulse",N()),be(P,"svelte-fa-size-lg",h()==="lg"),be(P,"svelte-fa-size-sm",h()==="sm"),be(P,"svelte-fa-size-xs",h()==="xs"),be(P,"svelte-fa-fw",v()),be(P,"svelte-fa-pull-left",u()==="left"),be(P,"svelte-fa-pull-right",u()==="right"),be(P,"spin",D()),X(Y,"transform",`translate(${i(t)[0]/2} ${i(t)[1]/2})`),X(Y,"transform-origin",`${i(t)[0]/4} 0`),X(ne,"transform",i(s))}),T(k,P)}),T(r,J),xe()}const Rs={prefix:"fas",iconName:"caret-right",icon:[256,512,[],"f0da","M246.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-9.2-9.2-22.9-11.9-34.9-6.9s-19.8 16.6-19.8 29.6l0 256c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l128-128z"]},Sr={prefix:"fas",iconName:"ban",icon:[512,512,[128683,"cancel"],"f05e","M367.2 412.5L99.5 144.8C77.1 176.1 64 214.5 64 256c0 106 86 192 192 192c41.5 0 79.9-13.1 111.2-35.5zm45.3-45.3C434.9 335.9 448 297.5 448 256c0-106-86-192-192-192c-41.5 0-79.9 13.1-111.2 35.5L412.5 367.2zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256z"]},zs={prefix:"fas",iconName:"pen",icon:[512,512,[128394],"f304","M362.7 19.3L314.3 67.7 444.3 197.7l48.4-48.4c25-25 25-65.5 0-90.5L453.3 19.3c-25-25-65.5-25-90.5 0zm-71 71L58.6 323.5c-10.4 10.4-18 23.3-22.2 37.4L1 481.2C-1.5 489.7 .8 498.8 7 505s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L421.7 220.3 291.7 90.3z"]},Lt={prefix:"fas",iconName:"trash",icon:[448,512,[],"f1f8","M135.2 17.7L128 32 32 32C14.3 32 0 46.3 0 64S14.3 96 32 96l384 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-96 0-7.2-14.3C307.4 6.8 296.3 0 284.2 0L163.8 0c-12.1 0-23.2 6.8-28.6 17.7zM416 128L32 128 53.2 467c1.6 25.3 22.6 45 47.9 45l245.8 0c25.3 0 46.3-19.7 47.9-45L416 128z"]};var Ns=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ks(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Er={exports:{}};/*!
 * jsonurl.js v1.1.8
 * (c) 2024 David MacCormack
 * Released under the MIT License.
 */(function(r,e){(function(t,s){r.exports=s()})(Ns,function(){const t="JSON->URL: expected literal value",s="JSON->URL: unexpected character",a="JSON->URL: unexpected end of text inside composite",o="JSON->URL: unexpected text after composite",f="JSON->URL: can not represent null with implied strings",p="JSON->URL: the empty string is not allowed",c="JSON->URL: invalid escape sequence",h="JSON->URL: invalid percent-encoded sequence",y="JSON->URL: expected object value";function v(g,n){return n===void 0?g:g+" at position "+n}const u=16,b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,6,6,48,10,20,20,6,6,20,6,6,6,6,6,6,6,6,6,6,6,6,6,20,6,0,48,0,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,0,0,0,0,6,0,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,0,0,0,6,0];function m(g){return g>127?0:b[g]}class E{constructor(n){this.setOrDefault(n,"allowEmptyUnquotedValues"),this.setOrDefault(n,"allowEmptyUnquotedKeys"),this.setOrDefault(n,"AQF"),this.setOrDefault(n,"coerceNullToEmptyString"),this.setOrDefault(n,"ignoreNullArrayMembers"),this.setOrDefault(n,"ignoreNullObjectMembers"),this.setOrDefault(n,"impliedArray"),this.setOrDefault(n,"impliedObject"),this.setOrDefault(n,"impliedStringLiterals"),this.setOrDefault(n,"noEmptyComposite"),this.setOrDefault(n,"wwwFormUrlEncoded")}setOrDefault(n,d,l){n!==void 0&&d in n?d in this||(this[d]=n[d]):l===void 0||d in this||(this[d]=l)}setOverride(n,d){n!==void 0&&d in n&&(this[d]=n[d])}setOrDefaultInt(n,d,l){this.setOrDefault(n,d,l===void 0?l:parseInt(l))}isPresentAndTrue(n){return n in this&&this[n]}}class I extends E{constructor(n,d){super(n),this.setOrDefault(n,"emptyValue"),this.setOrDefault(d,"emptyValue",{}),this.setOverride(n,"getMissingValue"),this.setOrDefaultInt(n,"maxParseChars"),this.setOrDefaultInt(d,"maxParseChars",32768),this.setOrDefaultInt(n,"maxParseDepth"),this.setOrDefaultInt(d,"maxParseDepth",32),this.setOrDefaultInt(n,"maxParseValues"),this.setOrDefaultInt(d,"maxParseValues",4096),this.setOrDefault(n,"nullValue"),this.setOrDefault(d,"nullValue",null)}getMissingValue(n,d){throw new SyntaxError(v(y,d))}}class L extends E{constructor(n){super(n);const d=!(n===void 0||!("impliedStringLiterals"in n)||!n.impliedStringLiterals)||void 0;this.setOrDefault(n,"allowEmptyUnquotedValues",d),this.setOrDefault(n,"allowEmptyUnquotedKeys",d),this.setOrDefault(n,"callFunctions"),this.setOrDefault(n,"isImplied"),this.setOrDefault(n,"ignoreNullArrayMembers",d),this.setOrDefault(n,"ignoreNullObjectMembers",d),this.setOrDefault(n,"ignoreUndefinedArrayMembers",d),this.setOrDefault(n,"ignoreUndefinedObjectMembers",d),this.isImplied=this.isImplied||this.impliedArray||this.impliedObject}}const D=/\+/g,N=/ /g,A=/(![\s\S]?)/g,O=/^[-A-Za-z0-9._~!$*;@?/ ][-A-Za-z0-9._~!$*;@?/' ]*$/,U=/^[-A-Za-z0-9._~!$*,;@?/(): ]+$/,C=/^-?\d+(?:\.\d+)?(?:[eE][-]?\d+)?$/,_=/^-?\d+(?:\.\d+)?[eE]\+\d+$/,w=/^-?\d+(?:\.\d+)?[eE] \d+$/,J=/[(),:]|%2[04]|%3B/gi,Z={"%20":"+","%24":"$","(":"%28",")":"%29",",":"%2C",":":"%3A","%3B":";"},k=/[!(),:]|%2[01489BC]|%3[AB]/gi,P={"%20":"+","%21":"!!","!":"!!","%24":"$","%28":"!(","(":"!(","%29":"!)",")":"!)","+":"!+","%2B":"!+","%2C":"!,",",":"!,","%3A":"!:",":":"!:","%3B":";"},H=40,Y=41,ne=44,_e=58,ae=38,G=48,oe=65,me=97,te=new Array(111);te[33]="!",te[40]="(",te[41]=")",te[43]="+",te[44]=",",te[45]=",",te[G]="0",te[G+1]="1",te[G+2]="2",te[G+3]="3",te[G+4]="4",te[G+5]="5",te[G+6]="6",te[G+7]="7",te[G+8]="8",te[G+9]="9",te[58]=":",te[116]="t",te[102]="f",te[110]="n";const ve="",R="!e",re=" ";function ue(g,n){const d=n?k:J,l=n?P:Z;return encodeURIComponent(g).replace(d,function(x){const $=l[x];return $===void 0?x:$})}function de(g,n){switch(n){case G:return 0;case G+1:return 1;case G+2:return 2;case G+3:return 3;case G+4:return 4;case G+5:return 5;case G+6:return 6;case G+7:return 7;case G+8:return 8;case G+9:return 9;case oe:case me:return 10;case oe+1:case me+1:return 11;case oe+2:case me+2:return 12;case oe+3:case me+3:return 13;case oe+4:case me+4:return 14;case oe+5:case me+5:return 15;default:throw new SyntaxError(v(h,g))}}function he(g){if(g.coerceNullToEmptyString)return Ve(g,!1);if(g.impliedStringLiterals)throw new SyntaxError(f);return"null"}function Ve(g,n){if(n?g.allowEmptyUnquotedKeys:g.allowEmptyUnquotedValues)return ve;if(g.AQF)return R;if(g.impliedStringLiterals)throw new SyntaxError(p);return"''"}(function(g){let{toJsonURLText_Array:n,toJsonURLText_Boolean:d,toJsonURLText_Number:l,toJsonURLText_Object:x,toJsonURLText_String:$}=g;Object.defineProperty(Array.prototype,"toJsonURLText",{value:n}),Object.defineProperty(Boolean.prototype,"toJsonURLText",{value:d}),Object.defineProperty(Number.prototype,"toJsonURLText",{value:l}),Object.defineProperty(Object.prototype,"toJsonURLText",{value:x}),Object.defineProperty(String.prototype,"toJsonURLText",{value:$})})({toJsonURLText_Array:function(){let g,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return this.forEach(function(l){if(typeof l=="function"){if(!n.callFunctions)return;for(;typeof l=="function";)l=l()}if(l===void 0){if(n.ignoreUndefinedArrayMembers)return;l=he(n)}else if(l===null){if(n.ignoreNullArrayMembers)return;l=he(n)}else l=l.toJsonURLText(n,d+1);g===void 0?g=l:!n.wwwFormUrlEncoded||d>0?g+=","+l:g+="&"+l}),!n.isImplied||d>0?g===void 0?"()":"("+g+")":g===void 0?ve:g},toJsonURLText_Boolean:function(){return this===!0?"true":"false"},toJsonURLText_Number:function(g){const n=String(this);return g.impliedStringLiterals&&n.indexOf("+")!==-1?ue(n,g):n},toJsonURLText_Object:function(){let g,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const l=Object.keys(this),x=this;return l.forEach(function($){if($==null)return;let W=x[$];if(typeof W=="function"){if(!n.callFunctions)return;for(;typeof W=="function";)W=W()}if(W===void 0){if(n.ignoreUndefinedObjectMembers)return;W=he(n)}else if(W===null){if(n.ignoreNullObjectMembers)return;W=he(n)}else W=W.toJsonURLText(n,d+1);const q=$.toJsonURLText(n,d,!0);g===void 0?g=!n.wwwFormUrlEncoded||d>0?q+":"+W:q+"="+W:!n.wwwFormUrlEncoded||d>0?g+=","+q+":"+W:g+="&"+q+"="+W}),!n.isImplied||d>0?(n.noEmptyComposite&&g===void 0&&(g=":"),g===void 0?"()":"("+g+")"):g===void 0?ve:g},toJsonURLText_String:function(g,n,d){if(this.length===0)return Ve(g,d);if(g.impliedStringLiterals)return ue(this,g.AQF);if((l=this)==="true"||l==="false"||l==="null"||C.test(l))return d===!0?this:g.AQF?"!"+this:"'"+this+"'";var l;if(_.test(this))return g.AQF?this.replace("+","!+"):this.replace("+","%2B");if(w.test(this))return g.AQF?"!"+this.replace(re,"+"):"'"+this.replace(re,"+")+"'";if(g.AQF)return ue(this,!0);if(O.test(this))return this.indexOf(re)==-1?this:this.replace(N,"+");if(U.test(this))return this.indexOf(re)==-1?"'"+this+"'":"'"+this.replace(N,"+")+"'";let x=ue(this);return x.charCodeAt(0)==39?"%27"+x.substring(1):x}});class pe{constructor(n,d,l,x){this.text=n,this.pos=this.markPos=d,this.end=l,this.options=x}skipAmps(){let n=arguments.length>0&&arguments[0]!==void 0&&arguments[0];const d=this.text,l=this.end;let x=this.pos;if(n)for(;x<l&&d.charCodeAt(x)===ae;)x++;else if(x<l&&d.charCodeAt(x)===ae){for(x++;x<l&&d.charCodeAt(x)===ae;x++);x!==l&&x--}this.pos=x}structChar(){let n=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.options.wwwFormUrlEncoded){const x=this.text.charCodeAt(this.pos);switch(x){case ae:case 61:return n?void 0:(this.pos++,x)}}const d=this.pos,l=this.ordinal();switch(l){case ne:case _e:if(n)return void(this.pos=d);case H:case Y:return l;default:return void(this.pos=d)}}ordinal(n){return n!==void 0?this.text.charCodeAt(n):this.text.charCodeAt(this.pos++)}accept(n){const d=this.pos;return this.ordinal()===n||(this.pos=d,!1)}acceptPlus(){return this.text.charCodeAt(this.pos)==43&&(this.pos++,!0)}done(){return this.end<=this.pos}validateLiteral(n,d){const l=this.text,x=this.end;for(;n<x;n++)switch(m(l.charCodeAt(n))&d){case 0:throw new SyntaxError(v(s,n));case u:return n;case 8:return n+1;default:continue}}findLiteralEnd(){const n=this.text,d=this.end;let l=this.pos;const x=n.charCodeAt(l)===39;x&&l++;const $=x?28:18;if(l=this.validateLiteral(l,$),l!==void 0)return l;if(x)throw new SyntaxError(v("JSON->URL: quoted string still open",l));return d}isEmptyObject(){if(this.options.noEmptyComposite){const n=this.pos;if(!this.accept(_e))return!1;const d=this.pos,l=this.accept(Y);return this.pos=l?d:n,l}return!1}parseLiteral(n){const d=this.pos,l=this.options,x=this.findLiteralEnd();if(n===void 0&&(n=this.ordinal(x)==_e),x<=d)return function(q,F){if(F)return ve;throw new SyntaxError(v(p,q))}(d,n?this.options.allowEmptyUnquotedKeys:this.options.allowEmptyUnquotedValues);if(l.impliedStringLiterals===!0)return this.parseStringLiteral(x,!0);const $=this.parseTrueFalseNull(x,n);if($!==void 0)return $;const W=this.parseNumberLiteral(x,n);return W!==void 0?W:this.parseStringLiteral(x,!1)}parseDigits(n){let d,l=!1;for(;this.pos<n;)switch(this.ordinal()){case G:case G+1:case G+2:case G+3:case G+4:case G+5:case G+6:case G+7:case G+8:case G+9:d=this.pos,l=!0;continue;default:return this.pos=d,l}return this.pos=d,l}parseExponentValue(n){return!(n<=this.pos)&&(this.acceptPlus()||this.accept(45),this.parseDigits(n))}parseExponent(n){const d=this.pos;switch(this.ordinal()){case 69:case 101:if(this.parseExponentValue(n))return!0}return this.pos=d,!1}parseFraction(n){const d=this.pos;return!(n<=d)&&(!(!this.accept(46)||!this.parseDigits(n))||(this.pos=d,!1))}parseInteger(n){return!(n<=this.pos)&&(!!this.accept(G)||this.parseDigits(n))}parseNumberLiteral(n,d){const l=this.text,x=this.pos;if(this.accept(45),this.parseInteger(n)&&(this.parseFraction(n),this.parseExponent(n),this.pos===n)){const $=decodeURIComponent(l.substring(x,n));return d?$:Number($)}this.pos=x}parseStringLiteral(n,d){const l=this.text,x=this.pos;let $=d||l.charCodeAt(x)!==39?l.substring(x,n):l.substring(x+1,n-1);return $=decodeURIComponent($.replace(D,re)),this.pos=n,$}parseTrueFalseNull(n,d){const l=this.text,x=this.pos;let $,W,q,F,K;switch(n-x){case 4:if($=l.charCodeAt(x),W=l.charCodeAt(x+1),q=l.charCodeAt(x+2),F=l.charCodeAt(x+3),$===116&&W===114&&q===117&&F===101)return this.pos=n,!d||"true";if($===110&&W===117&&q===108&&F===108)return this.pos=n,d?"null":this.newNullValue();break;case 5:if($=l.charCodeAt(x),W=l.charCodeAt(x+1),q=l.charCodeAt(x+2),F=l.charCodeAt(x+3),K=l.charCodeAt(x+4),$===102&&W===me&&q===108&&F===115&&K===101)return this.pos=n,!!d&&"false"}}newEmptyValue(){const n=this.options;if(n.noEmptyComposite)return[];const d=n.emptyValue;return typeof d=="function"?d():d}newNullValue(){const n=this.options;let d=n.nullValue;return typeof d=="function"&&(d=d()),d==null&&n.coerceNullToEmptyString&&(d=ve),d}}class Me extends pe{constructor(n,d,l,x){super(n,d,l,x)}ordinal(n){const d=n||this.pos,l=this.text.charCodeAt(d);let x,$;return l===37?(x=function(W,q,F){if(F<=q+1)throw new SyntaxError(v(h,q));return de(q,W.charCodeAt(q))<<4|de(q,W.charCodeAt(q+1))}(this.text,d+1,this.end),$=3):(x=l,$=1),n===void 0&&(this.pos+=$),x}findLiteralEnd(){const n=this.end,d=this.pos,l=this.text;let x=d;for(;;){if(n<=this.pos)return this.pos=d,n;switch(50&m(l.charCodeAt(this.pos))){case 48:if(this.options.wwwFormUrlEncoded)return x=this.pos,this.pos=d,x;case 0:throw new SyntaxError(v(s,x))}switch(this.ordinal()){case H:case Y:case _e:case ne:return this.pos=d,x;case 33:if(this.pos===n)throw new SyntaxError(v(c,x));this.ordinal(),x=this.pos;break;default:x=this.pos}}}parseStringLiteral(n){const d=this.text,l=this.pos,x=decodeURIComponent(d.substring(l,n).replace(D,function($,W){return W!==0&&function(q,F){return q.charCodeAt(F-1)===33||F>2&&q.charCodeAt(F-3)===37&&q.charCodeAt(F-2)===G+2&&q.charCodeAt(F-1)===G+1}(d,l+W)?"+":re}));return this.pos=n,x==="!e"?ve:x.replace(A,function($,W,q){if($.length===2){const F=$.charCodeAt(1),K=te[F];if(K!==void 0)return K}throw new SyntaxError(v(c,l+q))})}}class ft extends Array{constructor(n){super(),this.limits=n,this.parseDepth=0}replaceAndPush(n,d,l){if(this[this.parseDepth]=d,++this.parseDepth>=this.limits.maxParseDepth)throw new Error(v("JSON->URL: MaxParseDepth exceeded",n));this.push(l)}replace(n){this[this.parseDepth]=n}depth(){return arguments.length>0&&arguments[0]!==void 0&&arguments[0]&&(this.parseDepth--,this.pop()),this.parseDepth}}class Rr extends Array{constructor(n){super(),this.limits=n,this.numValues=0}popObjectValue(n){let d=this.pop(),l=this.pop(),x=this[this.length-1];return d===null&&n.isPresentAndTrue("ignoreNullObjectMembers")||(x[l]=d),x}popArrayValue(n){let d=this.pop(),l=this[this.length-1];return d===null&&n.isPresentAndTrue("ignoreNullArrayMembers")||l.push(d),l}checkValueLimit(n){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;if(this.numValues+=d,this.numValues>this.limits.maxParseValues+1)throw new Error(v("JSON->URL: MaxParseValues exceeded",n))}appendArrayValue(n,d){let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;this.checkValueLimit(n,l),this.push(d)}}function zt(g){for(;typeof g=="function";)g=g();return g}function Nt(g,n,d,l){return typeof g=="number"?typeof n!="number"&&(d=n):d=g,(d=zt(d))instanceof I||(d=new I(d,l)),d}function kt(g,n,d,l){return l.AQF?new Me(g,n,d,l):new pe(g,n,d,l)}function Dt(g,n){return typeof g=="number"?g:n}function Tt(g,n,d,l,x){if(g===void 0)return;l=Nt(n,d,l,x),g=String(g);const $=Dt(n,0),W=Dt(d,g.length);if(W<=$){if(l.impliedArray!==void 0)return l.impliedArray;if(l.impliedObject!==void 0)return l.impliedObject;throw new SyntaxError(v("JSON->URL: expected value",0))}if(W>l.maxParseChars)throw new Error("JSON->URL: MaxParseChars exceeded");const q=l.wwwFormUrlEncoded&&(l.impliedObject||l.impliedArray),F=new Rr(l),K=new ft(l),z=kt(g,$,W,l);if(l.impliedObject!==void 0)F.push(l.impliedObject),K.push(6);else if(l.impliedArray!==void 0)F.push(l.impliedArray),K.push(2);else{if(z.structChar(!0)!==H){const ge=z.parseLiteral(!1);if(z.done())return ge;throw new SyntaxError(v(t,0))}K.push(1)}for(q&&z.skipAmps(!0);;){if(z.done())throw new SyntaxError(v(a,z.pos));let ge,vt,Le;switch(K[K.depth()]){case 1:switch(z.structChar(!0)){case H:F.appendArrayValue(z.pos,[]),K.replaceAndPush(z.pos,3,1);continue;case Y:if(K.depth(!0)===-1){if(z.done())return z.newEmptyValue();throw new SyntaxError(v(o,z.pos))}if(F.appendArrayValue(z.pos,z.newEmptyValue()),K.depth()===0&&(q&&z.skipAmps(),z.done())){if(l.impliedArray)return F.popArrayValue(l);if(l.impliedObject)return F.popObjectValue(l);throw new SyntaxError(v(a,z.pos))}continue}switch(F.checkValueLimit(z.pos),vt=z.isEmptyObject(),ge=vt?{}:z.parseLiteral(),Le=z.pos,z.structChar()){case ae:if(!l.wwwFormUrlEncoded||K.depth()>0)throw new SyntaxError(v(s,Le));case ne:K.replace(2),F.appendArrayValue(Le,[]),F.push(ge),F.popArrayValue(l);continue;case Y:switch(vt?F.push({}):F.appendArrayValue(Le,[ge]),K.depth(!0)){case-1:if(z.pos===W)return F[0];throw new SyntaxError(v(o,Le));case 0:if(q&&z.skipAmps(),z.done()){if(l.impliedArray)return F.popArrayValue(l);if(l.impliedObject)return F.popObjectValue(l);throw new SyntaxError(v(a,Le))}}continue;case 61:if(!l.wwwFormUrlEncoded||K.depth()>0)throw new SyntaxError(v(s,Le));case _e:K.replace(4),F.push({},ge);continue;default:throw new SyntaxError(v(t,Le))}case 2:if(z.accept(H)){K.replaceAndPush(z.pos,3,1);continue}if(F.checkValueLimit(z.pos),ge=z.parseLiteral(!1),q&&z.skipAmps(),z.done()){if(K.depth()===0&&l.impliedArray)return F.push(ge),F.popArrayValue(l);throw new SyntaxError(v(a,W))}K.replace(3),F.push(ge);continue;case 3:switch(F.popArrayValue(l),z.structChar()){case ae:if(!l.wwwFormUrlEncoded||K.depth()>0)throw new SyntaxError(v(s,z.pos));case ne:K.replace(2);continue;case Y:switch(K.depth(!0)){case-1:if(z.done()&&!l.impliedArray)return F[0];throw new SyntaxError(v(o,z.pos));case 0:if(q&&z.skipAmps(),z.done()){if(l.impliedArray)return F.popArrayValue(l);if(l.impliedObject)return F.popObjectValue(l);throw new SyntaxError(v(a,z.pos))}}continue}throw new SyntaxError(v("JSON->URL: expected comma or close paren",z.pos));case 4:if(z.accept(H)){K.replaceAndPush(z.pos,5,1);continue}if(F.checkValueLimit(z.pos),ge=z.parseLiteral(!1),q&&z.skipAmps(),z.done()){if(K.depth()===0&&l.impliedObject)return F.push(ge),F.popObjectValue(l);throw new SyntaxError(v(a,W))}K.replace(5),F.push(ge);continue;case 5:switch(F.popObjectValue(l),Le=z.pos,z.structChar()){case ae:if(!l.wwwFormUrlEncoded||K.depth()>0)throw new SyntaxError(v(s,Le));case ne:K.replace(6);continue;case Y:switch(K.depth(!0)){case-1:if(z.done()&&!l.impliedObject)return F[0];throw new SyntaxError(v(o,z.pos));case 0:if(q&&z.skipAmps(),z.done()){if(l.impliedArray)return F.popArrayValue(l);if(l.impliedObject)return F.popObjectValue(l);throw new SyntaxError(v(o,z.pos))}}continue}throw new SyntaxError(v("JSON->URL: expected comma, open paren, or close paren",z.pos));case 6:if(ge=z.parseLiteral(!0),q&&z.skipAmps(),z.done()){if(l.impliedObject&&K.depth()==0)return F.push(ge,l.getMissingValue(ge)),F.popObjectValue(l);throw new SyntaxError(v(a,W))}switch(z.structChar()){case 61:if(!l.wwwFormUrlEncoded||K.depth()>0)throw new SyntaxError(v(s,z.pos));case _e:break;case ae:if(!l.wwwFormUrlEncoded||K.depth()>0)throw new SyntaxError(v(s,z.pos));case ne:if(l.impliedObject&&K.depth()==0){F.push(ge,l.getMissingValue(ge)),F.popObjectValue(l);continue}default:throw new SyntaxError(v(y,z.pos))}K.replace(4),F.push(ge);continue;default:throw new SyntaxError(v("JSON->URL: internal error",z.pos))}}}return class{constructor(g){for(;typeof g=="function";)g=g();g===void 0&&(g={}),this.maxParseDepth=typeof g.maxParseDepth=="number"?parseInt(g.maxParseDepth):32,this.maxParseValues=typeof g.maxParseValues=="number"?parseInt(g.maxParseValues):4096,this.maxParseChars=typeof g.maxParseChars=="number"?parseInt(g.maxParseChars):32768,this.emptyValue=g.emptyValue===void 0?{}:g.emptyValue,this.nullValue=g.nullValue===void 0?null:g.nullValue}parseLiteral(g){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,l=arguments.length>3&&arguments[3]!==void 0&&arguments[3],x=arguments.length>4?arguments[4]:void 0;return g!==void 0&&(g=String(g)),d===void 0&&(d=g.length),kt(g,n,d,Nt(x)).parseLiteral(l)}static parse(g,n,d,l){return Tt(g,n,d,l,void 0)}parse(g,n,d,l){return Tt(g,n,d,l,this)}static stringify(g,n){if(g!==void 0)return n=new L(zt(n)),g===null?he(n):g.toJsonURLText(n,0)}}})})(Er);var Ds=Er.exports;const Xt=ks(Ds),Rt="https://idr-testing.openmicroscopy.org/",et=`${Rt}searchengine2/api/v1/`,er="https://idr-testing.openmicroscopy.org/",Ts="name",tr="container",At={image:"image",project:"experiment",screen:"screen",container:"experiments/screen"};async function Fs(){let r=`${et}resources/all/keys/?mode=searchterms`;return await Ir(r)}function Us(r,e,t=[]){return e=e.toLowerCase(),(s,a)=>{let o=e==s.Value.toLowerCase(),f=e==a.Value.toLowerCase();if(o!=f)return o?-1:1;let p=r==s.Key,c=r==a.Key;if(p!=c)return p?-1:1;let h=t.includes(s.Key),y=t.includes(a.Key);return h!=y?h?-1:1:s.count>a.count?-1:s.count<a.count?1:0}}function rr(r,e,t,s,a){return s=s.toLowerCase(),r.filter||console.error("rsp should be a list",r),r=r.filter(o=>o.no_images!==0),r.map(o=>{let f=o.name,p=o.description,c=t;c=="Any"&&(c=f!=null&&f.toLowerCase().includes(s)?Ts:"description");let h=f;if(c=="description"&&p){let y=p.toLowerCase().indexOf(s),v=80,u=(v-s.length)/2;y-u<0?y=0:y=y-u;let b=p.substr(y,v);y>0&&(b="..."+b),y+v<p.length&&(b=b+"..."),h=p,f=b}return{key:c,label:`${c} <span style="color:#bbb">${a}</span> <b>${f}</b> <span style="color:#bbb">(1 ${At[e]})</span>`,value:h,count:1,dtype:e}})}async function js(r,e,t,s,a){let o={value:e},f=new URLSearchParams(o).toString(),c=[`${et}resources/all/searchvalues/?`+f];if(r=="Any"){let _=`${et}resources/all/names/?value=${e}`;c.push(_)}const h=c.map(_=>fetch(_,{signal:a.signal}).then(w=>w.json())),y=await Promise.all(h),v=y[0];let u,b=v.screen.data.map(_=>({..._,type:"screen",count:_["Number of screens"]})),m=v.project.data.map(_=>({..._,type:"project",count:_["Number of projects"]})),E={};m.concat(b).forEach(_=>{let w=_.Key+"="+_.Value;E[w]?(console.log("Combining",_,E[w]),E[w].count=E[w].count+_.count,E[w].type=tr):E[w]=_}),console.log("projectScreenHits",E);let I=v.image.data.map(_=>({..._,type:"image",count:_["Number of images"]})),L=[].concat(Object.values(E),I);L.sort(Us(r,e,t)),u=L.map(_=>{let w=_.type,J=_.count;return{key:_.Key,label:`${_.Key} <span style="color:#bbb">${s}</span> <b>${_.Value}</b> <span style="color:#bbb">(${J} ${At[w]}${J!=1?"s":""})</span>`,value:`${_.Value}`,dtype:w,data_source:_.data_source,count:J}});let D=y[1],N=[];N=N.concat(rr(D.project,"project",r,e,s)),N=N.concat(rr(D.screen,"screen",r,e,s)),u=u.filter(_=>!_.value.includes("annotation.csv"));let A={};u.forEach(_=>{let w=_.key;A[w]||(A[w]={key:w,count:0,type:_.dtype,matches:[]}),(_.dtype=="project"||_.dtype=="screen")&&(A[w].type.includes(_.dtype)||(A[w].type=tr)),A[w].count+=_.count,A[w].matches.push(_)});let O=Object.values(A);O.sort((_,w)=>_.count<w.count?1:_.count>w.count?-1:_.key>w.key?1:-1),console.log("keyCountsList",O);let U=u.length;const C=100;if(U>C?(u=u.slice(0,C),u.push({key:-1,label:`...and ${U-C} more matches not shown`,value:-1})):U==0&&(u=[{label:"No results found.",value:-1}]),r!="Any"&&A[r]){let _=A[r].count,w=A[r].type;const J={key:r,label:`<span style="color:#bbb">${r} contains</span>
          <b>${e}</b> <span style="color:#bbb">(${_}
            ${At[w]}${_!=1?"s":""})</span>`,value:e,dtype:w,operator:"contains"};u.unshift(J)}return u}function Cr(r,e=!1,t={}){let s=`${et}resources/submitquery/`;e&&(s+="containers/");let a={method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"},...t};return fetch(s,a).then(o=>o.json())}function Ps(r,e,t,s={}){console.log("getKeyValues() query, key, containerName, opts",r,e,t,s);let a=`${et}resources/image/container_filterkeyvalues/`;a+=`?container_name=${t}&key=${e}`;let o={method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"},...s};return fetch(a,o).then(f=>f.json())}function xt(r,e,t,s="image"){let a=JSON.parse(JSON.stringify(r));return a.query_details.and_filters.push({name:e,value:t,operator:"equals",resource:s}),a}async function Ir(r,e={}){return await(await fetch(r,e)).json()}function Vs(r,e){let t;return function(){const s=this,a=arguments,o=function(){t=null,r.apply(s,a)};clearTimeout(t),t=setTimeout(o,e)}}async function Js(r){let e=`${Rt}webclient/api/paths_to_object/?${r.type}=${r.id}`;return(await Ir(e)).paths}var Gs=Q('<li class="svelte-57jlxm"><label class="svelte-57jlxm"><button class="svelte-57jlxm"><strong> </strong> <span style="opacity: 0.3"> </span> </button></label></li>'),Zs=Q('<ul class="items svelte-57jlxm"></ul>');function Bs(r,e){Ae(e,!1);let t=B(e,"items",8),s=B(e,"handleClick",8);Oe();var a=Zs();Ie(a,5,t,o=>o,(o,f)=>{var p=Gs(),c=M(p),h=M(c),y=M(h),v=M(y);S(y);var u=j(y),b=j(u),m=M(b);S(b);var E=j(b);S(h),S(c),S(p),ie(()=>{le(v,`${i(f).key??""}:`),le(u,` ${i(f).value??""} `),le(m,`(${i(f).count??""})`),le(E,` (${i(f).data_source??""})`)}),Ye("click",h,()=>s()(i(f))),T(o,p)}),S(a),T(r,a),xe()}class Ys{constructor(){this.filters=Qe([]),this.filterBeingEdited=Qe(-1)}addFilter({key:e,value:t,dtype:s,operator:a="equals",resource:o="image"}){(s==="project"||s==="screen")&&(o="container");let f={name:e,value:t,operator:a,resource:o,active:!0},p=this.getFilterBeingEdited();if(console.log("STORE addFilter: editedFilter",p,f),p==-1){let c=[f];this.filters.update(h=>[...h,c]),p=Ne(this.filters).length-1}else this.filters.update(c=>c.map((h,y)=>y==p?[...h,f]:h));return p}getFilters(){return Ne(this.filters)}getQuery(e,t=!1){let s=c=>{let{name:h,value:y,operator:v,resource:u}=c;return{name:h,value:y,operator:v,resource:u}},a=c=>!(!c.active||t&&c.resource==="container"),o=Ne(this.filters).map(c=>c.filter(a).map(s)).filter(c=>c.length>0),f=o.filter(c=>c.length>1),p=o.filter(c=>c.length===1).map(c=>c[0]);return e&&p.push({name:"name",value:e,operator:"equals",resource:"container"}),{resource:"image",query_details:{and_filters:p,or_filters:f,case_sensitive:!1},mode:"searchterms"}}toggleFilter(e){this.filters.update(t=>{let s=[...t],a=s[e].some(o=>o.active);return s[e]=s[e].map(o=>(o.active=!a,o)),s})}updateFilterOperator(e,t,s){this.filters.update(a=>{let o=[...a];return o[e][t].operator=s,o})}toggleOrFilter(e,t){this.filters.update(s=>{let a=[...s],o=a[e][t].active;return a[e][t].active=!o,a})}removeOrFilter(e,t){this.filters.update(s=>{let a=[...s];return a[e]=a[e].filter((o,f)=>f!==t),a})}removeFilter(e){this.filters.update(t=>t.filter((s,a)=>a!==e))}editFilter(e){this.filterBeingEdited.set(e)}getFilterBeingEdited(){return Ne(this.filterBeingEdited)}subscribeFilters(e){return this.filters.subscribe(e)}subscribeFilterBeingEdited(e){return this.filterBeingEdited.subscribe(e)}setFilters(e){this.filters.set(e)}}const se=new Ys,Ue=Qe(null);var Qs=Q("<span>or</span>"),Hs=Q('<!> <div class="or_filter svelte-1dedc0o"><div class="keyvalue svelte-1dedc0o"> <select class="svelte-1dedc0o"><option>equals</option><option>contains</option></select> </div> <div class="filter_buttons svelte-1dedc0o"><button title="Disable filter" class="svelte-1dedc0o"><!></button> <button title="Remove Filter" class="svelte-1dedc0o"><!></button></div></div>',1),Ws=Q("<h2>Edit Filters</h2> <!>",1);function $s(r,e){Ae(e,!1);let t=ee([]),s=ee(-1);se.subscribeFilters(p=>{V(t,p)}),se.subscribeFilterBeingEdited(p=>{V(s,p)});function a(p,c){console.log("Operator change",p,c.target.value),se.updateFilterOperator(i(s),p,c.target.value)}Oe();var o=ke(),f=fe(o);ce(f,()=>i(t)[i(s)],p=>{var c=Ws(),h=j(fe(c),2);Ie(h,1,()=>i(t)[i(s)],Te,(y,v,u)=>{var b=Hs(),m=fe(b);ce(m,()=>u>0,Z=>{var k=Qs();T(Z,k)});var E=j(m,2),I=M(E),L=M(I),D=j(L);ie(()=>{i(v).operator,at(()=>{})}),D.__change=Z=>a(u,Z);var N=M(D);N.value=(N.__value="equals")==null?"":"equals";var A=j(N);A.value=(A.__value="contains")==null?"":"contains",S(D);var O=j(D);S(I);var U=j(I,2),C=M(U);C.__click=()=>se.toggleOrFilter(i(s),u);var _=M(C);Ge(_,{icon:Sr,color:"#666"}),S(C);var w=j(C,2);w.__click=()=>se.removeOrFilter(i(s),u);var J=M(w);Ge(J,{icon:Lt,color:"#666"}),S(w),S(U),S(E),ie(()=>{be(I,"active",i(v).active),le(L,`${i(v).name??""} `),le(O,` ${i(v).value??""}${(i(v).operator=="contains"?"*":"")??""}`)}),Mt(D,()=>i(v).operator,Z=>(i(v).operator=Z,at(()=>i(t)[i(s)]))),T(y,b)}),T(p,c)}),T(r,o),xe()}He(["change","click"]);function Ks(r,e){i(e).hidePopover()}var qs=Q("<option> </option>"),Xs=Q("<option> </option>"),ei=Q("<p>Loading...</p>"),ti=Q('<div id="add-filter-dialog" popover="" class="svelte-778ojm"><button class="close svelte-778ojm" title="Close">&times;</button> <div class="popover_content svelte-778ojm"><div class="left_panel svelte-778ojm"><h2>Add Filter</h2> <div class="kvp_row svelte-778ojm"><select class="svelte-778ojm"><option>Any Key</option><optgroup label="Study"></optgroup><optgroup label="Image"></optgroup></select> <input type="text" placeholder="type to find values..." class="svelte-778ojm"></div> <!> <div class="matches svelte-778ojm"><!></div></div> <div class="right_panel svelte-778ojm"><!></div></div></div>');function ri(r,e){Ae(e,!1);let t=B(e,"filterIndex",28,()=>-1),s=ee([]),a=ee(!1),o=ee({project:[],image:[]}),f=ee("Any"),p="equals",c=ee(),h=new AbortController;We(()=>{Fs().then(k=>{V(o,k),console.log("Known keys",i(o))}),i(c).addEventListener("toggle",k=>{console.log("Popover toggled",k),k.newState=="closed"&&(t(-1),se.editFilter(-1))}),se.subscribeFilterBeingEdited(k=>{console.log("FilterPopover Editing filter",k),t(k),t()!=-1&&i(c)&&i(c).showPopover()})});let y=k=>{h.abort(),h=new AbortController;const P=k.target.value;V(a,!0),console.log("Searching for",P);let H=i(o).project.concat(i(o).image);js(i(f),P,H,p,h).then(Y=>{V(a,!1),console.log("Results",Y),V(s,Y)})};function v(k){console.log("FilterPopover Adding filter",k),k.operator=p,t(se.addFilter(k)),se.editFilter(t())}Oe();var u=ti(),b=M(u);b.__click=[Ks,c];var m=j(b,2),E=M(m),I=j(M(E),2),L=M(I);ie(()=>{i(f),at(()=>{i(o)})});var D=M(L);D.value=(D.__value="Any")==null?"":"Any";var N=j(D);Ie(N,5,()=>i(o).project,Te,(k,P)=>{var H=qs(),Y={},ne=M(H,!0);S(H),ie(()=>{Y!==(Y=i(P))&&(H.value=(H.__value=i(P))==null?"":i(P)),le(ne,i(P))}),T(k,H)}),S(N);var A=j(N);Ie(A,5,()=>i(o).image,Te,(k,P)=>{var H=Xs(),Y={},ne=M(H,!0);S(H),ie(()=>{Y!==(Y=i(P))&&(H.value=(H.__value=i(P))==null?"":i(P)),le(ne,i(P))}),T(k,H)}),S(A),S(L);var O=j(L,2),U=pr(()=>Vs(y,500));O.__keyup=function(...k){var P;(P=i(U))==null||P.apply(this,k)},S(I);var C=j(I,2);ce(C,()=>i(a),k=>{var P=ei();T(k,P)});var _=j(C,2),w=M(_);Bs(w,{handleClick:v,get items(){return i(s)}}),S(_),S(E);var J=j(E,2),Z=M(J);$s(Z,{}),S(J),S(m),S(u),Ot(u,k=>V(c,k),()=>i(c)),Mt(L,()=>i(f),k=>V(f,k)),T(r,u),xe()}He(["click","keyup"]);const si="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Generator:%20Adobe%20Illustrator%2019.2.1,%20SVG%20Export%20Plug-In%20.%20SVG%20Version:%206.00%20Build%200)%20--%3e%3csvg%20version='1.1'%20id='logo_-_color_1_'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20viewBox='0%200%205137.1%20896'%20style='enable-background:new%200%200%205137.1%20896;'%20xml:space='preserve'%3e%3cstyle%20type='text/css'%3e%20.st0{fill:%23DF283F;}%20.st1{fill:%231C4A87;}%20.st2{fill:%23128669;}%20.st3{fill:%231D8DCD;}%20%3c/style%3e%3cg%3e%3cg%3e%3cpath%20class='st0'%20d='M103.4,314c-4.7-4.8-10.4-7.2-15.8-7.2c-7,0-13.8,3.8-18.2,11.2l-31.7,52.8L5.9,423.7%20c-7.9,13.2-7.9,34.8,0,48l31.7,52.8l31.7,52.8c4.4,7.4,11.2,11.2,18.2,11.2c5.5,0,11.1-2.4,15.8-7.2c0,0,65.2-66.3,67.3-130.6%20c0-1,0.1-2.1,0.1-3.1c0-1,0-2.1-0.1-3.1C168.6,380.3,103.4,314,103.4,314z'/%3e%3cpath%20class='st1'%20d='M1052.3,423.7l-31.7-52.8l-31.7-52.8c-4.4-7.4-11.2-11.2-18.2-11.2c-5.5,0-11.1,2.4-15.8,7.2%20c0,0-65.2,66.3-67.3,130.6c0,1-0.1,2.1-0.1,3.1c0,1,0,2.1,0.1,3.1c2.1,64.3,67.3,130.6,67.3,130.6c4.7,4.8,10.4,7.2,15.8,7.2%20c7,0,13.7-3.8,18.2-11.2l31.7-52.8l31.7-52.8C1060.3,458.5,1060.3,436.9,1052.3,423.7z'/%3e%3cpath%20class='st1'%20d='M685.9,447.7c0-86.6-70.2-156.8-156.8-156.8s-156.8,70.2-156.8,156.8c0,86.6,70.2,156.8,156.8,156.8%20S685.9,534.3,685.9,447.7z'/%3e%3cpath%20class='st2'%20d='M797.9,179c1.3,0,2.5-0.1,3.8-0.1c32.3-1,62.7-14.3,62.7-14.3c14.1-6.2,19.2-22,11.3-35.2L844,76.6%20l-31.7-52.7C804.4,10.7,785.3,0,769.9,0H646.7c-15.4,0-22.9,11.4-16.6,25.4C630.2,25.4,699,179,797.9,179z'/%3e%3cpath%20class='st1'%20d='M193.8,164.6c0,0,30.4,13.2,62.7,14.2c1.3,0,2.5,0.1,3.8,0.1c99,0,167.8-153.6,167.8-153.6%20C434.4,11.4,426.9,0,411.5,0H288.3c-15.4,0-34.5,10.7-42.4,23.9l-31.7,52.8l-31.7,52.8C174.6,142.6,179.7,158.5,193.8,164.6z'/%3e%3cpath%20class='st3'%20d='M864.5,730.9c0,0-30.4-13.3-62.7-14.3c-1.3,0-2.5-0.1-3.8-0.1c-99,0-167.8,153.8-167.8,153.8%20c-6.3,14.1,1.2,25.7,16.6,25.7h123.2c15.4,0,34.5-10.9,42.4-24.1L844,819l31.7-52.9C883.7,752.9,878.6,737,864.5,730.9z'/%3e%3cpath%20class='st1'%20d='M260.3,716.6c-1.3,0-2.5,0-3.8,0c-32.3,1-62.7,14.2-62.7,14.2c-14.1,6.2-19.2,22-11.3,35.2l31.7,52.8l31.7,53%20c7.9,13.2,27,24.1,42.4,24.1h123.2c15.4,0,22.9-11.6,16.6-25.7C428.1,870.3,359.3,716.6,260.3,716.6z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st0'%20d='M1912.8,203.6c-67.1-65.5-150.1-98.3-248.9-98.3S1482.1,138,1415,203.6c-67.1,65.5-100.7,147.2-100.7,245.1%20c0,97.9,33.6,179.5,100.7,245.1c67.1,65.5,150.1,98.3,248.9,98.3s181.8-32.8,248.9-98.3c67.1-65.6,100.7-147.2,100.7-245.1%20C2013.5,350.8,1979.9,269.1,1912.8,203.6z%20M1898.6,448.7c0,66.8-22.7,123.7-67.9,170.5c-45.3,46.9-100.9,70.3-166.7,70.3%20c-65.9,0-121.5-23.4-166.7-70.3c-45.3-46.9-67.9-103.7-67.9-170.5c0-66.8,22.6-123.6,67.9-170.5c45.3-46.9,100.8-70.3,166.7-70.3%20c65.9,0,121.4,23.4,166.7,70.3C1875.9,325,1898.6,381.8,1898.6,448.7z'/%3e%3cpolygon%20class='st2'%20points='2739.3,128%202538.8,545.1%202338.4,128%202163,128%202163,792%202275,792%202275,273.4%202506.5,734%202569.2,734%202801,273.4%202801,792%202913,792%202913,128%20'/%3e%3cpolygon%20class='st3'%20points='3234,687%203234,509%203552,509%203552,409%203234,409%203234,233%203588,233%203588,128%203122,128%203122,792%203600,792%203600,687%20'/%3e%3cpath%20class='st1'%20d='M4157.6,550.7c95.6-28.5,143.4-97.5,143.4-207.1c0-75.4-21.9-130.2-65.5-164.4S4119.3,128,4018,128h-248v664%20h113V569h147.3L4189,792h142.5L4157.6,550.7z%20M3883,230h142.6c60.2,0,102,7.9,125.4,24.1c23.4,16.1,35.1,45.8,35.1,89.2%20c0,43.4-11.4,74.8-34.2,94.4c-22.8,19.6-65.9,29.3-129.2,29.3H3883V230z'/%3e%3cpath%20class='st1'%20d='M5036.4,203.6c-67.1-65.5-150.1-98.3-248.9-98.3c-98.8,0-181.8,32.8-248.9,98.3%20c-67.1,65.5-100.7,147.2-100.7,245.1c0,97.9,33.6,179.5,100.7,245.1c67.1,65.5,150.1,98.3,248.9,98.3%20c98.8,0,181.8-32.8,248.9-98.3c67.1-65.6,100.7-147.2,100.7-245.1C5137.1,350.8,5103.5,269.1,5036.4,203.6z%20M5022.1,448.7%20c0,66.8-22.7,123.7-67.9,170.5c-45.3,46.9-100.9,70.3-166.7,70.3c-65.9,0-121.5-23.4-166.7-70.3c-45.3-46.9-67.9-103.7-67.9-170.5%20c0-66.8,22.6-123.6,67.9-170.5c45.3-46.9,100.8-70.3,166.7-70.3c65.9,0,121.4,23.4,166.7,70.3%20C4999.5,325,5022.1,381.8,5022.1,448.7z'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",ii="data:image/svg+xml,%3csvg%20width='98'%20height='96'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M48.854%200C21.839%200%200%2022%200%2049.217c0%2021.756%2013.993%2040.172%2033.405%2046.69%202.427.49%203.316-1.059%203.316-2.362%200-1.141-.08-5.052-.08-9.127-13.59%202.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015%204.934.326%207.523%205.052%207.523%205.052%204.367%207.496%2011.404%205.378%2014.235%204.074.404-3.178%201.699-5.378%203.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283%200-5.378%201.94-9.778%205.014-13.2-.485-1.222-2.184-6.275.486-13.038%200%200%204.125-1.304%2013.426%205.052a46.97%2046.97%200%200%201%2012.214-1.63c4.125%200%208.33.571%2012.213%201.63%209.302-6.356%2013.427-5.052%2013.427-5.052%202.67%206.763.97%2011.816.485%2013.038%203.155%203.422%205.015%207.822%205.015%2013.2%200%2018.905-11.404%2023.06-22.324%2024.283%201.78%201.548%203.316%204.481%203.316%209.126%200%206.6-.08%2011.897-.08%2013.526%200%201.304.89%202.853%203.316%202.364%2019.412-6.52%2033.405-24.935%2033.405-46.691C97.707%2022%2075.788%200%2048.854%200z'%20fill='%23fff'/%3e%3c/svg%3e";var ni=Q('<base> <nav class="svelte-oz19hz"><img alt="OMERO Logo" class="svelte-oz19hz"> <h2 class="svelte-oz19hz">search engine client</h2> <div style="flex: 1"></div> <a class="github svelte-oz19hz" title="Open in GitHub" target="_blank" href="https://github.com/ome/omero_search_engine_client/"><img alt="GitHub Logo" class="svelte-oz19hz"></a></nav>',1);function ai(r,e){Ae(e,!1);let t="./";console.log("Nav base",t),Oe();var s=ni(),a=fe(s);X(a,"href",t);var o=j(a,2),f=M(o);X(f,"src",si);var p=j(f,6),c=M(p);X(c,"src",ii),S(p),S(o),T(r,s),xe()}class oi{constructor(){this.containers=Qe([]),this.controller=new AbortController}async loadContainers(e){this.controller.abort(),this.controller=new AbortController;let s=await Cr(e,!0,{signal:this.controller.signal});console.log("containerStore Search result",s),s.results.results.sort((f,p)=>{var c;return((c=f.name)==null?void 0:c.localeCompare(p.name))||-1});let a=s.results.results;this.containers.set(a);let o=Ne(we);if(o&&!o.name){let f=a.find(p=>p.id==o.id&&p.type==o.type);f&&we.set({...f,ignoreRightPanel:!0})}}subscribe(e){return this.containers.subscribe(e)}}const sr=new oi,we=Qe(null),li="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAANCAYAAACgu+4kAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA5NpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpDNDk5ODU0N0U5MjA2ODExODhDNkJBNzRDM0U2QkE2NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNjZDNDcxNzc5NEUxMUUxOTY2OEJEQjhGOUExQ0Y3RCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNjZDNDcxNjc5NEUxMUUxOTY2OEJEQjhGOUExQ0Y3RCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2ICgxMy4wIDIwMTIwMzA1Lm0uNDE1IDIwMTIvMDMvMDU6MjE6MDA6MDApICAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkM1NzAxRDEzMjkyMTY4MTE4OEM2QkE3NEMzRTZCQTY3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkM0OTk4NTQ3RTkyMDY4MTE4OEM2QkE3NEMzRTZCQTY3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+vd9MhwAAALhJREFUeNpi/P//P0NEXsd/BhxgxaQKRgY8gAXGMNbVwpA8e/kaAyHAGJhWe5iNnctGVkoaQ/Lxs6cMv35+w6f/CMvfP39svDytscrqaijgtX3t5u02IAMYXrx5z0AOAOll+fPnF8Ov37/IMgCkl+XP799Af5JpAFAv0IBfDD9//STTAKALfgMJcl0A0gvxwi8KvPAXFIhkGvAXHIjAqPjx4zuZsQCMxn9//my9eOaEFQN54ChAgAEAzRBnWnEZWFQAAAAASUVORK5CYII=",ci="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAANCAYAAABPeYUaAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA5NpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpDNDk5ODU0N0U5MjA2ODExODhDNkJBNzRDM0U2QkE2NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5NkU0QUUzNjc4NEExMUUxOTY2OEJEQjhGOUExQ0Y3RCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5NkU0QUUzNTc4NEExMUUxOTY2OEJEQjhGOUExQ0Y3RCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2ICgxMy4wIDIwMTIwMzA1Lm0uNDE1IDIwMTIvMDMvMDU6MjE6MDA6MDApICAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkM1NzAxRDEzMjkyMTY4MTE4OEM2QkE3NEMzRTZCQTY3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkM0OTk4NTQ3RTkyMDY4MTE4OEM2QkE3NEMzRTZCQTY3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+wkwZRwAAAQxJREFUeNpi/P//PwMjIyODqbHhfwYc4PTZ84y45ED6WZAFPFxdwQYig+27djEQAowgk6wtLcGu4GBnY0C38vvPX3gNOHr8OCPcJaHh4QwsLCwYiv78+YNV87+/fxnWrlkDZsN1PXr0iGHPnj1wRS4uLnj5jg4OcDYTjPH7928w3WxmhcJ3zmtC4Zc2mUH4SC6EG/LrF8TvtaeOofD3TqpD4XfXnULho3gHJOjt7Q2XePHiBV7+s6dPsRuydetWuISuri5evra2Nm7vVKUZoPDTratR+EZV1RjewTCkbdYFFP7Mo60o/HNtrSgBjeEdMzMzuMRToJ/x8Z88eYJpyKcPH8AYGRDiwwBAgAEAvXKdXsBF6t8AAAAASUVORK5CYII=";var ui=Q('<div class="spinner svelte-z1yris"></div> <p>Loading containers...</p>',1),di=(r,e,t)=>e(i(t)),fi=Q('<li class="svelte-z1yris"><div class="container_icon svelte-z1yris"><img alt="Container icon" class="svelte-z1yris"></div> <button class="container_text svelte-z1yris"> <span class="children_count svelte-z1yris"> </span></button></li>'),vi=Q('<div class="scrollable svelte-z1yris"><!> <ul class="svelte-z1yris"></ul></div>');function pi(r,e){Ae(e,!1);let t=ee([]),s=ee(null);sr.subscribe(c=>{V(t,c)}),se.subscribeFilters(c=>{let h=se.getQuery();console.log("SEARCHING....",h),sr.loadContainers(h)}),we.subscribe(c=>{V(s,c)});function a(c){console.log("Clicked",c),we.set(c)}Oe();var o=vi(),f=M(o);ce(f,()=>i(t).length==0,c=>{var h=ui();is(2),T(c,h)});var p=j(f,2);Ie(p,5,()=>i(t),Te,(c,h)=>{var y=fi(),v=M(y),u=M(v);S(v);var b=j(v,2);b.__click=[di,a,h];var m=M(b),E=j(m),I=M(E,!0);S(E),S(b),S(y),ie(()=>{var L,D;be(y,"selected",i(h).id==((L=i(s))==null?void 0:L.id)&&i(h).type==((D=i(s))==null?void 0:D.type)),X(u,"src",i(h).type=="screen"?ci:li),le(m,`${i(h).name??""} `),le(I,i(h)["image count"])}),T(c,y)}),S(p),S(o),T(r,o),xe()}He(["click"]);var hi=Q('<a class="viewer_link svelte-nc2d5b" target="_blank">Full Viewer</a>'),gi=Q('<a class="kvp_link svelte-nc2d5b" title="Filter by this key-value pair"> </a>'),mi=Q('<tr class="tablerow svelte-nc2d5b"><td class="svelte-nc2d5b"> </td><td class="svelte-nc2d5b"><!></td></tr>'),yi=Q('<div class="scrollable svelte-nc2d5b"><div class="annotations svelte-nc2d5b"><div class="map_ann svelte-nc2d5b"><table class="svelte-nc2d5b"><tbody></tbody></table></div></div></div>'),_i=Q('<div class="details svelte-nc2d5b"><h3> </h3> <h4> <!></h4></div> <!>',1);function bi(r,e){Ae(e,!1);let t=ee(null);Ue.subscribe(f=>{let p={...f,type:"image"};V(t,p)}),we.subscribe(f=>{f!=null&&f.ignoreRightPanel||V(t,f)});function s(f){return f.slice(0,1).toUpperCase()+f.slice(1)}Oe();var a=ke(),o=fe(a);ce(o,()=>i(t),f=>{var p=_i(),c=fe(p),h=M(c),y=M(h,!0);S(h);var v=j(h,2),u=M(v);ie(()=>le(u,`${s(i(t).type)??""} ID: ${i(t).id??""} `));var b=j(u);ce(b,()=>i(t).type=="image",E=>{var I=hi();ie(()=>X(I,"href",`${Rt}webclient/img_detail/${i(t).id??""}`)),T(E,I)}),S(v),S(c);var m=j(c,2);ce(m,()=>i(t).key_values,E=>{var I=yi(),L=M(I),D=M(L),N=M(D),A=M(N);Ie(A,5,()=>i(t).key_values,Te,(O,U)=>{var C=mi();const _=Ce(()=>i(U).key||i(U).name),w=Ce(()=>i(U).value);var J=M(C),Z=M(J,!0);S(J);var k=j(J),P=M(k);ce(P,()=>i(t).type=="image",H=>{var Y=gi(),ne=M(Y,!0);S(Y),ie(()=>{X(Y,"href",`${window.location.origin+window.location.pathname}?key=${i(_)??""}&value=${i(w)??""}&operator=equals&show=image-${i(t).id??""}`),le(ne,i(w))}),Ye("click",Y,xr(()=>se.addFilter({key:i(_),value:i(w),dtype:"image",operator:"equals"}))),T(H,Y)},H=>{var Y=nr();ie(()=>le(Y,i(w))),T(H,Y)}),S(k),S(C),ie(()=>le(Z,i(_))),T(O,C)}),S(A),S(N),S(D),S(L),S(I),T(E,I)}),ie(()=>le(y,i(t).name)),T(f,p)}),T(r,a),xe()}class wi{constructor(){this.groups=Qe([])}addGroup(e){this.groups.update(t=>[...t,e])}removeGroup(e){this.groups.update(t=>(t.splice(e,1),t))}subscribeGroups(e){return this.groups.subscribe(e)}setGroups(e){this.groups.set(e)}}const Je=new wi,Ai="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2016%2016'%3e%3cpath%20fill='none'%20stroke='white'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='2'%20d='m2%205%206%206%206-6'/%3e%3c/svg%3e";function xi(r,e){let t=r.target.value;Je.addGroup(t),V(e,"-")}var Si=Q("<option> </option>"),Ei=Q(`<!> <button title="Remove 'Group by'" class="svelte-cer5ll"> <span class="delete svelte-cer5ll"><!></span></button>`,1),Ci=Q('<select class="svelte-cer5ll"><option>Group by...</option><!></select> <div class="groups_list svelte-cer5ll"></div>',1);function Ii(r,e){Ae(e,!1);let t=B(e,"keys",24,()=>[]),s=ee("-"),a=ee([]);Je.subscribeGroups(y=>{console.log("CentrePanelGroups.svelte -> groups",y),V(a,y)}),we.subscribe(y=>{Je.setGroups([])}),se.subscribeFilters(y=>{Je.setGroups([])}),Oe();var o=Ci(),f=fe(o);ie(()=>{i(s),at(()=>{t(),i(a)})}),f.__change=[xi,s],X(f,"style",`--form-select-bg-img: url('${Ai}')`);var p=M(f);p.value=(p.__value="-")==null?"":"-";var c=j(p);Ie(c,1,t,Te,(y,v)=>{var u=Si(),b={};ie(()=>u.disabled=i(a).includes(i(v)));var m=M(u,!0);S(u),ie(()=>{b!==(b=i(v))&&(u.value=(u.__value=i(v))==null?"":i(v)),le(m,i(v))}),T(y,u)}),S(f);var h=j(f,2);Ie(h,5,()=>i(a),Te,(y,v,u)=>{var b=Ei(),m=fe(b);ce(m,()=>u>0,N=>{var A=nr(">");T(N,A)});var E=j(m,2);E.__click=()=>Je.removeGroup(u);var I=M(E),L=j(I),D=M(L);Ge(D,{icon:Lt,color:"#666"}),S(L),S(E),ie(()=>le(I,`${i(v)??""} `)),T(y,b)}),S(h),Mt(f,()=>i(s),y=>V(s,y)),T(r,o),xe()}He(["change","click"]);const Oi=r=>r;function Or(r,{delay:e=0,duration:t=400,easing:s=Oi}={}){const a=+getComputedStyle(r).opacity;return{delay:e,duration:t,easing:s,css:o=>`opacity: ${o*a}`}}const st={AUTO:"auto",START:"start",CENTER:"center",END:"end"},ze={HORIZONTAL:"horizontal",VERTICAL:"vertical"},qe={OBSERVED:0,REQUESTED:1},Mi={[ze.VERTICAL]:"top",[ze.HORIZONTAL]:"left"},ir={[ze.VERTICAL]:"scrollTop",[ze.HORIZONTAL]:"scrollLeft"};class Li{constructor({itemSize:e,itemCount:t,estimatedItemSize:s}){this.itemSize=e,this.itemCount=t,this.estimatedItemSize=s,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1,this.checkForMismatchItemSizeAndItemCount(),this.justInTime||this.computeTotalSizeAndPositionData()}get justInTime(){return typeof this.itemSize=="function"}updateConfig({itemSize:e,itemCount:t,estimatedItemSize:s}){t!=null&&(this.itemCount=t),s!=null&&(this.estimatedItemSize=s),e!=null&&(this.itemSize=e),this.checkForMismatchItemSizeAndItemCount(),this.justInTime&&this.totalSize!=null?this.totalSize=void 0:this.computeTotalSizeAndPositionData()}checkForMismatchItemSizeAndItemCount(){if(Array.isArray(this.itemSize)&&this.itemSize.length<this.itemCount)throw Error("When itemSize is an array, itemSize.length can't be smaller than itemCount")}getSize(e){const{itemSize:t}=this;return typeof t=="function"?t(e):Array.isArray(t)?t[e]:t}computeTotalSizeAndPositionData(){let e=0;for(let t=0;t<this.itemCount;t++){const s=this.getSize(t),a=e;e+=s,this.itemSizeAndPositionData[t]={offset:a,size:s}}this.totalSize=e}getLastMeasuredIndex(){return this.lastMeasuredIndex}getSizeAndPositionForIndex(e){if(e<0||e>=this.itemCount)throw Error(`Requested index ${e} is outside of range 0..${this.itemCount}`);return this.justInTime?this.getJustInTimeSizeAndPositionForIndex(e):this.itemSizeAndPositionData[e]}getJustInTimeSizeAndPositionForIndex(e){if(e>this.lastMeasuredIndex){const t=this.getSizeAndPositionOfLastMeasuredItem();let s=t.offset+t.size;for(let a=this.lastMeasuredIndex+1;a<=e;a++){const o=this.getSize(a);if(o==null||isNaN(o))throw Error(`Invalid size returned for index ${a} of value ${o}`);this.itemSizeAndPositionData[a]={offset:s,size:o},s+=o}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]}getSizeAndPositionOfLastMeasuredItem(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}}getTotalSize(){if(this.totalSize)return this.totalSize;const e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.itemCount-this.lastMeasuredIndex-1)*this.estimatedItemSize}getUpdatedOffsetForIndex({align:e=st.START,containerSize:t,currentOffset:s,targetIndex:a}){if(t<=0)return 0;const o=this.getSizeAndPositionForIndex(a),f=o.offset,p=f-t+o.size;let c;switch(e){case st.END:c=p;break;case st.CENTER:c=f-(t-o.size)/2;break;case st.START:c=f;break;default:c=Math.max(p,Math.min(f,s))}const h=this.getTotalSize();return Math.max(0,Math.min(h-t,c))}getVisibleRange({containerSize:e=0,offset:t,overscanCount:s}){if(this.getTotalSize()===0)return{};const o=t+e;let f=this.findNearestItem(t);if(f===void 0)throw Error(`Invalid offset ${t} specified`);const p=this.getSizeAndPositionForIndex(f);t=p.offset+p.size;let c=f;for(;t<o&&c<this.itemCount-1;)c++,t+=this.getSizeAndPositionForIndex(c).size;return s&&(f=Math.max(0,f-s),c=Math.min(c+s,this.itemCount-1)),{start:f,stop:c}}resetItem(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)}findNearestItem(e){if(isNaN(e))throw Error(`Invalid offset ${e} specified`);e=Math.max(0,e);const t=this.getSizeAndPositionOfLastMeasuredItem(),s=Math.max(0,this.lastMeasuredIndex);return t.offset>=e?this.binarySearch({high:s,low:0,offset:e}):this.exponentialSearch({index:s,offset:e})}binarySearch({low:e,high:t,offset:s}){let a=0,o=0;for(;e<=t;){if(a=e+Math.floor((t-e)/2),o=this.getSizeAndPositionForIndex(a).offset,o===s)return a;o<s?e=a+1:o>s&&(t=a-1)}return e>0?e-1:0}exponentialSearch({index:e,offset:t}){let s=1;for(;e<this.itemCount&&this.getSizeAndPositionForIndex(e).offset<t;)e+=s,s*=2;return this.binarySearch({high:Math.min(e,this.itemCount-1),low:Math.floor(e/2),offset:t})}}const Ri=(()=>{let r=!1;try{const e=Object.defineProperty({},"passive",{get(){return r={passive:!0},!0}});window.addEventListener("testpassive",e,e),window.remove("testpassive",e,e)}catch{}return r})();var zi=Q('<div class="virtual-list-wrapper svelte-dwpad5"><!> <div class="virtual-list-inner svelte-dwpad5"></div> <!></div>');function Ni(r,e){Ae(e,!1);let t=B(e,"height",12),s=B(e,"width",12,"100%"),a=B(e,"itemCount",12),o=B(e,"itemSize",12),f=B(e,"estimatedItemSize",12,null),p=B(e,"stickyIndices",12,null),c=B(e,"getKey",12,null),h=B(e,"scrollDirection",28,()=>ze.VERTICAL),y=B(e,"scrollOffset",12,null),v=B(e,"scrollToIndex",12,null),u=B(e,"scrollToAlignment",12,null),b=B(e,"scrollToBehaviour",12,"instant"),m=B(e,"overscanCount",12,3);const E=ls(),I=new Li({itemCount:a(),itemSize:o(),estimatedItemSize:ae()});let L=ee(!1),D=ee(),N=ee([]),A=ee({offset:y()||v()!=null&&i(N).length&&Y(v())||0,scrollChangeReason:qe.REQUESTED}),O=i(A),U={scrollToIndex:v(),scrollToAlignment:u(),scrollOffset:y(),itemCount:a(),itemSize:o(),estimatedItemSize:f()},C={},_=ee(""),w=ee("");k(),We(()=>{V(L,!0),i(D).addEventListener("scroll",ne,Ri),y()!=null?P(y()):v()!=null&&P(Y(v()))}),cs(()=>{i(L)&&i(D).removeEventListener("scroll",ne)});function J(){if(!i(L))return;const R=U.scrollToIndex!==v()||U.scrollToAlignment!==u(),re=U.itemCount!==a()||U.itemSize!==o()||U.estimatedItemSize!==f();re&&(I.updateConfig({itemSize:o(),itemCount:a(),estimatedItemSize:ae()}),H()),U.scrollOffset!==y()?V(A,{offset:y()||0,scrollChangeReason:qe.REQUESTED}):typeof v()=="number"&&(R||re)&&V(A,{offset:Y(v(),u(),a()),scrollChangeReason:qe.REQUESTED}),U={scrollToIndex:v(),scrollToAlignment:u(),scrollOffset:y(),itemCount:a(),itemSize:o(),estimatedItemSize:f()}}function Z(){if(!i(L))return;const{offset:R,scrollChangeReason:re}=i(A);(O.offset!==R||O.scrollChangeReason!==re)&&k(),O.offset!==R&&re===qe.REQUESTED&&P(R),O=i(A)}function k(){const{offset:R}=i(A),{start:re,stop:ue}=I.getVisibleRange({containerSize:h()===ze.VERTICAL?t():s(),offset:R,overscanCount:m()});let de=[];const he=I.getTotalSize();if(h()===ze.VERTICAL){const pe=typeof t()=="number"?"px":"";V(_,`height:${t()}${pe};width:${s()};`),V(w,`flex-direction:column;height:${he}px;`)}else{const pe=typeof s()=="number"?"px":"";V(_,`height:${t()};width:${s()}${pe}`),V(w,`min-height:100%;width:${he}px;`)}const Ve=p()!=null&&p().length!==0;if(Ve)for(let pe=0;pe<p().length;(pe+=1)-1){const Me=p()[pe];de.push({index:Me,style:G(Me,!0)})}if(re!==void 0&&ue!==void 0){for(let pe=re;pe<=ue;(pe+=1)-1)Ve&&p().includes(pe)||de.push({index:pe,style:G(pe,!1)});E("itemsUpdated",{start:re,end:ue})}V(N,de)}function P(R){"scroll"in i(D)?i(D).scroll({[Mi[h()]]:R,behavior:b()}):ns(D,i(D)[ir[h()]]=R)}function H(R=0){C={},I.resetItem(R),k()}function Y(R,re=u(),ue=a()){return(R<0||R>=ue)&&(R=0),I.getUpdatedOffsetForIndex({align:re,containerSize:h()===ze.VERTICAL?t():s(),currentOffset:i(A).offset||0,targetIndex:R})}function ne(R){const re=_e();re<0||i(A).offset===re||R.target!==i(D)||(V(A,{offset:re,scrollChangeReason:qe.OBSERVED}),E("afterScroll",{offset:re,event:R}))}function _e(){return i(D)[ir[h()]]}function ae(){return f()||typeof o()=="number"&&o()||50}function G(R,re){if(C[R])return C[R];const{size:ue,offset:de}=I.getSizeAndPositionForIndex(R);let he;return h()===ze.VERTICAL?(he=`left:0;width:100%;height:${ue}px;`,re?he+=`position:sticky;flex-grow:0;z-index:1;top:0;margin-top:${de}px;margin-bottom:${-(de+ue)}px;`:he+=`position:absolute;top:${de}px;`):(he=`top:0;width:${ue}px;`,re?he+=`position:sticky;z-index:1;left:0;margin-left:${de}px;margin-right:${-(de+ue)}px;`:he+=`position:absolute;height:100%;left:${de}px;`),C[R]=he}De(()=>(ye(v()),ye(u()),ye(y()),ye(a()),ye(o()),ye(f())),()=>{v(),u(),y(),a(),o(),f(),J()}),De(()=>i(A),()=>{i(A),Z()}),De(()=>(ye(t()),ye(s()),ye(p()),i(L)),()=>{t(),s(),p(),i(L)&&H(0)}),dt(),Oe();var oe=zi(),me=M(oe);_t(me,e,"header",{});var te=j(me,2);Ie(te,5,()=>i(N),R=>c()?c()(R.index):R.index,(R,re)=>{var ue=ke(),de=fe(ue);_t(de,e,"item",{get style(){return i(re).style},get index(){return i(re).index}}),T(R,ue)}),S(te);var ve=j(te,2);return _t(ve,e,"footer",{}),S(oe),Ot(oe,R=>V(D,R),()=>i(D)),ie(()=>{X(oe,"style",i(_)),X(te,"style",i(w))}),T(r,oe),As(e,"recomputeSizes",H),xe({recomputeSizes:H,get height(){return t()},set height(R){t(R),Se()},get width(){return s()},set width(R){s(R),Se()},get itemCount(){return a()},set itemCount(R){a(R),Se()},get itemSize(){return o()},set itemSize(R){o(R),Se()},get estimatedItemSize(){return f()},set estimatedItemSize(R){f(R),Se()},get stickyIndices(){return p()},set stickyIndices(R){p(R),Se()},get getKey(){return c()},set getKey(R){c(R),Se()},get scrollDirection(){return h()},set scrollDirection(R){h(R),Se()},get scrollOffset(){return y()},set scrollOffset(R){y(R),Se()},get scrollToIndex(){return v()},set scrollToIndex(R){v(R),Se()},get scrollToAlignment(){return u()},set scrollToAlignment(R){u(R),Se()},get scrollToBehaviour(){return b()},set scrollToBehaviour(R){b(R),Se()},get overscanCount(){return m()},set overscanCount(R){m(R),Se()}})}var ki=Q('<a target="_blank"><div class="studyThumb svelte-uad075"><img class="svelte-uad075"></div></a>'),Di=Q('<!> <span class="imgIndex svelte-uad075"> </span>',1);function Ti(r,e){Ae(e,!1);let t=B(e,"images",24,()=>[]),s=B(e,"index",8,0),a=B(e,"handleRendered",8),o=ee(null);We(()=>{a()(s())}),Ue.subscribe(u=>{V(o,u)});function f(u){Ue.set(u)}function p(u){window.open(u,"_blank").focus()}Oe();var c=Di(),h=fe(c);Ie(h,1,t,u=>u.id,(u,b)=>{var m=ki();const E=Ce(()=>{var N,A,O;return((O=(A=(N=i(b))==null?void 0:N.key_values)==null?void 0:A.find(U=>U.name=="thumb_url"))==null?void 0:O.value)||`${er}webclient/render_thumbnail/${i(b).id}/`}),I=Ce(()=>{var N,A,O;return((O=(A=(N=i(b))==null?void 0:N.key_values)==null?void 0:A.find(U=>U.name=="image_url"))==null?void 0:O.value)||`${er}webclient/img_detail/${i(b).id}/`});var L=M(m),D=M(L);S(L),S(m),ie(()=>{var N;X(m,"aria-label",`Image: ${i(b).name??""}`),X(m,"href",i(I)),be(L,"selected",((N=i(o))==null?void 0:N.id)==i(b).id),X(D,"src",i(E)),X(D,"alt",i(b).name)}),Ye("click",m,xr(()=>f(i(b)))),Ye("dblclick",m,()=>p(i(I))),T(u,m)});var y=j(h,2),v=M(y,!0);S(y),ie(()=>le(v,s())),T(r,c),xe()}var Fi=Q("<div>Loading images...</div>"),Ui=Q("<div>No Images found</div>"),ji=Q('<div class="row svelte-s0g6r0" slot="item"><!></div>'),Pi=Q('<!> <div class="wrapper svelte-s0g6r0"><!></div>',1);function Mr(r,e){Ae(e,!1);const t=ee();let s=B(e,"parentQuery",8,void 0),a=B(e,"setPrototypeImage",8,void 0);const o=64;let f=ee(0),p=ee(0),c=ee([]),h=null,y,v=ee(!1);se.subscribeFilters(O=>{console.log("Images.svelte::: queryStore newFilters - parentQuery:",s()),u()}),we.subscribe(O=>{console.log("Images.svelte::: selectedContainerStore newFilters - parentQuery:",s()),u()});async function u(O=!0){var Z;let U=Ne(we);if(!(U!=null&&U.name)){V(c,[]),h=null;return}let C={};s()==null?(console.log("loadImages... parentQuery is undefined"),C=se.getQuery()):C=JSON.parse(JSON.stringify(s()));let _=xt(C,"name",U.name,"container");if(!O&&h){if(h.current_page>=h.total_pages)return;_.pagination=h}y&&y.abort(),console.log("loadImages... query",_,O),V(v,!0),y=new AbortController;let w=await Cr(_,!1,{signal:y.signal});h=w.results.pagination,V(v,!1);let J=((Z=w.results)==null?void 0:Z.results)||[];J.length==0&&console.log("NO IMAGES FOUND!",_),O?(V(c,J),a()&&a()(i(c)[0])):V(c,[...i(c),...J]),console.log("imagesJson",i(c))}function b(){V(t,Math.floor(i(p)/(o+15)))}We(()=>{b()});function m(O){O>=i(c).length&&(console.log("LOAD MORE IMAGES?",h.current_page,h.total_pages),h.current_page<h.total_pages&&(console.log("LOAD MORE IMAGES!"),u(!1)))}De(()=>{},()=>{V(t,7)}),dt(),Oe();var E=Pi();Ye("resize",hr,b);var I=fe(E);ce(I,()=>i(v),O=>{var U=Fi();_r(1,U,()=>Or,()=>({delay:1e3,duration:1e3})),T(O,U)},O=>{var U=ke(),C=fe(U);ce(C,()=>i(c).length==0,_=>{var w=Ui();T(_,w)},null,!0),T(O,U)});var L=j(I,2);X(L,"style",`--thumbSize: ${o}px`);var D=M(L),N=Ce(()=>i(f)-5),A=Ce(()=>Math.ceil(i(c).length/i(t)));Ni(D,{width:"100%",get height(){return i(N)},get itemCount(){return i(A)},itemSize:o+10,$$slots:{item:(O,U)=>{var C=ji();const _=Ce(()=>U.index),w=Ce(()=>U.style);var J=M(C),Z=Ce(()=>Math.min(i(c).length,(i(_)+1)*i(t))),k=Ce(()=>i(c).slice(i(_)*i(t),(i(_)+1)*i(t)));Ti(J,{handleRendered:m,get index(){return i(Z)},get images(){return i(k)}}),S(C),ie(()=>X(C,"style",i(w))),T(O,C)}}}),S(L),wt(L,"clientHeight",O=>V(f,O)),wt(L,"clientWidth",O=>V(p,O)),T(r,E),xe()}var Vi=Q("<div>Loading values...</div>"),Ji=Q("<div>No values found for query</div>"),Gi=Q('<div class="child_groups svelte-fokmmd"><!></div>'),Zi=Q('<div style="height: 200px; display: flex; flex-direction: column"><!></div>'),Bi=Q('<div><button class="svelte-fokmmd"><div class="icon svelte-fokmmd"><!></div> </button> <!></div>'),Yi=Q('<div class="groups"><!> <!></div>');function Lr(r,e){Ae(e,!1);let t=ee([]),s=B(e,"groupsIndex",8,0),a=B(e,"parentQuery",8),o=ee(!1),f=ee(20);Je.subscribeGroups(u=>{console.log("Groups.svelte -> groups",u),V(t,u)});let p=ee([]);We(()=>{V(o,!0);let u=i(t)[s()],b=Ne(we).name;console.log("<Groups> onMount() parentQuery, key, containerName",a(),u,b),Ps(a(),u,b).then(m=>{V(o,!1),console.log("getKeyValues()",m);let E=m[0].results;E.sort((I,L)=>I.value<L.value?-1:I.value>L.value?1:0),V(p,E)})});function c(u){V(p,i(p).map((b,m)=>(m==u&&(b.expanded=!b.expanded),b)))}Oe();var h=Yi(),y=M(h);ce(y,()=>i(o),u=>{var b=Vi();_r(1,b,()=>Or,()=>({delay:1e3,duration:1e3})),T(u,b)},u=>{var b=ke(),m=fe(b);ce(m,()=>i(p).length==0,E=>{var I=Ji();T(E,I)},null,!0),T(u,b)});var v=j(y,2);Ie(v,3,()=>i(p),u=>u.value,(u,b,m)=>{var E=Bi(),I=M(E);I.__click=()=>c(i(m));var L=M(I),D=M(L);Ge(D,{icon:Rs,color:"#666"}),S(L);var N=j(L);S(I);var A=j(I,2);ce(A,()=>i(b).expanded,O=>{var U=ke(),C=fe(U);ce(C,()=>s()<i(t).length-1,_=>{var w=ke(),J=fe(w);gr(J,()=>i(t)[s()+1],Z=>{var k=Gi(),P=M(k),H=Ce(()=>s()+1),Y=Ce(()=>xt(a(),i(t)[s()],i(b).value));Lr(P,{get groupsIndex(){return i(H)},get parentQuery(){return i(Y)}}),S(k),T(Z,k)}),T(_,w)},_=>{var w=Zi(),J=M(w),Z=Ce(()=>xt(a(),i(t)[s()],i(b).value));Mr(J,{get parentQuery(){return i(Z)}}),S(w),T(_,w)}),T(O,U)}),S(E),ie(()=>{X(I,"style",`--sticky-top: ${i(f)*s()}px; z-index: ${100-s()};`),be(I,"expanded",i(b).expanded),le(N,` ${i(b).value??""} (${i(b).no_image??""})`)}),wt(I,"clientHeight",O=>V(f,O)),T(u,E)}),S(h),T(r,h),xe()}He(["click"]);var Qi=Q('<div class="wrapper svelte-1jyv88t"><!></div>'),Hi=Q('<div class="header svelte-1jyv88t"><!></div> <!>',1);function Wi(r,e){Ae(e,!1);const t=ee(),s=ee(),a=64;let o=ee([]);function f(v){v?V(s,v.key_values.map(u=>u.name)):V(s,[])}se.subscribeFilters(()=>{V(t,se.getQuery(null,!0))}),Je.subscribeGroups(v=>{V(o,v)}),De(()=>se,()=>{V(t,se.getQuery())}),De(()=>{},()=>{V(s,[])}),dt(),Oe();var p=Hi(),c=fe(p),h=M(c);Ii(h,{get keys(){return i(s)}}),S(c);var y=j(c,2);ce(y,()=>i(o).length>0,v=>{var u=ke(),b=fe(u);gr(b,()=>i(o)[0],m=>{var E=Qi();X(E,"style",`--thumbSize: ${a}px`);var I=M(E);Lr(I,{get parentQuery(){return i(t)},get key(){return i(o)[0]}}),S(E),T(m,E)}),T(v,u)},v=>{Mr(v,{setPrototypeImage:f})}),T(r,p),xe()}var $i=Q('<strong class="svelte-rntvy5"> </strong>'),Ki=Q("<span>or</span>"),qi=Q('<strong class="svelte-rntvy5"> </strong>'),Xi=Q('<!> <button class="or_filter svelte-rntvy5"><!> </button>',1),en=Q('<div class="and_filter svelte-rntvy5"><div class="filter_content svelte-rntvy5"><!> <!></div> <div class="filter_buttons svelte-rntvy5"><button title="Edit Filters" class="svelte-rntvy5"><!></button> <button title="Disable filter" class="svelte-rntvy5"><!></button> <button title="Remove Filter" class="svelte-rntvy5"><!></button></div></div>'),tn=Q('<!> <!> <div class="main svelte-rntvy5"><div class="sidebar svelte-rntvy5"><div class="filter_panel"><h3 class="svelte-rntvy5">Studies <button class="addBtn svelte-rntvy5" popovertarget="add-filter-dialog">Add Filter</button></h3> <!></div> <div class="container_panel svelte-rntvy5"><!></div></div> <div class="content svelte-rntvy5"><!></div> <div class="sidebar svelte-rntvy5"><!></div></div>',1);function un(r,e){Ae(e,!0);let t=Yt(rt([])),s=Yt(rt(se.getFilterBeingEdited())),a=!1;function o(){if(a)return;let C=se.getFilters(),_=window.location.pathname,w=[];if(C.length>0){let k=Xt.stringify(C,{AQF:!0});w.push(`query=${k}`)}let J=Ne(we),Z=Ne(Ue);Z&&w.push(`show=image-${Z.id}`),J&&w.push(`show=${J.type}-${J.id}`),w.length>0&&(_+="?"+w.join("&")),history.pushState({query:C,image:Z,container:J},"",_)}function f(C){console.log("popstate state",C.state),a=!0,se.setFilters(C.state.query),we.set(C.state.container),Ue.set(C.state.image),setTimeout(()=>{a=!1},100)}We(()=>{console.log("onMount ---->"),se.subscribeFilters(C=>{console.log("newFilters",C),V(t,rt(C)),o()}),se.subscribeFilterBeingEdited(C=>{V(s,rt(C))}),we.subscribe(C=>{console.log("Selected Container",C),o()}),Ue.subscribe(C=>{console.log("Selected Image",C),o()})});const p=window.location.search.slice(1),c=new URLSearchParams(p);let h=c.get("query");if(console.log("URLSearchParams query:",h),h){let C=Xt.parse(encodeURIComponent(h),{AQF:!0});console.log("URLSearchParams filterJson...",C),(C==null?void 0:C.length)>0&&se.setFilters(C)}else{let C=c.get("key"),_=c.get("value"),w=c.get("operator")||"equals";console.log("URLSearchParams key:",C,"value:",_,"operator:",w),C&&_&&se.addFilter({key:C,value:_,dtype:"image",operator:w})}if(c.has("show")){let C=c.getAll("show");console.log("URLSearchParams show...",C);let _,w;C.forEach(J=>{let[Z,k]=J.split("-");Z=="image"?_={type:Z,id:k}:w={type:Z,id:k}}),_&&!w?Js(_).then(J=>{var k;console.log("Hierarchy paths",J);let Z=(k=J[0])==null?void 0:k.find(P=>P.type=="project"||P.type=="screen");Z&&(we.set(Z),Ue.set(_))}):w&&(console.log("Setting selectedContainer -->",w),we.set(w),_&&(console.log("Setting selectedImage -->",_),setTimeout(()=>Ue.set(_),100)))}var y=tn();Ye("popstate",hr,f);var v=fe(y);ai(v,{});var u=j(v,2);ri(u,{});var b=j(u,2),m=M(b),E=M(m),I=j(M(E),2);Ie(I,17,()=>i(t),Te,(C,_,w)=>{var J=en();const Z=pr(()=>Array.from(new Set(i(_).map(te=>te.name))));var k=M(J),P=M(k);ce(P,()=>i(Z).length==1,te=>{var ve=$i(),R=M(ve);S(ve),ie(()=>le(R,`${i(Z)[0]??""}:`)),T(te,ve)});var H=j(P,2);Ie(H,17,()=>i(_),Te,(te,ve,R)=>{var re=Xi(),ue=fe(re);ce(ue,()=>R>0,pe=>{var Me=Ki();T(pe,Me)});var de=j(ue,2);de.__click=()=>se.toggleOrFilter(w,R);var he=M(de);ce(he,()=>i(Z).length>1,pe=>{var Me=qi(),ft=M(Me);S(Me),ie(()=>le(ft,`${i(ve).name??""}:`)),T(pe,Me)});var Ve=j(he);S(de),ie(()=>{X(de,"title",`${i(ve).name??""} ${i(ve).operator??""} ${i(ve).value??""}`),be(de,"active",i(ve).active),le(Ve,` ${i(ve).value??""}${(i(ve).operator=="contains"?"*":"")??""}`)}),T(te,re)}),S(k);var Y=j(k,2),ne=M(Y);ne.__click=()=>se.editFilter(w);var _e=M(ne);Ge(_e,{icon:zs,color:"#666"}),S(ne);var ae=j(ne,2);ae.__click=()=>se.toggleFilter(w);var G=M(ae);Ge(G,{icon:Sr,color:"#666"}),S(ae);var oe=j(ae,2);oe.__click=()=>se.removeFilter(w);var me=M(oe);Ge(me,{icon:Lt,color:"#666"}),S(oe),S(Y),S(J),ie(()=>be(J,"edited",i(s)==w)),T(C,J)}),S(E);var L=j(E,2),D=M(L);pi(D,{}),S(L),S(m);var N=j(m,2),A=M(N);Wi(A,{}),S(N);var O=j(N,2),U=M(O);bi(U,{}),S(O),S(b),T(r,y),xe()}He(["click"]);export{un as component};
